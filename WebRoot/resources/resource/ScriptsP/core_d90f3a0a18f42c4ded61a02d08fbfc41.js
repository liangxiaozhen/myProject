!function(){if(!window.localStorage||!window.postMessage)throw"not support service";var util={isMobilePlatform:function(){if(/(iPhone|iPod|iOS|Android)/i.test(navigator.userAgent))return!0;else return!1},createAjax:function(){var e=null;var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.5.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];if(window.XMLHttpRequest){e=new XMLHttpRequest;if("withCredentials"in e)return e}if(window.xDomainRequest)e=new Window.xDomainRequest;return e},ajax:function(conf){var type=conf.type||"get",url=conf.url,data=conf.data,success=conf.success,error=conf.error;var xhr=util.createAjax();if(xhr){try{xhr.open(type,url)}catch(ex){error();return}xhr.onreadystatechange=function(){if(4==xhr.readyState)if(200===xhr.status)success(eval("("+xhr.responseText+")"));else error()};if("GET"==type.toUpperCase())xhr.send(null);else{xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");xhr.send(data)}}else error()},findLocalItems:function(e,t){var i,n=[],o;for(i in localStorage)if(i.match(e)||!e&&"string"==typeof i){o=!t?localStorage.getItem(i):JSON.parse(localStorage.getItem(i));n.push({key:i,val:o})}return n},clearLocalItems:function(e){for(var t=0;t<e.length;t++)window.localStorage.removeItem(e[t].key)},addEvent:function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i)},mergeUrl:function(e,t){var i=e.split("?"),n=i.shift(),o=util.query2Object(i.shift()||"","&");for(var s in t)o[s]=t[s];for(var s in o)i.push(s+"="+(o[s]||""));return n+"?"+i.join("&")},query2Object:function(e,t){var i=e.split(t),n={};for(var o=0;o<i.length;o++){var s=i[o],_=(s||"").split("="),a=_.shift();if(a)n[decodeURIComponent(a)]=decodeURIComponent(_.join("="));else;}return n},isObject:function(e){return"[object object]"==={}.toString.call(e).toLowerCase()},isFunction:function(e){return"[object function]"==={}.toString.call(e).toLowerCase()},notification:function(){var e,t;return function(i){if(e){clearTimeout(t);e.close()}if(window.Notification&&"granted"!==window.Notification.permission)Notification.requestPermission();if(window.Notification&&"denied"!=window.Notification.permission){e=new Notification(i.notify,{tag:i.tag,body:i.body,icon:window.__YSFSDKADR__+i.icon});util.playAudio();e.onclick=function(){e&&e.close();window.focus();ysf.openLayer();ysf.NotifyMsgAndBubble({category:"clearCircle"})};t=window.setTimeout(function(){e.close()},2e4)}}}(),playAudio:function(){if(window.__YSFSDKADR__){var e=document.createElement("audio");e.src=window.__YSFSDKADR__+"/prd/res/audio/message.mp3?26b875bad3e46bf6661b16a5d0080870";return function(){e.play()}}}()};window.ysf=window.ysf||{};ysf.ROOT=ysf.ROOT||"";ysf.VERSION="2.8.0";var winParam={};var cache={};var proxy;var chatProxy;var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var firstBtnClick=!0;var CircleNumberFlag=0;var msgSessionIds=[];var each=function(e,t){if(e&&t)for(var i in e)if(e.hasOwnProperty(i))t.call(null,i,e[i])};var rand=function(e){if(e)return"ysf-"+e;var t=[];for(var i=0,n;i<20;++i){n=Math.floor(Math.random()*chars.length);t.push(chars.charAt(n))}return t.join("").toLowerCase()};var migrate=function(){var e;if(/YSF_UID\s*=\s*(.*?)(?=;|$)/i.test(document.cookie))e=RegExp.$1;if(e)localStorage.setItem("YSF_UID",e);var e;if(/YSF_LAST\s*=\s*(.*?)(?=;|$)/i.test(document.cookie))e=RegExp.$1;if(e)localStorage.setItem("YSF_LAST",e);var t=new Date(1990,11,30).toGMTString();document.cookie="YSF_UID=;path=/;expires="+t;document.cookie="YSF_LAST=;path=/;expires="+t};var cmap={ack:function(e){cache.timestamp=parseInt(e,10);if(cache.onackdone){cache.onackdone();delete cache.onackdone}},rdy:function(e){syncProfile()}};var wrap=function(){var e=document.createElement("div"),t=e.style,i={top:0,left:0,visibility:"hidden",position:"absolute",width:"1px",height:"1px"};each(i,function(e,i){t[e]=i});document.body.appendChild(e);return e};var merge=function(e){each(e,function(e,t){cache[e]=t})};var refresh=function(e){e=e||"";var t=device(),i=lastUID();if(!t||""==e&&""!=i){t=e||t||rand(e);sendMsg("synckey:"+t)}cache.device=t;localStorage.setItem("YSF-"+cache["appKey"].toUpperCase()+"-UID",e||t);localStorage.setItem("YSF-"+cache["appKey"].toUpperCase()+"-LAST",e||"")};var serialize=function(e){var t=[];each(e,function(e,i){t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))});return t.join("&")};var device=function(){return localStorage.getItem("YSF-"+cache["appKey"].toUpperCase()+"-UID")||""};var lastUID=function(){return localStorage.getItem("YSF-"+cache["appKey"].toUpperCase()+"-LAST")||""};var updateDevice=function(){cache.device=rand();localStorage.setItem("YSF-"+cache["appKey"].toUpperCase()+"-UID",cache.device);sendMsg("synckey:"+cache.device)};var sendChatMsg=function(e,t){chatProxy.contentWindow.postMessage(""+e+":"+JSON.stringify(t),"*")};var visit=function(){if(cache.appKey){var e=new Image,t=serialize({uri:location.href,title:document.title,appkey:cache.appKey});e.src=ysf.DOMAIN+"webapi/user/accesshistory.action?"+t}};var syncProfile=function(){sendMsg("KEY:"+cache.appKey||"");var e={title:document.title||""};var t=function(e,t){var i=!1;e.forEach(function(e){if(e.key==t)i=!0});return i};each({name:"",email:"",mobile:"",avatar:"",profile:"data",bid:""},function(t,i){var n=cache[i]||cache[t];if(null!=n)e[t]=n});each({avatar:"头像"},function(i,n){try{if(!e[i])return;var o=JSON.parse(e["profile"]||"[]"),s=o.length;if(!t(o,i)){o.push({key:i,value:e[i],index:s,label:n});e["profile"]=JSON.stringify(o)}}catch(_){console.error("parse profile error: [crm]"+i,_)}});e.referrer=location.href;e.uid=cache.uid||"";sendMsg("USR:"+serialize(e))};var syncCustomProfile=function(e){syncProfile();sendMsg("PRODUCT:"+serialize(e))};var sendMsg=function(e){try{proxy.contentWindow.postMessage(e,"*")}catch(t){}};var msgNotifyLock=function(){var e=null;return function(t,i){var n=("YSFMSG-"+cache["appKey"]+"-"+t.id).toUpperCase();if(e)clearTimeout(e);setTimeout(function(){if(null==window.localStorage.getItem(n)){window.localStorage.setItem(n,1);i(!0)}i(!1)},100*cache["dvcTimer"])}}();var receiveMsg=function(e){if(e.origin==ysf.ROOT){var t=(e.data||"").split(":"),i=t.shift();if("pkg"!=i){var n=cmap[(i||"").toLowerCase()];if(n)n(t.join(":"))}else receivePkg(JSON.parse(t.join(":")))}};var receivePkg=function(e){var t={notify:function(e){var t="YSF-"+device()+"-MSGNUMBERS";msgNotifyLock(e,function(i){var n=Number(window.localStorage.getItem(t)||0),o=i?++n:n;cache["notifyContent"]=e;cache["notifyNumber"]=o;if(i)ysf._unread(ysf.getUnreadMsg());ysf.NotifyMsgAndBubble({category:"notifyCircle",data:{circleNum:o,notifyCnt:e.content,type:e.type}})})},winfocus:function(e){util.notification(e)},closeIframe:function(e){var t=document.getElementById("YSF-PANEL-CORPINFO")||document.getElementById("YSF-PANEL-INFO"),i=document.getElementById("YSF-BTN-HOLDER");t.className="ysf-chat-layer";t.setAttribute("data-switch",0);try{sendChatMsg("status",{layerOpen:0})}catch(n){}if(0==cache["hidden"])i.style.display="block"},leaveOk:function(e){if(util.resetTimer)clearTimeout(util.resetTimer);util.resetTimer=setTimeout(function(){reset()},1e3)},pushMsg:function(e){if(e.data.sdkAppend){CircleNumberFlag+=1;msgSessionIds.push(e.data.msgSessionId);ysf.NotifyMsgAndBubble({category:"notifyCircle",data:{circleNum:CircleNumberFlag,notifyCnt:e.data.content,type:"text"}})}}};var i=t[e.category];if(i)i(e)};var reset=function(){var e=document.getElementById("YSF-PANEL-CORPINFO")||document.getElementById("YSF-PANEL-INFO"),t=document.getElementById("YSF-BTN-HOLDER");document.body.removeChild(e);document.body.removeChild(t);ysf.init(cache["imgSrc"]);firstBtnClick=!0};var buildProxy=function(){if(!proxy){if(window.addEventListener)window.addEventListener("message",receiveMsg,!1);else window.attachEvent("onmessage",receiveMsg);proxy=wrap();proxy.innerHTML='<iframe style="height:0px; width:0px;" src="'+ysf.RESROOT+"res/delegate.html?"+ +new Date+'"></iframe>';proxy=proxy.getElementsByTagName("IFRAME")[0]}};var initWinConfig=function(){var e=window.screen||{};var t={base:",location=0,menubar=0,scrollbars=0,status=0,toolbar=0,resizable=0",winNoInfo:{width:600,height:630,top:Math.max(0,((e.height||0)-630)/2),left:Math.max(0,((e.width||0)-600)/2)},winHasInfo:{width:842,height:632,top:Math.max(0,((e.height||0)-630)/2),left:Math.max(0,((e.width||0)-840)/2)},layerNoInfo:{param:""},layerHasInfo:{param:""}};t.winNoInfo.param="top="+t.winNoInfo.top+",left="+t.winNoInfo.left+",width="+t.winNoInfo.width+",height="+t.winNoInfo.height+t.base;t.winHasInfo.param="top="+t.winHasInfo.top+",left="+t.winHasInfo.left+",width="+t.winHasInfo.width+",height="+t.winHasInfo.height+t.base;if(util.isMobilePlatform())cache["winType"]=3;switch(cache["winType"]){case 1:winParam=cache["corpInfo"]?t.layerHasInfo:t.layerNoInfo;winParam.type="layer";break;case 3:winParam={type:"url",param:""};break;default:winParam=cache["corpInfo"]?t.winHasInfo:t.winNoInfo;winParam.type="win"}};var initWinConfigTrade=function(){var e=window.screen||{};var t={base:",location=0,menubar=0,scrollbars=0,status=0,toolbar=0,resizable=0",winNoInfo:{width:980,height:632,top:Math.max(0,((e.height||0)-630)/2),left:Math.max(0,((e.width||0)-600)/2)},winHasInfo:{width:980,height:632,top:Math.max(0,((e.height||0)-630)/2),left:Math.max(0,((e.width||0)-840)/2)}};t.winNoInfo.param="top="+t.winNoInfo.top+",left="+t.winNoInfo.left+",width="+t.winNoInfo.width+",height="+t.winNoInfo.height+t.base;t.winHasInfo.param="top="+t.winHasInfo.top+",left="+t.winHasInfo.left+",width="+t.winHasInfo.width+",height="+t.winHasInfo.height+t.base;if(util.isMobilePlatform())cache["winType"]=3;switch(cache["winType"]){case 1:winParam=cache["corpInfo"]?t.layerHasInfo:t.layerNoInfo;winParam.type="layer";break;case 3:winParam={type:"url",param:""};break;default:winParam=cache["corpInfo"]?t.winHasInfo:t.winNoInfo;winParam.type="win"}};var createDvcTimer=function(){var e=localStorage.getItem("YSFDVC-"+cache.device),t=0;if(null!=e)t=Number(e)+1;
localStorage.setItem("YSFDVC-"+cache.device,t);cache.dvctimer=t};ysf.style=function(e){if(e){var t=document.getElementsByTagName("head")[0]||document.body,i=document.createElement("style");i.type="text/css";t.appendChild(i);if("textContent"in i)i.textContent=e;else if(i.styleSheet)i.styleSheet.cssText=e}};ysf.openInline=function(e,t){var i=ysf.url.apply(ysf);if(i){i=util.mergeUrl(i,{w:cache["winType"]});var n=function(e){var t=document.createElement("iframe");t.src=e;t.id="YSF-IFRAME-LAYER";t.style.width="100%";t.style.height="100%";return t};chatProxy=n(i);e.appendChild(chatProxy);util.addEvent(chatProxy,"load",function(){if(1==t)sendChatMsg("doconnect",{doconnect:1});else if(0==t&&1==cache["pushswitch"])sendChatMsg("dopushmsg",{pushMsgSwitch:1,pushMsgId:cache["pushmsgid"]})})}};ysf.entry=function(e){var t=function(){var t=document.createElement("div"),i="YSF-CUSTOM-ENTRY-"+window.__YSFTHEMELAYEROUT__;if(window.__YSFTHEMELAYEROUT__)t.className="layer-"+window.__YSFTHEMELAYEROUT__;t.setAttribute("id","YSF-BTN-HOLDER");if(1==cache["hidden"])t.style.display="none";document.body.appendChild(t);t.onclick=function(){ysf.open()};t.innerHTML='<div id="'+i+'"><img src="'+e.src+'"/></div>';return t};var i=function(e){var t=document.createElement("span");t.setAttribute("id","YSF-BTN-CIRCLE");e.appendChild(t)};var n=function(e){var t=document.createElement("div"),i=document.createElement("div"),n=document.createElement("span"),o=document.createElement("span");t.setAttribute("id","YSF-BTN-BUBBLE");i.setAttribute("id","YSF-BTN-CONTENT");n.setAttribute("id","YSF-BTN-ARROW");o.setAttribute("id","YSF-BTN-CLOSE");o.onclick=function(e){e.stopPropagation();e.preventDefault();ysf.NotifyMsgAndBubble({category:"clearCircle"})};e.appendChild(t);t.appendChild(i);t.appendChild(n);t.appendChild(o)};var o=t();i(o);n(o)};ysf.entryPanel=function(e){var t=document.createElement("div"),i=1==cache["winType"]?0:1;parseInt(e)?t.setAttribute("id","YSF-PANEL-CORPINFO"):t.setAttribute("id","YSF-PANEL-INFO");t.className="ysf-chat-layer";document.body.appendChild(t);t.setAttribute("data-switch",i);try{sendChatMsg("status",{layerOpen:i})}catch(n){}createDvcTimer();ysf.openInline(t,cache["dvcswitch"])};ysf.invite=function(){var e,t,i,n,o=document.createDocumentFragment();var s=function(){if(!e||!t){e=document.createElement("div");e.className="ysf-online-invite-mask";t=document.createElement("div");t.className="ysf-online-invite-wrap";t.innerHTML='<div class="ysf-online-invite"><div class="text"></div><div class="close" title="关闭"></div><img/></div>';var i=t.childNodes[0],o=i.childNodes,s=o[0];if("innerText"in s)s.innerText=n.text;else s.textContent=n.text;i.onclick=r;o[1].onclick=c;o[2].onload=function(){window.setTimeout(a,100)}}};var _=function(e){t.getElementsByTagName("IMG")[0].src=e};var a=function(){var e=t.childNodes[0];t.style.visibility="visible"};var r=function(){ysf.open();d()};var c=function(t){t=t||window.event||{};if(t.stopPropagation)t.stopPropagation();else t.cancelBubble=!0;if(e.parentNode!=o)d();if(0!=n.reject)window.setTimeout(l,1e3*n.interval)};var d=function(){o.appendChild(t);_(ysf.RESROOT+"res/nej_blank.gif")};var l=function(){var e=+new Date-(cache.timestamp||0);if(e<5e3);s();t.style.visibility="hidden";document.body.appendChild(t);_(n.src)};return function(e){if(!n)n=e||{};var t=function(){window.setTimeout(l,1e3*(n.timeout||0))};if(n.ignore||cache.timestamp)t();else cache.onackdone=t}}();ysf.openLayer=function(){return function(e,t){var i=document.getElementById("YSF-PANEL-CORPINFO")||document.getElementById("YSF-PANEL-INFO"),n=document.getElementById("YSF-BTN-HOLDER");if(i){n.style.display="none";i.className="ysf-chat-layer ysf-chat-layeropen";i.setAttribute("data-switch",1);try{sendChatMsg("status",{layerOpen:1})}catch(o){}}}}();ysf.openWin=function(){return function(e,t){window.open(e,"YSF_SERVICE_"+(cache.appKey||"").toUpperCase(),t.param)}}();ysf.openUrl=function(){return function(e,t){window.open(e,"YSF_SERVICE_"+(cache.appKey||"").toUpperCase(),t.param)}}();ysf.NotifyMsgAndBubble=function(e){var t={clearCircle:function(e){var t="YSF-"+device()+"-MSGNUMBERS",i=document.getElementById("YSF-BTN-CIRCLE"),n=document.getElementById("YSF-BTN-BUBBLE");n.style.display="none";i.style.display="none";localStorage.setItem(t,0);cache["notifyNumber"]=0;cache["notifyContent"]="";CircleNumberFlag=0},notifyCircle:function(e){var t="YSF-"+device()+"-MSGNUMBERS";localStorage.setItem(t,e.data.circleNum);var i=document.getElementById("YSF-BTN-BUBBLE"),n=document.getElementById("YSF-BTN-CONTENT"),o=document.getElementById("YSF-BTN-CIRCLE");var s=document.getElementById("YSF-PANEL-CORPINFO")||document.getElementById("YSF-PANEL-INFO");var _={image:function(e){return"[图片]"},audio:function(e){return"[音频]"},text:function(e){return e}};if(0==s.getAttribute("data-switch")&&_[e.data.type]&&0==cache["sdkCustom"]){o.style.display="block";i.style.display="block";o.innerHTML=e.data.circleNum>99?"99+":e.data.circleNum;n.innerHTML=_[e.data.type](e.data.notifyCnt)}}};var i=t[e.category];if(i)i(e)};ysf.getUnreadMsg=function(){return{type:cache["notifyContent"].type,message:cache["notifyContent"].content,total:cache["notifyNumber"]}};ysf.config=function(e){if(e){merge(e);if(cache.appKey){refresh(e.uid);visit();syncProfile();if(e.bid)initWinConfigTrade();else initWinConfig()}}};ysf.configTrade=function(e){if(e){merge(e);if(cache.appKey){refresh(e.uid);visit();syncProfile();initWinConfig()}}};ysf.url=function(e){if(!cache.appKey)return"";var t={k:cache.appKey,u:device(),gid:cache.groupid||0,sid:cache.staffid||0,qtype:cache.qtype||0,dvctimer:cache.dvctimer||0,robotShuntSwitch:cache.robotShuntSwitch||0};if(cache.bid)t.bid=cache.bid;each({n:"name",e:"email",m:"mobile"},function(e,i){var n=cache[i];if(n)t[e]=n});t.t=encodeURIComponent(document.title);if(e)return ysf.IMROOT+"/trade?"+serialize(t);else return ysf.IMROOT+"?"+serialize(t)};ysf.logoff=function(){updateDevice();util.clearLocalItems(util.findLocalItems(/msgnumbers/gi))};ysf.openByLink=function(e){var t=ysf.url();if(t){e=e||{};var i=e.target||e.srcElement;if(i&&"A"==i.tagName)i.href=t}};ysf.product=function(){var e=function(e){e.title=e.title&&e.title.length>100?e.title.slice(0,100):e.title;e.desc=e.desc&&e.desc.length>300?e.desc.slice(0,300):e.desc;e.note=e.note&&e.note.length>100?e.note.slice(0,100):e.note;return e};return function(t){t=e(t);if(cache.bid)t.bid=cache.bid;syncCustomProfile(t)}}();ysf.open=function(){if(cache.bid)var e=ysf.url.apply(ysf,[!0]);else var e=ysf.url.apply(ysf);if(e)switch(winParam.type){case"win":ysf.openWin(e,winParam);break;case"layer":ysf.openLayer(e,winParam);try{if(firstBtnClick&&0==cache["dvcswitch"]&&0==cache["pushswitch"]){sendChatMsg("doconnect",{doconnect:1});firstBtnClick=!1}}catch(t){}if(0==cache["dvcswitch"]&&1==cache["pushswitch"]||CircleNumberFlag>0){sendChatMsg("dopushmsgread",{ids:msgSessionIds});msgSessionIds=[]}ysf.NotifyMsgAndBubble({category:"clearCircle"});break;case"url":ysf.openUrl(e,winParam)}};ysf.openTrade=function(){var e=ysf.url.apply(ysf,[!0]);if(e)switch(winParam.type){case"win":ysf.openWin(e,winParam);break;case"url":ysf.openUrl(e,winParam)}};!function(){each({DOMAIN:ysf.ROOT+"/",IMROOT:function(){var e=1==window.__YSFWINTYPE__?ysf.ROOT+"/client/iframe":ysf.ROOT+"/client";if(util.isMobilePlatform())e=ysf.ROOT+"/client";return e}(),RESROOT:ysf.ROOT+"/sdk/"},function(e,t){if(null==ysf[e])ysf[e]=t});migrate();buildProxy()}();ysf.init=function(e){var t=function(){ysf.entry({src:e});if(1==cache["winType"])ysf.entryPanel(cache["corpInfo"])};if(1==window.__YSFWINTYPE__)setTimeout(function(){util.ajax({url:ysf.DOMAIN+"webapi/user/dvcSession.action?k="+cache["appKey"]+"&d="+cache["device"]+"&f="+cache["uid"],type:"post",success:function(e){if(200==e.code){cache["dvcswitch"]=e.result.dvcSwitch;cache["pushswitch"]=e.result.pushSwitch||0;cache["pushmsgid"]=e.result.batchIdList||0;t()}else{cache["dvcswitch"]=0;cache["pushswitch"]=0;t()}},error:function(){cache["dvcswitch"]=0;cache["pushswitch"]=0;t()}})},1e3);else{cache["dvcswitch"]=0;cache["pushswitch"]=0;t()}};util.addEvent(window,"beforeunload",function(){var e="YSFDVC-"+cache["device"],t="YSFMSG-"+cache["appKey"],i=Number(localStorage.getItem(e));if(i>0)localStorage.setItem(e,--i);util.clearLocalItems(util.findLocalItems(new RegExp(t,"ig")))});ysf.on=function(){var e={onload:"load",unread:1};return function(t){var i=Object.prototype.toString.call(t).slice(8,-1);if(/object/gi.test(i)){for(var n in t)if("onload"==n&&util.isFunction(t[n]))util.addEvent(proxy,e[n],t[n]);else if(util.isFunction(ysf[n])&&util.isFunction(t[n]))ysf["_"+n]=t[n]}else console.warn("波比(｡･∀･)ﾉ: 请保持正确的监听姿势...")}}();ysf.getPushMessage=function(e){sendChatMsg("dogetpushmsg",{ids:e})};ysf._unread=function(){};ysf.unread=function(){return{type:cache["notifyContent"].type,message:cache["notifyContent"].content,total:cache["notifyNumber"]}}}();if("undefined"==typeof I$)I$=function(){var e={},t=function(){return!1},i={};var n=function(t,i){return e.toString.call(t)==="[object "+i+"]"};return function(e,o){var s=i[e],_=n(o,"Function");if(null!=o&&!_)s=o;if(_){var a=[];for(var r=2,c=arguments.length;r<c;r++)a.push(arguments.callee(arguments[r]));var d={};a.push.call(a,d,{},t,[]);var l=o.apply(null,a)||d;if(!s||!n(l,"Object"))s=l;else if(Object.keys)for(var u=Object.keys(l),r=0,c=u.length,f;r<c;r++){f=u[r];s[f]=l[f]}else for(var f in l)s[f]=l[f]}if(null==s)s={};i[e]=s;return s}}();I$(41,function(e,t,i,n){var o=Function.prototype;o._$aop=function(e,t){var t=t||i,e=e||i,o=this;return function(){var i={args:n.slice.call(arguments,0)};e(i);if(!i.stopped){i.value=o.apply(this,i.args);t(i)}return i.value}};o._$bind=function(){var e=arguments,t=arguments[0],i=this;return function(){var o=n.slice.call(e,1);n.push.apply(o,arguments);return i.apply(t||null,o)}};o._$bind2=function(){var e=arguments,t=n.shift.call(e),i=this;return function(){n.push.apply(arguments,e);return i.apply(t||null,arguments)}};var o=String.prototype;if(!o.trim)o.trim=function(){var e=/(?:^\s+)|(?:\s+$)/g;
return function(){return this.replace(e,"")}}();if(!this.console)this.console={log:i,error:i};if(!0){NEJ=this.NEJ||{};NEJ.copy=function(e,i){e=e||{};i=i||t;for(var n in i)if(i.hasOwnProperty(n))e[n]=i[n];return e};NEJ=NEJ.copy(NEJ,{O:t,R:n,F:i,P:function(e){if(!e||!e.length)return null;var t=window;for(var i=e.split("."),n=i.length,o="window"==i[0]?1:0;o<n;t=t[i[o]]=t[i[o]]||{},o++);return t}});return NEJ}return e});I$(88,function(e,t,i,n){e.__forIn=function(e,t,i){if(!e||!t)return null;var n=Object.keys(e);for(var o=0,s=n.length,_,a;o<s;o++){_=n[o];a=t.call(i||null,e[_],_,e);if(a)return _}return null};e.__forEach=function(e,t,i){e.forEach(t,i)};e.__col2array=function(e){return n.slice.call(e,0)};e.__str2time=function(e){return Date.parse(e)};return e});I$(43,function(e,t,i,n,o){var s=this.navigator.platform,_=this.navigator.userAgent;var a={mac:s,win:s,linux:s,ipad:_,ipod:_,iphone:s,android:_};t._$IS=a;for(var r in a)a[r]=new RegExp(r,"i").test(a[r]);a.ios=a.ipad||a.iphone||a.ipod;a.tablet=a.ipad;a.desktop=a.mac||a.win||a.linux&&!a.android;t._$is=function(e){return!!a[e]};var c={engine:"unknow",release:"unknow",browser:"unknow",version:"unknow",prefix:{css:"",pro:"",clz:""}};t._$KERNEL=c;if(/msie\s+(.*?);/i.test(_)||/trident\/.+rv:([\d\.]+)/i.test(_)){c.engine="trident";c.browser="ie";c.version=RegExp.$1;c.prefix={css:"ms",pro:"ms",clz:"MS",evt:"MS"};var d={6:"2.0",7:"3.0",8:"4.0",9:"5.0",10:"6.0",11:"7.0"};c.release=d[document.documentMode]||d[parseInt(c.version)]}else if(/webkit\/?([\d.]+?)(?=\s|$)/i.test(_)){c.engine="webkit";c.release=RegExp.$1||"";c.prefix={css:"webkit",pro:"webkit",clz:"WebKit"}}else if(/rv\:(.*?)\)\s+gecko\//i.test(_)){c.engine="gecko";c.release=RegExp.$1||"";c.browser="firefox";c.prefix={css:"Moz",pro:"moz",clz:"Moz"};if(/firefox\/(.*?)(?=\s|$)/i.test(_))c.version=RegExp.$1||""}else if(/presto\/(.*?)\s/i.test(_)){c.engine="presto";c.release=RegExp.$1||"";c.browser="opera";c.prefix={css:"O",pro:"o",clz:"O"};if(/version\/(.*?)(?=\s|$)/i.test(_))c.version=RegExp.$1||""}if("unknow"==c.browser){var d=["chrome","maxthon","safari"];for(var l=0,u=d.length,f;l<u;l++){f="safari"==d[l]?"version":d[l];if(new RegExp(f+"/(.*?)(?=\\s|$)","i").test(_)){c.browser=d[l];c.version=RegExp.$1.trim();break}}}t._$SUPPORT={};t._$support=function(e){return!!t._$SUPPORT[e]};if(!0)e.copy(e.P("nej.p"),t);return t},41);I$(42,function(e,t,i,n,o,s){if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="4.0")I$(89,function(){e.__forIn=function(e,t,i){if(e&&t){var n;for(var o in e)if(e.hasOwnProperty(o)){n=t.call(i,e[o],o,e);if(n)return o}else;}};e.__forEach=function(e,t,i){for(var n=0,o=e.length;n<o;n++)t.call(i,e[n],n,e)};e.__col2array=function(e){var t=[];if(e&&e.length)for(var i=0,n=e.length;i<n;i++)t.push(e[i]);return t};e.__str2time=function(){var e=/-/g;return function(t){return Date.parse(t.replace(e,"/").split(".")[0])}}()});return e},88,43);I$(15,function(e,t,i,n,o,s){i._$klass=function(){var e=function(){return"[object Function]"!==n.toString.call(arguments[0])};var i=function(e,i){for(;i;){var n=i.prototype,o=t.__forIn(n,function(t){return e===t});if(null!=o)return{name:o,klass:i};i=i._$super}};return function(){var n=function(){return this.__init.apply(this,arguments)};n.prototype.__init=o;n._$extend=function(n,o){if(!e(n)){var s=this;if(o!==!1)t.__forIn(n,function(t,i){if(!e(t))s[i]=t});this._$super=n;var _=function(){};_.prototype=n.prototype;this.prototype=new _;this.prototype.constructor=this;var a=[],r={};var c=function(e,t){var n=i(e,t);if(n){if(a[a.length-1]!=n.name)a.push(n.name);r[n.name]=n.klass._$super;return n.name}};this.prototype.__super=function(){var e=a[a.length-1],t=arguments.callee.caller;if(!e)e=c(t,this.constructor);else{var i=r[e].prototype;if(!i.hasOwnProperty(t)||t!=i[e])e=c(t,this.constructor);else r[e]=r[e]._$super}var n=r[e].prototype[e].apply(this,arguments);if(e==a[a.length-1]){a.pop();delete r[e]}return n};if(!0){var d=this.prototype;d.__supInit=d.__super;d.__supReset=d.__super;d.__supDestroy=d.__super;d.__supInitNode=d.__super;d.__supDoBuild=d.__super;d.__supOnShow=d.__super;d.__supOnHide=d.__super;d.__supOnRefresh=d.__super;this._$supro=n.prototype}return this.prototype}};return n}}();if(!0){e.C=i._$klass;e.copy(this.NEJ,e)}return i},41,42);I$(1,function(e,t,i,n,o,s){var _=function(e,t){try{t=t.toLowerCase();if(null===e)return"null"==t;if(void 0===e)return"undefined"==t;else return n.toString.call(e).toLowerCase()=="[object "+t+"]"}catch(i){return!1}};i._$isFunction=function(e){return _(e,"function")};i._$isString=function(e){return _(e,"string")};i._$isNumber=function(e){return _(e,"number")};i._$isBoolean=function(e){return _(e,"boolean")};i._$isDate=function(e){return _(e,"date")};i._$isArray=function(e){return _(e,"array")};i._$isObject=function(e){return _(e,"object")};i._$length=function(){var e=/[^\x00-\xff]/g;return function(t){return(""+(t||"")).replace(e,"**").length}}();i._$loop=function(e,n,o){if(i._$isObject(e)&&i._$isFunction(n))return t.__forIn.apply(t,arguments);else return null};i._$indexOf=function(e,t){var n=i._$isFunction(t)?t:function(e){return e===t},o=i._$forIn(e,n);return null!=o?o:-1};i._$binSearch=function(){var e;var t=function(i,n,o){if(n>o)return-1;var s=Math.ceil((n+o)/2),_=e(i[s],s,i);if(0==_)return s;if(_<0)return t(i,n,s-1);else return t(i,s+1,o)};return function(i,n){e=n||o;return t(i,0,i.length-1)}}();i._$reverseEach=function(e,t,n){if(e&&e.length&&i._$isFunction(t))for(var o=e.length-1;o>=0;o--)if(t.call(n,e[o],o,e))return o;return null};i._$forEach=function(e,n,o){if(e&&e.length&&i._$isFunction(n))if(!e.forEach)i._$forIn.apply(i,arguments);else t.__forEach(e,n,o)};i._$forIn=function(e,t,n){if(!e||!i._$isFunction(t))return null;if(i._$isNumber(e.length)){for(var o=0,s=e.length;o<s;o++)if(t.call(n,e[o],o,e))return o}else if(i._$isObject(e))return i._$loop(e,t,n);return null};i._$encode=function(e,t){t=""+t;if(!e||!t)return t||"";else return t.replace(e.r,function(t){var i=e[!e.i?t.toLowerCase():t];return null!=i?i:t})};i._$escape=function(){var e=/<br\/?>$/,t={r:/\<|\>|\&|\r|\n|\s|\'|\"/g,"<":"&lt;",">":"&gt;","&":"&amp;"," ":"&nbsp;",'"':"&quot;","'":"&#39;","\n":"<br/>","\r":""};return function(n){n=i._$encode(t,n);return n.replace(e,"<br/><br/>")}}();i._$unescape=function(){var e={r:/\&(?:lt|gt|amp|nbsp|#39|quot)\;|\<br\/\>/gi,"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&#39;":"'","&quot;":'"',"<br/>":"\n"};return function(t){return i._$encode(e,t)}}();i._$format=function(){var e={i:!0,r:/\byyyy|yy|MM|cM|eM|M|dd|d|HH|H|mm|ms|ss|m|s|w|ct|et\b/g},t=["上午","下午"],n=["A.M.","P.M."],o=["日","一","二","三","四","五","六"],s=["一","二","三","四","五","六","七","八","九","十","十一","十二"],_=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];var a=function(e){e=parseInt(e)||0;return(e<10?"0":"")+e};var r=function(e){return e<12?0:1};return function(c,d,l){if(!c||!d)return"";c=i._$var2date(c);e.yyyy=c.getFullYear();e.yy=(""+e.yyyy).substr(2);e.M=c.getMonth()+1;e.MM=a(e.M);e.eM=_[e.M-1];e.cM=s[e.M-1];e.d=c.getDate();e.dd=a(e.d);e.H=c.getHours();e.HH=a(e.H);e.m=c.getMinutes();e.mm=a(e.m);e.s=c.getSeconds();e.ss=a(e.s);e.ms=c.getMilliseconds();e.w=o[c.getDay()];var u=r(e.H);e.ct=t[u];e.et=n[u];if(l)e.H=e.H%12;return i._$encode(e,d)}}();i._$var2date=function(e){var n=e;if(i._$isString(e))n=new Date(t.__str2time(e));if(!i._$isDate(n))n=new Date(e);return n};i._$fixed=function(e,t){return parseFloat(new Number(e).toFixed(t))};i._$absolute=function(){var e=/([^\/:])\/.*$/,t=/\/[^\/]+$/,i=/[#\?]/,n=location.href.split(/[?#]/)[0],o=document.createElement("a");var s=function(e){return(e||"").indexOf("://")>0};var _=function(e){return(e||"").split(i)[0].replace(t,"/")};var a=function(t,i){if(0==t.indexOf("/"))return i.replace(e,"$1")+t;else return _(i)+t};n=_(n);return function(e,t){e=(e||"").trim();if(!s(t))t=n;if(!e)return t;if(s(e))return e;e=a(e,t);o.href=e;e=o.href;return s(e)?e:o.getAttribute("href",4)}}();i._$url2origin=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){if(e.test(t||""))return RegExp.$1.toLowerCase();else return""}}();i._$string2object=function(e,t){var n={};i._$forEach((e||"").split(t),function(e){var t=e.split("=");if(t&&t.length){var i=t.shift();if(i)n[decodeURIComponent(i)]=decodeURIComponent(t.join("="))}});return n};i._$object2string=function(e,t,n){if(!e)return"";var o=[];i._$loop(e,function(e,t){if(!i._$isFunction(e)){if(i._$isDate(e))e=e.getTime();else if(i._$isArray(e))e=e.join(",");else if(i._$isObject(e))e=JSON.stringify(e);if(n)e=encodeURIComponent(e);o.push(encodeURIComponent(t)+"="+e)}});return o.join(t||",")};i._$query2object=function(e){return i._$string2object(e,"&")};i._$object2query=function(e){return i._$object2string(e,"&",!0)};i._$object2array=function(e){return t.__col2array(e)};i._$array2object=function(e,t){var n={};i._$forEach(e,function(e){var i=e;if(t)i=t(e);if(null!=i)n[i]=e});return n};i._$number2string=function(e,t){var i=(""+e).length,n=Math.max(1,parseInt(t)||0),o=n-i;if(o>0)e=new Array(o+1).join("0")+e;return""+e};i._$safeDelete=function(e,t){if(!i._$isArray(t))try{delete e[t]}catch(n){e[t]=void 0}else i._$forEach(t,function(t){i._$safeDelete(e,t)})};i._$randString=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";return function(t){t=t||10;var i=[];for(var n=0,o;n<t;++n){o=Math.floor(Math.random()*e.length);i.push(e.charAt(o))}return i.join("")}}();i._$randNumber=function(e,t){return Math.floor(Math.random()*(t-e)+e)};i._$randNumberString=function(e){e=Math.max(0,Math.min(e||8,30));var t=Math.pow(10,e-1),n=10*t;return i._$randNumber(t,n).toString()};i._$uniqueID=function(){var e=+new Date;return function(){return""+e++}}();i._$query=function(e,t){e=e||n;var i=(t||"").split(".");for(var o=0,s=i.length;o<s;o++){e=e[i[o]];if(!e)break}return e};i._$merge=function(){var e=arguments.length-1,t=arguments[e];if(i._$isFunction(t))e-=1;else t=o;var n=arguments[0]||{};for(var s=1;s<=e;s++)i._$loop(arguments[s],function(e,i){if(!t(e,i))n[i]=e});return n};i._$fetch=function(e,t){
if(t)i._$loop(e,function(e,i,n){var o=t[i];if(null!=o)n[i]=o});return e};i._$hasProperty=function(e){if(!e)return!1;if(null!=e.length)return e.length>0;var t=0;i._$loop(e,function(){t++;return t>0});return t>0};if(!0){e.Q=i._$query;e.X=i._$merge;e.EX=i._$fetch;e.copy(this.NEJ,e);e.copy(e.P("nej.u"),i)}return i},41,42);I$(175,function(e,t,i,n,o,s){var _={};i.__url2host=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){t=t||"";if(e.test(t))return RegExp.$1;else return location.protocol+"//"+location.host}}();i.__set=function(e,t){_[e]=t};i.__get=function(e){return _[e]};var a=function(){var e={portrait:{name:"portrait",dft:"portrait/"},"ajax.swf":{name:"ajax",dft:"nej_proxy_flash.swf"},"chart.swf":{name:"chart",dft:"nej_flex_chart.swf"},"audio.swf":{name:"audio",dft:"nej_player_audio.swf"},"video.swf":{name:"video",dft:"nej_player_video.swf"},"clipboard.swf":{name:"clipboard",dft:"nej_clipboard.swf"},"upload.image.swf":{name:"uploadimage",dft:"nej_upload_image.swf"}};var o=function(e){var t={};if(!e||!e.length)return t;for(var n=0,o=e.length,s;n<o;n++){s=e[n];if(s.indexOf("://")>0)t[i.__url2host(s)]=s}return t};return function(s){i.__set("root",s.root||"/res/");var _=i.__get("root");t._$loop(e,function(e,t,n){i.__set(t,s[e.name]||_+e.dft)});var a=s.p_csrf;if(a===!0)a={cookie:"AntiCSRF",param:"AntiCSRF"};a=a||n;i.__set("csrf",{param:a.param||"",cookie:a.cookie||""});i.__set("frames",o(s.p_frame));i.__set("flashs",o(s.p_flash))}}();a(this.NEJ_CONF||n);return i},41,1);I$(155,function(e,t,i,n,o,s){if("trident"===t._$KERNEL.engine)I$(176,function(){e.__set("storage.swf",(this.NEJ_CONF||n).storage||e.__get("root")+"nej_storage.swf")});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="3.0")I$(177,function(){e.__set("blank.png",(this.NEJ_CONF||n).blank||e.__get("root")+"nej_blank.gif")});return e},175,43);I$(107,function(e,t,i,n,o,s){i._$getFrameProxy=function(e){var n=t.__url2host(e);return i._$get("frames")[n]||n+"/res/nej_proxy_frame.html"};i._$getFlashProxy=function(e){return i._$get("flashs")[t.__url2host(e)]};i._$get=function(e){return t.__get(e)};if(!0)e.copy(e.P("nej.c"),i);return i},41,155);I$(68,function(e,t,i,n,o,s){var _=+new Date;i._$CODE_NOTFUND=1e4-_;i._$CODE_NOTASGN=10001-_;i._$CODE_NOTSPOT=10002-_;i._$CODE_TIMEOUT=10003-_;i._$CODE_ERREVAL=10004-_;i._$CODE_ERRCABK=10005-_;i._$CODE_ERRSERV=10006-_;i._$CODE_ERRABRT=10007-_;i._$HEAD_CT="Content-Type";i._$HEAD_CT_PLAN="text/plain";i._$HEAD_CT_FILE="multipart/form-data";i._$HEAD_CT_FORM="application/x-www-form-urlencoded";i._$BLANK_IMAGE=t._$get("blank.png")||"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(!0)e.copy(e.P("nej.g"),i);return i},41,107);I$(47,function(e,t){var i={};t._$merge=function(t){e._$merge(i,t)};t._$dump=function(){return i};t._$clear=function(){i={}};return t},1);I$(108,function(e,t,i,n,o,s){i.__getElementById=function(e,t){if(e.getElementById)return e.getElementById(""+t);try{return e.querySelector("#"+t)}catch(i){return null}};i.__getChildren=function(t){return e._$object2array(t.children)};i.__getElementsByClassName=function(t,i){return e._$object2array(t.getElementsByClassName(i))};i.__nextSibling=function(e){return e.nextElementSibling};i.__previousSibling=function(e){return e.previousElementSibling};i.__dataset=function(e,t,i){e.dataset=e.dataset||{};if(void 0!==i)e.dataset[t]=i;return e.dataset[t]};i.__getAttribute=function(e,t){return e.getAttribute(t)};i.__serializeDOM2XML=function(e){return(new XMLSerializer).serializeToString(e)||""};i.__parseDOMFromXML=function(e){var t=(new DOMParser).parseFromString(e,"text/xml").documentElement;return"parsererror"==t.nodeName?null:t};i.__fullScreen=function(){};i.__mask=function(){};i.__unmask=function(){};var _=t._$SUPPORT,a=t._$KERNEL.prefix;i.__isMatchedName=function(){var e=/^([a-z]+?)[A-Z]/;return function(t,i){return!!(i[t]||e.test(t)&&i[RegExp.$1])}}();i.__isNeedPrefixed=function(){var t=e._$array2object(["animation","transform","transition","appearance","userSelect","box","flex","column"]);return function(e){return i.__isMatchedName(e,t)}}();i.__fmtStyleName=function(){var e=/-([a-z])/g;return function(t){t=t||"";return t.replace(e,function(e,t){return t.toUpperCase()})}}();i.__getStyleName=function(){var e=/^[a-z]/,t=a.css||"";return function(n){n=i.__fmtStyleName(n);if(!i.__isNeedPrefixed(n))return n;else return t+n.replace(e,function(e){return e.toUpperCase()})}}();i.__getStyleValue=function(e,t){var n=window.getComputedStyle(e,null);return n[i.__getStyleName(t)]||""};i.__setStyleValue=function(e,t,n){e.style[i.__getStyleName(t)]=n};i.__getCSSMatrix=function(){var t=/\((.*?)\)/,i=/\s*,\s*/,n=["CSSMatrix",a.clz+"CSSMatrix"],o=["m11","m12","m21","m22","m41","m42"];var s=function(n){var s={};if(t.test(n||""))e._$forEach(RegExp.$1.split(i),function(e,t){s[o[t]]=e});return s};return function(t){var i;e._$forIn(n,function(e){if(this[e]){i=new this[e](t||"");return!0}});return!i?s(t):i}}();i.__injectCSSText=function(e,t){e.textContent=t};i.__processCSSText=function(){var t=/\$<(.*?)>/gi,o=/\{(.*?)\}/g,s="-"+a.css.toLowerCase()+"-",r={scale:"scale({x|1},{y|1})",rotate:"rotate({a})",translate:"translate({x},{y})",matrix:"matrix({m11},{m12},{m21},{m22},{m41},{m42})"},c={scale:"scale3d({x|1},{y|1},{z|1})",rotate:"rotate3d({x},{y},{z},{a})",translate:"translate3d({x},{y},{z})",matrix:"matrix3d({m11},{m12},{m13},{m14},{m21},{m22},{m23},{m24},{m31},{m32},{m33|1},{m34},{m41},{m42},{m43},{m44|1})"};var d=function(e,t){t=t||n;return e.replace(o,function(e,i){var n=i.split("|");return t[n[0]]||n[1]||"0"})};i.__processTransformValue=function(e,t){var i=(!_.css3d?r:c)[e.trim()];if(i)return d(i,t);else return""};return function(n){if(!n.replace)return n;else return n.replace(t,function(t,n){if("vendor"===n)return s;var o=(n||"").split("|");return i.__processTransformValue(o[0],e._$query2object(o[1]))||t})}}();i.__appendCSSText=function(e,t){var i=e.sheet,n=i.cssRules.length;i.insertRule(t,n);return i.cssRules[n]};i.__getClassList=function(){var e=/\s+/;return function(t){t=(t||"").trim();return t?t.split(e):null}}();i.__processClassName=function(t,n,o){if("replace"!=n)e._$forEach(i.__getClassList(o),function(e){t.classList[n](e)});else{i.__processClassName(t,"remove",o);i.__processClassName(t,"add",arguments[3])}};i.__hasClassName=function(t,n){var o=t.classList;if(!o||!o.length)return!1;else return e._$indexOf(i.__getClassList(n),function(e){return o.contains(e)})>=0};!function(){if(!_.css3d){var e=i.__getCSSMatrix();_.css3d=!!e&&null!=e.m41}}();return i},1,43);I$(69,function(e,t,i,n,o,s,_){if("trident"===t._$KERNEL.engine)I$(109,function(){e.__getChildren=e.__getChildren._$aop(function(e){var t=e.args[0];if(!t.children){e.stopped=!0;var n=[];i._$forEach(t.childNodes,function(e){if(1==e.nodeType)n.push(e)});e.value=n}})});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="6.0")I$(110,function(){e.__dataset=function(){var e={},t="data-",n=/\-(.{1})/gi;var o=function(o){var s=o.id;if(!e[s]){var _={};i._$forEach(o.attributes,function(e){var i=e.nodeName;if(0==i.indexOf(t)){i=i.replace(t,"").replace(n,function(e,t){return t.toUpperCase()});_[i]=e.nodeValue||""}});e[s]=_}};return function(t,i,n){o(t);var s=e[t.id];if(void 0!==n)s[i]=n;return s[i]}}()});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="5.0")I$(111,function(){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}e.__injectCSSText=function(){var t=30;return e.__injectCSSText._$aop(function(e){var i=e.args[0];if(i.styleSheet){e.stopped=!0;var n=e.args[1];var o=document.styleSheets;if(o.length>t){i=o[t];n=i.cssText+n}else i=i.styleSheet;i.cssText=n}})}();e.__getClassRegExp=function(){var e=/\s+/g;return function(t){t=(t||"").trim().replace(e,"|");return!t?null:new RegExp("(\\s|^)(?:"+t+")(?=\\s|$)","g")}}();e.__processClassName=function(t,i,n){n=n||"";var o=t.className||"",s=e.__getClassRegExp(n+" "+(arguments[3]||""));var _=o;if(s)_=_.replace(s,"");switch(i){case"remove":n="";break;case"replace":n=arguments[3]||""}_=(_+" "+n).trim();if(o!=_)t.className=_};e.__hasClassName=function(t,i){var n=e.__getClassRegExp(i);if(n)return n.test(t.className||"");else return!1}});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="4.0")I$(112,function(){e.__getElementsByClassName=function(e,t){var n=[],o=new RegExp("(\\s|^)(?:"+t.replace(/\s+/g,"|")+")(?=\\s|$)");i._$forEach(e.getElementsByTagName("*"),function(e){if(o.test(e.className))n.push(e)});return n};e.__nextSibling=function(e){for(;e=e.nextSibling;)if(1==e.nodeType)return e};e.__previousSibling=function(e){for(;e=e.previousSibling;)if(1==e.nodeType)return e};e.__serializeDOM2XML=function(e){return"xml"in e?e.xml:e.outerHTML};e.__parseDOMFromXML=function(){var e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.3.0"];var t=function(){try{for(var t=0,i=e.length;t<i;t++)return new ActiveXObject(e[t])}catch(n){return null}};return function(e){var i=t();if(i&&i.loadXML(e)&&!i.parseError.errorCode)return i.documentElement;else return null}}();e.__getStyleValue=function(){var t=/opacity\s*=\s*([\d]+)/i;var i={opacity:function(e){var i=0;if(t.test(e.filter||""))i=parseFloat(RegExp.$1)/100;return i}};return function(t,n){var o=t.currentStyle,s=i[n];if(s)return s(o);else return o[e.__getStyleName(n)]||""}}();e.__setStyleValue=function(){var t={opacity:function(e,t){e.style.filter="alpha(opacity="+100*t+")"}};return function(i,n,o){var s=t[n];if(s)s(i,o);else i.style[e.__getStyleName(n)]=o}}();e.__appendCSSText=function(e,t){var i=e.styleSheet,n=i.rules.length,o=t.split(/[\{\}]/);i.addRule(o[0],o[1],n);return i.rules[n]}});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="3.0")I$(113,function(){e.__getAttribute=e.__getAttribute._$aop(null,function(e){var t=e.args;if("maxlength"==t[1]&&2147483647==e.value)e.value=null})});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="2.0")I$(114,function(){e.__fullScreen=function(e,t){var i=e.style;i.width=t.scrollWidth+"px";i.height=t.scrollHeight+"px"};e.__mask=function(){var t={};e.__unmask=function(e){
var i=e.id,n=t[i];if(n){delete t[i];n.parentNode.removeChild(n)}};return function(e){var i=e.id,n=t[i];if(!n){n=document.createElement("iframe");n.style.position="absolute";t[i]=n}var o=n.style,s=e.style;o.top=(parseInt(s.top)||0)+"px";o.left=(parseInt(s.left)||0)+"px";o.width=e.offsetWidth+"px";o.height=e.offsetHeight+"px";e.insertAdjacentElement("beforeBegin",n);return n}}()});if("gecko"===t._$KERNEL.engine)I$(115,function(){if(!t._$SUPPORT.css3d)t._$SUPPORT.css3d="MozPerspective"in document.body.style;if(!("insertAdjacentElement"in document.body))HTMLElement.prototype.insertAdjacentElement=function(e,t){if(e&&t)switch(e){case"beforeEnd":this.appendChild(t);return;case"beforeBegin":this.parentNode.insertBefore(t,this);return;case"afterBegin":!this.firstChild?this.appendChild(t):this.insertBefore(t,this.firstChild);return;case"afterEnd":!this.nextSibling?this.parentNode.appendChild(t):this.parentNode.insertBefore(t,this.nextSibling);return}};if(!("innerText"in document.body)){HTMLElement.prototype["__defineGetter__"]("innerText",function(){return this.textContent});HTMLElement.prototype["__defineSetter__"]("innerText",function(e){this.textContent=e})}});return e},108,43,1);I$(17,function(e,t,i,n,o,s,_,a,r,c){var d={},l,u={},f={},h=document.createDocumentFragment();if(!document.head)document.head=document.getElementsByTagName("head")[0]||document.body;_.dump=function(){return{pool:u,dirty:f,fragment:h}};_._$id=d._$id=function(e){e=_._$get(e);if(e){var t=e.id?e.id:"auto-id-"+i._$uniqueID();if(!("id"in e))u[t]=e;e.id=t;if(!_._$get(t))f[t]=e;return t}};_._$get=function(e){try{var t=u[""+e]}catch(n){console.log(n)}if(t)return t;if(!i._$isString(e)&&!i._$isNumber(e))return e;var t=document.getElementById(e);if(!t)t=s.__getElementById(h,e);if(t)delete f[e];return t||f[e]};_._$getChildren=d._$getChildren=function(e,t){e=_._$get(e);if(!e)return null;var n=s.__getChildren(e);if(t)i._$reverseEach(n,function(e,i,n){if(!_._$hasClassName(e,t))n.splice(i,1)});return n};_._$getParent=function(){var e;var t=function(t,i){var n=t.split(":");if(n.length>1){if(!e)e={a:_._$attr,d:_._$dataset,c:_._$hasClassName,t:function(e,t){return(e.tagName||"").toLowerCase()===t}};var o=e[n[0]];if(o)return!!o(i,n[1]);t=n[1]}return!!_._$attr(i,t)||!!_._$dataset(i,t)||_._$hasClassName(i,t)};return function(e,n){e=_._$get(e);if(e){if(!n)return e;if(i._$isString(n))n=t._$bind(null,n);if(i._$isFunction(n)){for(;e;){if(n(e))return e;e=e.parentNode}return null}return e}}}();_._$getByClassName=d._$getByClassName=function(e,t){e=_._$get(e);return!e?null:s.__getElementsByClassName(e,t.trim())};_._$getSibling=d._$getSibling=function(){var e=function(){return!0};return function(t,n){t=_._$get(t);if(!t)return null;var o={backward:!1,filter:e};if(i._$isFunction(n))o.filter=n;else o=i._$fetch(o,n);var a=o.backward?s.__previousSibling:s.__nextSibling;for(;(t=a(t))&&!o.filter(t););return t}}();_._$getScrollViewPort=function(e){e=_._$get(e);if(e){e=e.parentNode;for(;e&&!(e.scrollHeight>e.clientHeight);)e=e.parentNode;if(e)return e}var t=document.body.scrollHeight,i=document.documentElement.scrollHeight;return i>=t?document.documentElement:document.body};_._$getPageBox=function(){var e=function(e){var t=0;i._$forEach(e,function(e){if(e)if(!t)t=e;else t=Math.min(t,e)});return t};var t=[{main:"scroll",sub:["Top","Left"],func:function(e,t,i){return Math.max(t["scroll"+e],i["scroll"+e])}},{main:"client",sub:["Width","Height"],func:function(t,i,n){return e([i["client"+t],i["offset"+t],n["client"+t],n["offset"+t]])}},{main:"scroll",sub:["Width","Height"],func:function(e,t,i,n){return Math.max(n["client"+e],t["scroll"+e],i["scroll"+e])}}];return function(e){var n={},o=e||document,s=o.body,_=o.documentElement;i._$forEach(t,function(e){var t=e.main;i._$forEach(e.sub,function(i){n[t+i]=e.func(i,s,_,n)})});return n}}();_._$getMaxBox=function(e,t){var n=i._$merge({},e),o=t.width/t.height,s=e.width/e.height;if(o>s&&e.height>t.height){n.height=t.height;n.width=n.height*s}if(o<s&&e.width>t.width){n.width=t.width;n.height=n.width/s}return n};_._$scrollTo=d._$scrollTo=function(e){var t=_._$offset(e);window.scrollTo(t.x,t.y)};_._$align=function(){var e=/\s+/;var t={left:function(){return 0},center:function(e,t){return(e.width-t.width)/2},right:function(e,t){return e.width-t.width},top:function(){return 0},middle:function(e,t){return(e.height-t.height)/2},bottom:function(e,t){return e.height-t.height}};return function(i,n,o){var s={},_=(o||"").split(e),a=t[_[1]]||t.middle,r=t[_[0]]||t.center;s.top=a(i,n);s.left=r(i,n);return s}}();_._$offset=d._$offset=function(){var e=function(e){return e==document.body||e==document.documentElement};return function(t,i){t=_._$get(t);if(!t)return null;i=_._$get(i)||null;var n=t,o={x:0,y:0},s,a,r;for(;n&&n!=i;){s=e(n)||n==t;a=s?0:n.scrollLeft;r=parseInt(_._$getStyle(n,"borderLeftWidth"))||0;o.x+=n.offsetLeft+r-a;a=s?0:n.scrollTop;r=parseInt(_._$getStyle(n,"borderTopWidth"))||0;o.y+=n.offsetTop+r-a;n=n.offsetParent}return o}}();_._$fullScreen=d._$fullScreen=function(e){e=_._$get(e);if(e)s.__fullScreen(e,_._$getPageBox())};_._$mask=d._$mask=function(e){e=_._$get(e);if(e){_._$id(e);return s.__mask(e)}return null};_._$unmask=d._$unmask=function(e){e=_._$get(e);if(e){_._$id(e);return s.__unmask(e)}return null};_._$create=function(){var e={a:{href:"#",hideFocus:!0},style:{type:"text/css"},link:{type:"text/css",rel:"stylesheet"},iframe:{frameBorder:0},script:{defer:!0,type:"text/javascript"}};return function(t,n,o){var s=document.createElement(t),a=e[t.toLowerCase()];i._$merge(s,a);if(n)s.className=n;o=_._$get(o);if(o)o.appendChild(s);else if(!a)h.appendChild(s);return s}}();_._$createXFrame=function(){var e=function(){if(location.hostname==document.domain)return"about:blank";else return'javascript:(function(){document.open();document.domain="'+document.domain+'";document.close();})();'};var t=function(e){e=e.trim();if(!e)return _._$create("iframe");var t;try{t=document.createElement('<iframe name="'+e+'"></iframe>');t.frameBorder=0}catch(i){t=_._$create("iframe");t.name=e}return t};return function(o){o=o||a;var s=t(o.name||"");if(!o.visible)s.style.display="none";if(i._$isFunction(o.onload))n._$addEvent(s,"load",function(e){if(s.src){n._$clearEvent(s,"load");o.onload(e)}});var r=o.parent;if(i._$isFunction(r))try{r(s)}catch(c){}else(_._$get(r)||document.body).appendChild(s);var d=o.src||e();window.setTimeout(function(){s.src=d},0);return s}}();_._$remove=d._$remove=function(){var e={img:function(e){e.src=t._$BLANK_IMAGE},iframe:function(e){e.src="about:blank"}};var o=function(t,n){if(n){if(t.getElementsByTagName)i._$forEach(t.getElementsByTagName(n),o)}else{var s=(t.tagName||"").toLowerCase(),_=e[s];if(_)_(t)}};return function(e){e=_._$get(e);if(e){if(!arguments[1])n._$clearEvent(e);o(e);o(e,"img");o(e,"iframe");if(e.parentNode)e.parentNode.removeChild(e)}}}();_._$removeByEC=d._$removeByEC=function(e){e=_._$get(e);if(e)try{h.appendChild(e)}catch(t){console.error(t)}};_._$clearChildren=d._$clearChildren=function(e){e=_._$get(e);if(e)i._$reverseEach(e.childNodes,function(e){_._$remove(e)})};_._$wrapInline=d._$wrapInline=function(){var e,t=/\s+/;var i=function(){if(!e){e=_._$pushCSSText(".#<uispace>{position:relative;zoom:1;}.#<uispace>-show{position:absolute;top:0;left:100%;cursor:text;white-space:nowrap;overflow:hidden;}");_._$dumpCSSText()}};return function(n,o){n=_._$get(n);if(!n)return null;i();o=o||a;var s=n.parentNode;if(!_._$hasClassName(s,e)){s=_._$create("span",e);n.insertAdjacentElement("beforeBegin",s);s.appendChild(n)}var r=o.nid||"",c=_._$getByClassName(s,r||e+"-show")[0];if(!c){var d=((o.clazz||"")+" "+r).trim();d=e+"-show"+(!d?"":" ")+d;c=_._$create(o.tag||"span",d);s.appendChild(c)}var d=o.clazz;if(d){d=(d||"").trim().split(t)[0]+"-parent";_._$addClassName(s,d)}return c}}();_._$dataset=d._$dataset=function(e,t,n){var o=_._$id(e);if(!o)return null;if(i._$isString(t))return s.__dataset(_._$get(e),t,n);if(i._$isObject(t)){var a={};i._$forIn(t,function(e,t){a[t]=_._$dataset(o,t,e)});return a}if(i._$isArray(t)){var a={};i._$forEach(t,function(e){a[e]=_._$dataset(o,e)});return a}return null};_._$attr=d._$attr=function(e,t,i){e=_._$get(e);if(!e)return"";if(void 0!==i&&e.setAttribute)e.setAttribute(t,i);return s.__getAttribute(e,t)};_._$html2node=function(){var e=/<(.*?)(?=\s|>)/i,t={li:"ul",tr:"tbody",td:"tr",th:"tr",option:"select"};return function(i){var n;if(e.test(i))n=t[(RegExp.$1||"").toLowerCase()]||"";var o=_._$create(n||"div");o.innerHTML=i;var s=_._$getChildren(o);return s.length>1?o:s[0]}}();_._$dom2xml=d._$dom2xml=function(e){e=_._$get(e);return!e?"":s.__serializeDOM2XML(e)};_._$xml2dom=function(e){e=(e||"").trim();return!e?null:s.__parseDOMFromXML(e)};_._$dom2object=d._$dom2object=function(e,t){t=t||{};e=_._$get(e);if(!e)return t;var n=e.tagName.toLowerCase(),o=_._$getChildren(e);if(!o||!o.length){t[n]=e.textContent||e.text||"";return t}var s={};t[n]=s;i._$forEach(o,function(e){_._$dom2object(e,s)});return t};_._$xml2object=function(e){try{return _._$dom2object(_._$xml2dom(e))}catch(t){return null}};_._$text2type=function(){var e={xml:function(e){return _._$xml2dom(e)},json:function(e){try{return JSON.parse(e)}catch(t){return null}},dft:function(e){return e}};return function(t,i){i=(i||"").toLowerCase();return(e[i]||e.dft)(t||"")}}();_._$style=d._$style=function(e,t){e=_._$get(e);if(e)i._$loop(t,function(t,i){_._$setStyle(e,i,t)})};_._$setStyle=d._$setStyle=function(e,t,i){e=_._$get(e);if(e)s.__setStyleValue(e,t,s.__processCSSText(i))};_._$getStyle=d._$getStyle=function(e,t){e=_._$get(e);return!e?"":s.__getStyleValue(e,t)};_._$addScript=function(e){try{e=e.trim();if(e)return new Function(e)()}catch(t){console.error(t.message);console.error(t.stack)}};_._$addStyle=function(){var e=/[\s\r\n]+/gi;return function(t){t=(t||"").replace(e," ").trim();var i=null;if(t){i=_._$create("style");document.head.appendChild(i);s.__injectCSSText(i,s.__processCSSText(t))}return i}}();_._$pushCSSText=function(){var e=/#<(.*?)>/g,t=+new Date;return function(t,n){
if(!l)l=[];var o="auto-"+i._$uniqueID(),s=i._$merge({uispace:o},n);l.push(t.replace(e,function(e,t){return s[t]||e}));return o}}();_._$dumpCSSText=function(){if(l){_._$addStyle(l.join(" "));l=null}};_._$appendCSSText=d._$appendCSSText=function(e,t){e=_._$get(e);return!e?null:s.__appendCSSText(e,s.__processCSSText(t))};_._$addClassName=d._$addClassName=function(e,t){if(t){e=_._$get(e);if(e)s.__processClassName(e,"add",t)}};_._$delClassName=d._$delClassName=function(e,t){e=_._$get(e);if(e)s.__processClassName(e,"remove",t)};_._$replaceClassName=d._$replaceClassName=function(e,t,i){e=_._$get(e);if(e)s.__processClassName(e,"replace",t,i)};_._$hasClassName=d._$hasClassName=function(e,t){e=_._$get(e);if(e)return s.__hasClassName(e,t);else return!1};_._$matrix=function(e){e=(e||"").trim();return s.__getCSSMatrix(e)};_._$css3d=d._$css3d=function(e,t,i){e=_._$get(e);if(e){var n=s.__processTransformValue(t,i);if(n)_._$setStyle(e,"transform",n)}};o._$merge(d);if(!0)e.copy(e.P("nej.e"),_);return _},41,68,1,16,47,69);I$(116,function(e,t,i,n,o,s){i.__checkEvent=function(){var e={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},i=t._$KERNEL.prefix,n={transitionend:"TransitionEnd",animationend:"AnimationEnd",animationstart:"AnimationStart",animationiteration:"AnimationIteration",visibilitychange:"visibilitychange",fullscreenchange:"fullscreenchange"};var o={enter:function(e,t,i){var n={type:"keypress"};if(i)n.handler=function(t){if(13===t.keyCode)i.call(e,t)};return n}};var s=function(e){return(i.evt||i.pro)+e};return function(t,i,_){var a={type:i,handler:_};if(!("on"+i in t)){var r=e[i];if(r){a.type=r;return a}var r=n[i];if(r){a.type=s(r);return a}var c=o[i];if(c)return c.apply(null,arguments)}return a}}();i.__addEvent=function(){var e=arguments;if(!1)if(!("on"+e[1]in e[0]))console.log("not support event["+e[1]+"] for "+e[0]);e[0].addEventListener(e[1],e[2],e[3])};i.__delEvent=function(){var e=arguments;e[0].removeEventListener(e[1],e[2],e[3])};i.__dispatchEvent=function(t,i,n){var o=document.createEvent("Event");o.initEvent(i,!0,!0);e._$merge(o,n);t.dispatchEvent(o)};return i},1,43);I$(70,function(e,t,i,n,o,s,_){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release>="6.0")I$(117,function(){t.__checkEvent=function(){var e={touchcancel:"MSPointerCancel",touchstart:"MSPointerDown",touchmove:"MSPointerMove",touchend:"MSPointerUp",fullscreenchange:"MSFullscreenChange"};return t.__checkEvent._$aop(function(t){var i=t.args;var n=e[i[1]];if(n){t.stopped=!0;t.value={type:n,handler:i[2]}}})}()});if("trident"===e._$KERNEL.engine&&"5.0"==e._$KERNEL.release)I$(118,function(){t.__checkEvent=function(){var e={};var i={input:function(t,i,n){if(!n)return{type:i};else return{type:i,handler:function(i){var o=t.id;e[o]=t.value;n.call(t,i)},link:[[document,"selectionchange",function(i){var o=t.id;if(t==document.activeElement){if(e[o]!==t.value){e[o]=t.value;n.call(t,i)}}else delete e[o]}]]}}};return t.__checkEvent._$aop(function(e){var t=e.args;var n=i[t[1]];if(n){e.stopped=!0;e.value=n.apply(null,t)}})}()});if("trident"===e._$KERNEL.engine&&e._$KERNEL.release>="5.0")I$(119,function(){var e={propertychange:1};t.__addEvent=t.__addEvent._$aop(function(t){var i=t.args;if(null!=e[i[1]]&&i[0].attachEvent){t.stopped=!0;i[0].attachEvent("on"+i[1],i[2])}});t.__delEvent=t.__delEvent._$aop(function(t){var i=t.args,n=e[i[1]];if(null!=e[i[1]]&&i[0].detachEvent){t.stopped=!0;i[0].detachEvent("on"+i[1],i[2])}})});if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="4.0")I$(120,function(){t.__checkEvent=function(){var e={};var i={input:function(t,i,n){var o={type:"propertychange"};if(n){var s=t.id;var _=function(i){if(t.value&&!e["x-"+s]){e["x-"+s]=!0;n.call(t,i)}};o.handler=function(i){if("value"in t&&"value"==i.propertyName){if(e[s])return;e[s]=!0;n.call(t,i);delete e[s]}};o.link=[[t,"keyup",_],[t,"mouseup",_],[t,"mousemove",_]];o.destroy=function(){delete e[s];delete e["x-"+s]}}return o},load:function(e,t,i){var n={type:"readystatechange"};if(i)n.handler=function(t){if("loaded"==e.readyState||"complete"==e.readyState)i.call(e,t)};return n}};return t.__checkEvent._$aop(function(e){var t=e.args;var n=i[t[1]];if(n){e.stopped=!0;e.value=n.apply(null,t)}if(t[2])t[2]=t[2]._$bind(t[0])})}();t.__addEvent=function(){var e=arguments;if(!1)if(!("on"+e[1]in e[0]))console.log("not support event["+e[1]+"] for "+e[0]);e[0].attachEvent("on"+e[1],e[2])};t.__delEvent=function(){var e=arguments;e[0].detachEvent("on"+e[1],e[2])};t.__dispatchEvent=function(){var e={propertychange:{propertyName:"value"}};return function(t,n,o){var s=document.createEventObject();try{i._$merge(s,e[n],o);t.fireEvent("on"+n,s)}catch(_){console.error(_.message);console.error(_.stack)}}}()});if("gecko"===e._$KERNEL.engine)I$(121,function(){t.__checkEvent=function(){var e=/^(?:transitionend|animationend|animationstart|animationiteration)$/i;var i={mousewheel:function(e,t,i){var n={type:"MozMousePixelScroll"};if(i)n.handler=function(t){var n=t.detail;t.wheelDelta=-n;t.wheelDeltaY=-n;t.wheelDeltaX=0;i.call(e,t)};return n}};return t.__checkEvent._$aop(function(t){var n=t.args;if(e.test(n[1])){t.stopped=!0;t.value={type:n[1],handler:n[2]}}var o=i[n[1]];if(o){t.stopped=!0;t.value=o.apply(null,n)}})}()});return t},43,116,1);I$(16,function(e,t,i,n,o,s,_,a,r){var c={},d={};var l=function(){var e=/[\s,;]+/;return function(t){var t=(t||"").trim().toLowerCase();return!t?null:t.split(e)}}();var u=function(e,i,n){var o="page"+i;return null!=e[o]?e[o]:e["client"+i]+t._$getPageBox()["scroll"+n]};var f=function(e,t,i){var n="scroll"+i;_node=s._$getElement(e),_xret=u(e,t,i);for(;_node&&_node!=document.body&&_node!=document.documentElement;){_xret+=_node[n]||0;_node=_node.parentNode}return _xret};var h=function(e,n,o,s){var _={};e=t._$get(e);if(!e)return null;t._$id(e);_.element=e;if(!i._$isFunction(o))return null;_.handler=o;var n=l(n);if(!n)return null;_.type=n;_.capture=!!s;return _};s._$addEvent=d._$addEvent=function(){var e=function(e,i,n){var o=t._$id(i.element),s=c[o]||{},_=s[e]||[];_.push({type:n.type||e,func:n.handler||i.handler,sfun:i.handler,capt:i.capture,link:n.link,destroy:n.destroy});s[e]=_;c[o]=s};return function(){var n=h.apply(null,arguments);if(n)i._$forEach(n.type,function(s){var _=o.__checkEvent(n.element,s,n.handler);o.__addEvent(n.element,_.type,_.handler,n.capture);i._$forIn(_.link,function(e){e[3]=!!e[3];o.__addEvent.apply(o,e);e[0]=t._$id(e[0])});e(s,n,_)})}}();s._$delEvent=d._$delEvent=function(){var e=function(e,n){var o=t._$id(n.element),s=c[o]||_,a=s[e],r=i._$indexOf(a,function(e){return e.sfun===n.handler&&e.capt===n.capture});var d=null;if(r>=0){var l=a.splice(r,1)[0];d=[[n.element,l.type,l.func,n.capture]];if(l.link){i._$forEach(l.link,function(e){e[0]=t._$get(e[0])});d.push.apply(d,l.link)}if(l.destroy)l.destroy();if(!a.length)delete s[e];if(!i._$hasProperty(s))delete c[o]}return d};return function(){var t=h.apply(null,arguments);if(t)i._$forEach(t.type,function(n){i._$forEach(e(n,t),function(e){o.__delEvent.apply(o,e)})})}}();s._$clearEvent=d._$clearEvent=function(){var e=function(e,t,n){i._$reverseEach(n,function(i){s._$delEvent(e,t,i.sfun,i.capt)})};return function(n,o){var _=t._$id(n);if(_){var a=c[_];if(a){o=l(o);if(o)i._$forEach(o,function(t){e(_,t,a[t])});else i._$loop(a,function(e,t){s._$clearEvent(n,t)})}}}}();s._$dispatchEvent=d._$dispatchEvent=function(e,n,s){var e=t._$get(e);if(e)i._$forEach(l(n),function(t){var i=o.__checkEvent(e,t);o.__dispatchEvent(e,i.type,s)})};s._$getElement=function(){var e;var n=function(i,n){var o=i.split(":");if(o.length>1){if(!e)e={a:t._$attr,d:t._$dataset,c:t._$hasClassName,t:function(e,t){return(e.tagName||"").toLowerCase()===t}};var s=e[o[0]];if(s)return!!s(n,o[1]);i=o[1]}return!!t._$attr(n,i)||!!t._$dataset(n,i)||t._$hasClassName(n,i)};return function(e){if(!e)return null;var t=e.target||e.srcElement,o=arguments[1];if(!o)return t;if(i._$isString(o))o=n._$bind(null,o);if(i._$isFunction(o)){for(;t;){if(o(t))return t;t=t.parentNode}return null}return t}}();s._$stop=function(e){s._$stopBubble(e);s._$stopDefault(e)};s._$stopBubble=function(e){if(e)e.stopPropagation?e.stopPropagation():e.cancelBubble=!0};s._$stopDefault=function(e){if(e)e.preventDefault?e.preventDefault():e.returnValue=!1};s._$page=function(e){return{x:s._$pageX(e),y:s._$pageY(e)}};s._$pageX=function(e){return f(e,"X","Left")};s._$pageY=function(e){return f(e,"Y","Top")};s._$clientX=function(e){return u(e,"X","Left")};s._$clientY=function(e){return u(e,"Y","Top")};n._$merge(d);if(!0)e.copy(e.P("nej.v"),s);return s},41,17,1,47,70);!function(){if("undefined"==typeof TrimPath){TrimPath={};if("undefined"!=typeof exports)TrimPath=exports}var e={},t=[],i=/\s+/g,n=+new Date,o,s,_;var a=function(){var e=/^\s*[\[\{'"].*?[\]\}'"]\s*$/,t=/[\&\|\<\>\+\-\*\/\%\,\(\)\[\]\?\:\!\=\;]/,i=/^(?:defined|null|undefined|true|false|instanceof|new|this|typeof|\$v|[\d]+)$/i,n=/^new\s+/,o=/['"]/;var s=function(t){if(!e.test(t)){t=t.split(".")[0].trim();if(t&&!o.test(t)){t=t.replace(n,"");try{if(i.test(t))return;_[t]=1}catch(s){}}}};return function(i){i=i||"";if(i&&!e.test(i)){var n=i.split(t);for(var o=0,_=n.length;o<_;o++)s(n[o])}}}();var r=function(e){if("in"!=e[2])throw"bad for loop statement: "+e.join(" ");t.push(e[1]);a(e[3]);return"var __HASH__"+e[1]+" = "+e[3]+","+e[1]+","+e[1]+"_count=0;if (!!__HASH__"+e[1]+")for(var "+e[1]+"_key in __HASH__"+e[1]+"){"+e[1]+" = __HASH__"+e[1]+"["+e[1]+"_key];if (typeof("+e[1]+')=="function") continue;'+e[1]+"_count++;"};var c=function(){var e=t[t.length-1];return"}; if(!__HASH__"+e+"||!"+e+"_count){"};var d=function(){t.pop();return"};"};var l=function(e){if("as"!=e[2])throw"bad for list loop statement: "+e.join(" ");var t=e[1].split("..");if(t.length>1){a(t[0]);a(t[1]);return"for(var "+e[3]+","+e[3]+"_index=0,"+e[3]+"_beg="+t[0]+","+e[3]+"_end="+t[1]+","+e[3]+"_length=parseInt("+e[3]+"_end-"+e[3]+"_beg+1);"+e[3]+"_index<"+e[3]+"_length;"+e[3]+"_index++){"+e[3]+" = "+e[3]+"_beg+"+e[3]+"_index;"}else{a(e[1]);return"for(var __LIST__"+e[3]+" = "+e[1]+","+e[3]+","+e[3]+"_index=0,"+e[3]+"_length=__LIST__"+e[3]+".length;"+e[3]+"_index<"+e[3]+"_length;"+e[3]+"_index++){"+e[3]+" = __LIST__"+e[3]+"["+e[3]+"_index];";
}};var u=function(e){if(e&&e.length){e.shift();var t=e[0].split("(")[0];return"var "+t+" = function"+e.join("").replace(t,"")+"{var __OUT=[];"}};var f=function(e){if(!e[1])throw"bad include statement: "+e.join(" ");return'if (typeof inline == "function"){__OUT.push(inline('};var h=function(e,t){a(t.slice(1).join(" "));return e};var m=function(e){return h("if(",e)};var p=function(e){return h("}else if(",e)};var $=function(e){return h("var ",e)};s={blk:/^\{(cdata|minify|eval)/i,tag:"forelse|for|list|if|elseif|else|var|macro|break|notrim|trim|include",def:{"if":{pfix:m,sfix:"){",pmin:1},"else":{pfix:"}else{"},elseif:{pfix:p,sfix:"){",pdft:"true"},"/if":{pfix:"}"},"for":{pfix:r,pmin:3},forelse:{pfix:c},"/for":{pfix:d},list:{pfix:l,pmin:3},"/list":{pfix:"};"},"break":{pfix:"break;"},"var":{pfix:$,sfix:";"},macro:{pfix:u},"/macro":{pfix:'return __OUT.join("");};'},trim:{pfix:function(){o=!0}},"/trim":{pfix:function(){o=null}},inline:{pfix:f,pmin:1,sfix:"));}"}},ext:{seed:function(e){return(e||"")+""+n},"default":function(e,t){return e||t}}};var g=function(){var e=/\\([\{\}])/g;return function(t,n){t=t.replace(e,"$1");var o=t.slice(1,-1).split(i),_=s.def[o[0]];if(_){if(_.pmin&&_.pmin>=o.length)throw"Statement needs more parameters:"+t;n.push(_.pfix&&"string"!=typeof _.pfix?_.pfix(o):_.pfix||"");if(_.sfix){if(o.length<=1){if(_.pdft)n.push(_.pdft)}else for(var a=1,r=o.length;a<r;a++){if(a>1)n.push(" ");n.push(o[a])}n.push(_.sfix)}}else y(t,n)}}();var v=function(e,t){if(e&&e.length)if(1!=e.length){var i=e.pop().split(":");t.push("__MDF['"+i.shift()+"'](");v(e,t);if(i.length>0){var n=i.join(":");a(n);t.push(","+n)}t.push(")")}else{var o=e.pop();a(o);t.push(""==o?'""':o)}};var y=function(e,t){if(e){var i=e.split("\n");if(i&&i.length)for(var n=0,s=i.length,_;n<s;n++){_=i[n];if(o){_=_.trim();if(!_)continue}b(_,t);if(o&&n<s-1)t.push("__OUT.push('\\n');")}}};var b=function(){var e=/\|\|/g,t=/#@@#/g;return function(i,n){var o="}",s=-1,_=i.length,a,r,c,d,l;for(;s+o.length<_;){a="${";r="}";c=i.indexOf(a,s+o.length);if(c<0)break;if("%"==i.charAt(c+2)){a="${%";r="%}"}d=i.indexOf(r,c+a.length);if(d<0)break;C(i.substring(s+o.length,c),n);l=i.substring(c+a.length,d).replace(e,"#@@#").split("|");for(var u=0,f=l.length;u<f;l[u]=l[u].replace(t,"||"),u++);n.push("__OUT.push(");v(l,n);n.push(");");o=r;s=d}C(i.substring(s+o.length),n)}}();var C=function(){var e={r:/\n|\\|\'/g,"\n":"\\n","\\":"\\\\","'":"\\'"};var t=function(t){return(t||"").replace(e.r,function(t){return e[t]||t})};return function(e,i){if(e)i.push("__OUT.push('"+t(e)+"');")}}();var S=function(){var e=/\t/g,t=/\n/g,n=/\r\n?/g;var o=function(e,t){var i=e.indexOf("}",t+1);for(;"\\"==e.charAt(i-1);)i=e.indexOf("}",i+1);return i};var a=function(){var e=[],t=arguments[0];for(var i in t){i=(i||"").trim();if(i)e.push(i+"=$v('"+i+"')");else;}return e.length>0?"var "+e.join(",")+";":""};return function(r){_={};r=r.replace(n,"\n").replace(e,"    ");var c=["if(!__CTX) return '';",""];c.push("function $v(__NAME){var v = __CTX[__NAME];return v==null?window[__NAME]:v;};");c.push("var defined=function(__NAME){return __CTX[__NAME]!=null;},");c.push("__OUT=[];");var d=-1,l=r.length;var u,f,h,m,p,$,v,b;for(;d+1<l;){u=d;u=r.indexOf("{",u+1);for(;u>=0;){f=o(r,u);h=r.substring(u,f);m=h.match(s.blk);if(m){p=m[1].length+1;$=r.indexOf("}",u+p);if($>=0){v=$-u-p<=0?"{/"+m[1]+"}":h.substr(p+1);p=r.indexOf(v,$+1);if(p>=0){y(r.substring(d+1,u),c);b=r.substring($+1,p);switch(m[1]){case"cdata":C(b,c);break;case"minify":C(b.replace(t," ").replace(i," "),c);break;case"eval":if(b)c.push("__OUT.push((function(){"+b+"})());")}u=d=p+v.length-1}}}else if("$"!=r.charAt(u-1)&&"\\"!=r.charAt(u-1)&&0==h.substr("/"==h.charAt(1)?2:1).search(s.tag))break;u=r.indexOf("{",u+1)}if(u<0)break;f=o(r,u);if(f<0)break;y(r.substring(d+1,u),c);g(r.substring(u,f+1),c);d=f}y(r.substring(d+1),c);c.push(';return __OUT.join("");');c[1]=a(_);_=null;return new Function("__CTX","__MDF",c.join(""))}}();TrimPath.seed=function(){return n};TrimPath.merge=function(){var t={};TrimPath.dump=function(){return{func:t,text:e}};return function(i,n,o){try{n=n||{};if(!t[i]&&!e[i])return"";if(!t[i]){t[i]=S(e[i]);delete e[i]}if(o)for(var _ in s.ext)if(!o[_])o[_]=s.ext[_];return t[i](n,o||s.ext)}catch(a){return a.message||""}}}();TrimPath.parse=function(){var t=+new Date;return function(i,n){if(!i)return"";n=n||"ck-"+t++;if(null!=e[n]){console.warn("jst template overwrited with key "+n);console.debug("old template content: "+e[n].replace(/\n/g," "));console.debug("new template content: "+i.replace(/\n/g," "))}e[n]=i;return n}}()}();I$(18,function(e,t,i,n,o,s,_,a,r){var c={};s._$seed=TrimPath.seed;s._$get=function(){var e=function(e){return!s._$getTextTemplate?"":s._$getTextTemplate(e)};return function(i,n,o){n=n||{};n.inline=e;o=t._$merge({},c,o);o.rand=t._$uniqueID;o.format=t._$format;o.escape=t._$escape;o.inline=e;return TrimPath.merge(i,n,o)}}();s._$add=function(e,t){if(!e)return"";var n,o=i._$get(e);if(o){n=o.id;e=o.value||o.innerText;if(!t)i._$remove(o)}return TrimPath.parse(e,n)};s._$addTemplate=function(e,t){return TrimPath.parse(e,t)};s._$render=function(e,t,n,o){e=i._$get(e);if(e)e.innerHTML=s._$get(t,n,o)};s._$extend=function(e){t._$merge(c,e)};n._$merge({_$render:s._$render});if(!0){var d=e.P("nej.e");d._$addHtmlTemplate=s._$add;d._$getHtmlTemplate=s._$get;d._$getHtmlTemplateSeed=s._$seed;d._$renderHtmlTemplate=s._$render;d._$registJSTExt=s._$extend}return s},41,1,17,47,67);I$(60,function(e,t,i,n,o,s,_,a){var r;o._$$EventTarget=t._$klass();r=o._$$EventTarget.prototype;o._$$EventTarget._$allocate=function(e){e=e||{};var t=!!this.__pool&&this.__pool.shift();if(!t){t=new this(e);this.__inst__=(this.__inst__||0)+1}t.__reset(e);return t};o._$$EventTarget._$recycle=function(){var e=function(e,t,i){e._$recycle();i.splice(t,1)};return function(t){if(!t)return null;if(!n._$isArray(t)){if(!(t instanceof this)){var i=t.constructor;if(i._$recycle)i._$recycle(t);return null}if(t==this.__instance)delete this.__instance;if(t==this.__inctanse)delete this.__inctanse;t.__destroy();if(!this.__pool)this.__pool=[];if(n._$indexOf(this.__pool,t)<0)this.__pool.push(t);return null}n._$reverseEach(t,e,this)}}();o._$$EventTarget._$getInstance=function(e){if(!this.__instance)this.__instance=this._$allocate(e);return this.__instance};o._$$EventTarget._$getInstanceWithReset=function(e,t){if(t&&this.__inctanse){this.__inctanse._$recycle();delete this.__inctanse}if(!this.__inctanse)this.__inctanse=this._$allocate(e);else this.__inctanse.__reset(e);return this.__inctanse};r.__init=function(){this.__events={};this.__events_dom={};this.id=n._$uniqueID()};r.__reset=function(e){this._$batEvent(e)};r.__destroy=function(){this._$clearEvent();this.__doClearDomEvent()};r.__doInitDomEvent=function(){var e=function(e){if(e&&!(e.length<3)){this.__events_dom["de-"+n._$uniqueID()]=e;i._$addEvent.apply(i,e)}};return function(t){n._$forEach(t,e,this)}}();r.__doClearDomEvent=function(){var e=function(e,t,n){delete n[t];i._$delEvent.apply(i,e)};return function(){n._$loop(this.__events_dom,e)}}();r.__doClearComponent=function(e){e=e||_;n._$loop(this,function(t,i,n){if(t&&t._$recycle&&!e(t)){delete n[i];t._$recycle()}})};r._$recycle=function(){this.constructor._$recycle(this)};r._$hasEvent=function(e){var e=(e||"").toLowerCase(),t=this.__events[e];return!!t&&t!==_};r._$delEvent=function(e,t){var e=(e||"").toLowerCase(),i=this.__events[e];if(n._$isArray(i)){n._$reverseEach(i,function(e,i,n){if(e==t)n.splice(i,1)});if(!i.length)delete this.__events[e]}else if(i==t)delete this.__events[e]};r._$setEvent=function(e,t){if(e&&n._$isFunction(t))this.__events[e.toLowerCase()]=t};r._$batEvent=function(){var e=function(e,t){this._$setEvent(t,e)};return function(t){n._$loop(t,e,this)}}();r._$clearEvent=function(){var e=function(e,t){this._$clearEvent(t)};return function(t){var t=(t||"").toLowerCase();if(t)delete this.__events[t];else n._$loop(this.__events,e,this)}}();r._$addEvent=function(e,t){if(e&&n._$isFunction(t)){e=e.toLowerCase();var i=this.__events[e];if(i){if(!n._$isArray(i))this.__events[e]=[i];this.__events[e].push(t)}else this.__events[e]=t}};r._$dispatchEvent=function(e){var e=(e||"").toLowerCase(),t=this.__events[e];if(t){var i=a.slice.call(arguments,1);if(n._$isArray(t))n._$forEach(t,function(e){if(!1)e.apply(this,i);else try{e.apply(this,i)}catch(t){console.error(t.message);console.error(t.stack)}},this);else t.apply(this,i)}};if(!0){o._$$Event=o._$$EventTarget;e.copy(e.P("nej.ut"),o)}return o},41,15,16,1);I$(44,function(e,t,i,n,o,s,_,a,r,c){var d;_._$$CustomEvent=t._$klass();d=_._$$CustomEvent._$extend(s._$$EventTarget);d.__init=function(){this.__cache={};this.__super()};d.__reset=function(e){this.__super(e);this.__element=i._$get(e.element)||window;this.__doEventInit(e.event);this.__doEventAPIEnhance();this._$dispatchEvent("oninit")};d.__destroy=function(){var e=function(e,t,i){if(!o._$isArray(e))o._$safeDelete(this.__element,t);delete i[t]};return function(){this.__super();o._$loop(this.__cache,e,this);delete this.__element}}();d.__isDelegate=function(e,t){e=i._$get(e);return!(e!==this.__element||t&&!this.__cache["on"+t])};d.__doEventInit=function(e){if(!o._$isString(e)){if(o._$isArray(e))o._$forEach(e,this.__doEventInit,this)}else{var t="on"+e;if(!this.__cache[t])this.__cache[t]=this.__doEventDispatch._$bind(this,e);this.__doEventBind(e)}};d.__doEventBind=function(e){var t="on"+e,i=this.__element[t],n=this.__cache[t];if(i!=n){this.__doEventDelete(e);if(i&&i!=r)this.__doEventAdd(e,i);this.__element[t]=n}};d.__doEventAdd=function(e,t,i){var n=this.__cache[e];if(!n){n=[];this.__cache[e]=n}if(o._$isFunction(t))!i?n.push(t):n.unshift(t)};d.__doEventDelete=function(e,t){var i=this.__cache[e];if(i&&i.length)if(t)o._$reverseEach(i,function(e,i,n){if(t===e){n.splice(i,1);return!0}});else delete this.__cache[e]};d.__doEventDispatch=function(e,t){t=t||{noargs:!0};if(t==a)t={};t.type=e;this._$dispatchEvent("ondispatch",t);if(!t.stopped)o._$forEach(this.__cache[e],function(e){if(!1)e(t);else try{e(t);
}catch(i){console.error(i.message);console.error(i.stack)}})};d.__doEventAPIEnhance=function(){var t=function(e){var t=e.args,i=t[1].toLowerCase();if(this.__isDelegate(t[0],i)){e.stopped=!0;this.__doEventBind(i);this.__doEventAdd(i,t[2],t[3]);this._$dispatchEvent("oneventadd",{type:i,listener:t[2]})}};var i=function(e){var t=e.args,i=t[1].toLowerCase();if(this.__isDelegate(t[0],i)){e.stopped=!0;this.__doEventDelete(i,t[2])}};var s=function(e){var t=e.args,i=(t[1]||"").toLowerCase();if(this.__isDelegate(t[0])){if(i){this.__doEventDelete(i);return}o._$loop(this.__cache,function(e,t){if(o._$isArray(e))this.__doEventDelete(t)},this)}};var _=function(e){var t=e.args,i=t[1].toLowerCase();if(this.__isDelegate(t[0],i)){e.stopped=!0;t[0]["on"+i].apply(t[0],t.slice(2))}};return function(){if(!this.__enhanced){this.__enhanced=!0;n._$addEvent=n._$addEvent._$aop(t._$bind(this));n._$delEvent=n._$delEvent._$aop(i._$bind(this));n._$clearEvent=n._$clearEvent._$aop(s._$bind(this));n._$dispatchEvent=n._$dispatchEvent._$aop(_._$bind(this));if(!0)e.copy(e.P("nej.v"),n)}}}();if(!0)e.copy(e.P("nej.ut"),_);return _},41,15,17,16,1,60);I$(135,function(e,t,i,n,o,s,_,a,r,c){var d,l=6e4;_._$$LoaderAbstract=t._$klass();d=_._$$LoaderAbstract._$extend(s._$$EventTarget);d.__init=function(){this.__super();this.__qopt={onerror:this.__onQueueError._$bind(this),onload:this.__onQueueLoaded._$bind(this)};if(!this.constructor.__cache)this.constructor.__cache={loaded:{}}};d.__reset=function(e){this.__super(e);this.__version=e.version;this.__timeout=e.timeout;this.__qopt.version=this.__version;this.__qopt.timeout=this.__timeout};d.__delLoadData=function(e){delete this.constructor.__cache[e]};d.__getLoadData=function(e){return this.constructor.__cache[e]};d.__setLoadData=function(e,t){this.constructor.__cache[e]=t};d.__getRequest=r;d.__doClearRequest=function(e){n._$clearEvent(e)};d.__doRequest=function(e){e.src=this.__url;document.head.appendChild(e)};d.__doClear=function(){var e=this.__getLoadData(this.__url);if(e){window.clearTimeout(e.timer);this.__doClearRequest(e.request);delete e.bind;delete e.timer;delete e.request;this.__delLoadData(this.__url);this.__getLoadData("loaded")[this.__url]=!0}};d.__doCallback=function(e){var t=this.__getLoadData(this.__url);if(t){var i=t.bind;this.__doClear();if(i&&i.length>0){var n;for(;i.length;){n=i.shift();try{n._$dispatchEvent(e,arguments[1])}catch(o){if(!1)throw o;console.error(o.message);console.error(o.stack)}n._$recycle()}}}};d.__onError=function(e){this.__doCallback("onerror",e)};d.__onLoaded=function(){this.__doCallback("onload")};d.__doLoadQueue=function(e){this.constructor._$allocate(this.__qopt)._$load(e)};d.__onQueueCheck=function(e){var t=this.__getLoadData(this.__key);if(t){if(e)t.error++;t.loaded++;if(!(t.loaded<t.total)){this.__delLoadData(this.__key);this._$dispatchEvent(t.error>0?"onerror":"onload")}}};d.__onQueueError=function(e){this.__onQueueCheck(!0)};d.__onQueueLoaded=function(){this.__onQueueCheck()};d._$load=function(e){e=o._$absolute(e);if(e){this.__url=e;if(this.__version)this.__url+=(this.__url.indexOf("?")<0?"?":"&")+this.__version;if(!this.__getLoadData("loaded")[this.__url]){var t=this.__getLoadData(this.__url),s;if(t){t.bind.unshift(this);t.timer=window.clearTimeout(t.timer)}else{s=this.__getRequest();t={request:s,bind:[this]};this.__setLoadData(this.__url,t);n._$addEvent(s,"load",this.__onLoaded._$bind(this));n._$addEvent(s,"error",this.__onError._$bind(this,{code:i._$CODE_ERRSERV,message:"无法加载指定资源文件["+this.__url+"]！"}))}if(0!=this.__timeout)t.timer=window.setTimeout(this.__onError._$bind(this,{code:i._$CODE_TIMEOUT,message:"指定资源文件["+this.__url+"]载入超时！"}),this.__timeout||l);if(s)this.__doRequest(s);this._$dispatchEvent("onloading")}else{try{this._$dispatchEvent("onload")}catch(_){if(!1)throw _;console.error(_.message);console.error(_.stack)}this._$recycle()}}else this._$dispatchEvent("onerror",{code:i._$CODE_NOTASGN,message:"请指定要载入的资源地址！"})};d._$queue=function(e){if(e&&e.length){this.__key=o._$uniqueID();var t={error:0,loaded:0,total:e.length};this.__setLoadData(this.__key,t);o._$forEach(e,function(e,i){if(e)this.__doLoadQueue(e);else t.total--},this);this._$dispatchEvent("onloading")}else this._$dispatchEvent("onerror",{code:i._$CODE_NOTASGN,message:"请指定要载入的资源队列！"})};return _},41,15,68,16,1,60);I$(83,function(e,t,i,n,o,s){i._$cookie=function(){var e=new Date,i=+e,o=864e5;var s=function(e){var t=document.cookie,i="\\b"+e+"=",n=t.search(i);if(n<0)return"";n+=i.length-2;var o=t.indexOf(";",n);if(o<0)o=t.length;return t.substring(n,o)||""};return function(_,a){if(void 0===a)return s(_);if(t._$isString(a)){if(a){document.cookie=_+"="+a+";";return a}a={expires:-100}}a=a||n;var r=_+"="+(a.value||"")+";";delete a.value;if(void 0!==a.expires){e.setTime(i+a.expires*o);a.expires=e.toGMTString()}r+=t._$object2string(a,";");document.cookie=r}}();if(!0)e.copy(e.P("nej.j"),i);return i},41,1);!function(){var e=!0,t=null;!function(i){function n(i){if("bug-string-char-index"==i)return"a"!="a"[0];var n,s="json"==i;if(s||"json-stringify"==i||"json-parse"==i){if("json-stringify"==i||s){var _=c.stringify,r="function"==typeof _&&d;if(r){(n=function(){return 1}).toJSON=n;try{r="0"===_(0)&&"0"===_(new Number)&&'""'==_(new String)&&_(o)===a&&_(a)===a&&_()===a&&"1"===_(n)&&"[1]"==_([n])&&"[null]"==_([a])&&"null"==_(t)&&"[null,null,null]"==_([a,o,t])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==_({a:[n,e,!1,t,"\0\b\n\f\r\t"]})&&"1"===_(t,n)&&"[\n 1,\n 2\n]"==_([1,2],t,1)&&'"-271821-04-20T00:00:00.000Z"'==_(new Date((-864e13)))&&'"+275760-09-13T00:00:00.000Z"'==_(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==_(new Date((-621987552e5)))&&'"1969-12-31T23:59:59.999Z"'==_(new Date((-1)))}catch(l){r=!1}}if(!s)return r}if("json-parse"==i||s){i=c.parse;if("function"==typeof i)try{if(0===i("0")&&!i(!1)){n=i('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var u=5==n.a.length&&1===n.a[0];if(u){try{u=!i('"\t"')}catch(f){}if(u)try{u=1!==i("01")}catch(h){}}}}catch(m){u=!1}if(!s)return u}return r&&u}}var o={}.toString,s,_,a,r="function"==typeof define&&define.amd,c="object"==typeof exports&&exports;c||r?"object"==typeof JSON&&JSON?c?(c.stringify=JSON.stringify,c.parse=JSON.parse):c=JSON:r&&(c=i.JSON={}):c=i.JSON||(i.JSON={});var d=new Date((-0xc782b5b800cec));try{d=-109252==d.getUTCFullYear()&&0===d.getUTCMonth()&&1===d.getUTCDate()&&10==d.getUTCHours()&&37==d.getUTCMinutes()&&6==d.getUTCSeconds()&&708==d.getUTCMilliseconds()}catch(l){}if(!n("json")){var u=n("bug-string-char-index");if(!d)var f=Math.floor,h=[0,31,59,90,120,151,181,212,243,273,304,334],m=function(e,t){return h[t]+365*(e-1970)+f((e-1969+(t=+(t>1)))/4)-f((e-1901+t)/100)+f((e-1601+t)/400)};if(!(s={}.hasOwnProperty))s=function(e){var i={},n;if((i.__proto__=t,i.__proto__={toString:1},i).toString!=o)s=function(e){var i=this.__proto__,e=e in(this.__proto__=t,this);this.__proto__=i;return e};else{n=i.constructor;s=function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}}i=t;return s.call(this,e)};var p={"boolean":1,number:1,string:1,undefined:1};_=function(e,i){var n=0,_,a,r;(_=function(){this.valueOf=0}).prototype.valueOf=0;a=new _;for(r in a)s.call(a,r)&&n++;_=a=t;if(n)n=2==n?function(e,t){var i={},n="[object Function]"==o.call(e),_;for(_ in e)!(n&&"prototype"==_)&&!s.call(i,_)&&(i[_]=1)&&s.call(e,_)&&t(_)}:function(e,t){var i="[object Function]"==o.call(e),n,_;for(n in e)!(i&&"prototype"==n)&&s.call(e,n)&&!(_="constructor"===n)&&t(n);(_||s.call(e,n="constructor"))&&t(n)};else{a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];n=function(e,t){var i="[object Function]"==o.call(e),n,_;if(_=!i)if(_="function"!=typeof e.constructor){_=typeof e.hasOwnProperty;_="object"==_?!!e.hasOwnProperty:!p[_]}_=_?e.hasOwnProperty:s;for(n in e)!(i&&"prototype"==n)&&_.call(e,n)&&t(n);for(i=a.length;n=a[--i];_.call(e,n)&&t(n));}}n(e,i)};if(!n("json-stringify")){var $={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},g=function(e,t){return("000000"+(t||0)).slice(-e)},v=function(e){var t='"',i=0,n=e.length,o=n>10&&u,s;for(o&&(s=e.split(""));i<n;i++){var _=e.charCodeAt(i);switch(_){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=$[_];break;default:if(_<32){t+="\\u00"+g(2,_.toString(16));break}t+=o?s[i]:u?e.charAt(i):e[i]}}return t+'"'},y=function(i,n,r,c,d,l,u){var h=n[i],p,$,b,C,S,w,I,E,x;try{h=n[i]}catch(j){}if("object"==typeof h&&h){p=o.call(h);if("[object Date]"==p&&!s.call(h,"toJSON"))if(h>-1/0&&h<1/0){if(m){b=f(h/864e5);for(p=f(b/365.2425)+1970-1;m(p+1,0)<=b;p++);for($=f((b-m(p,0))/30.42);m(p,$+1)<=b;$++);b=1+b-m(p,$);C=(h%864e5+864e5)%864e5;S=f(C/36e5)%24;w=f(C/6e4)%60;I=f(C/1e3)%60;C%=1e3}else{p=h.getUTCFullYear();$=h.getUTCMonth();b=h.getUTCDate();S=h.getUTCHours();w=h.getUTCMinutes();I=h.getUTCSeconds();C=h.getUTCMilliseconds()}h=(p<=0||p>=1e4?(p<0?"-":"+")+g(6,p<0?-p:p):g(4,p))+"-"+g(2,$+1)+"-"+g(2,b)+"T"+g(2,S)+":"+g(2,w)+":"+g(2,I)+"."+g(3,C)+"Z"}else h=t;else if("function"==typeof h.toJSON&&("[object Number]"!=p&&"[object String]"!=p&&"[object Array]"!=p||s.call(h,"toJSON")))h=h.toJSON(i)}r&&(h=r.call(n,i,h));if(h===t)return"null";p=o.call(h);if("[object Boolean]"==p)return""+h;if("[object Number]"==p)return h>-1/0&&h<1/0?""+h:"null";if("[object String]"==p)return v(""+h);if("object"==typeof h){for(i=u.length;i--;)if(u[i]===h)throw TypeError();u.push(h);E=[];n=l;l+=d;if("[object Array]"==p){$=0;for(i=h.length;$<i;x||(x=e),$++){p=y($,h,r,c,d,l,u);E.push(p===a?"null":p)}i=x?d?"[\n"+l+E.join(",\n"+l)+"\n"+n+"]":"["+E.join(",")+"]":"[]"}else{_(c||h,function(t){var i=y(t,h,r,c,d,l,u);i!==a&&E.push(v(t)+":"+(d?" ":"")+i);x||(x=e)});i=x?d?"{\n"+l+E.join(",\n"+l)+"\n"+n+"}":"{"+E.join(",")+"}":"{}"}u.pop();return i}};c.stringify=function(e,t,i){var n,s,_;if("function"==typeof t||"object"==typeof t&&t)if("[object Function]"==o.call(t))s=t;else if("[object Array]"==o.call(t)){_={};for(var a=0,r=t.length,c;a<r;c=t[a++],("[object String]"==o.call(c)||"[object Number]"==o.call(c))&&(_[c]=1));
}if(i)if("[object Number]"==o.call(i)){if((i-=i%1)>0){n="";for(i>10&&(i=10);n.length<i;n+=" ");}}else"[object String]"==o.call(i)&&(n=i.length<=10?i:i.slice(0,10));return y("",(c={},c[""]=e,c),s,_,n,"",[])}}if(!n("json-parse")){var b=String.fromCharCode,C={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},S,w,I=function(){S=w=t;throw SyntaxError()},E=function(){for(var i=w,n=i.length,o,s,_,a,r;S<n;){r=i.charCodeAt(S);switch(r){case 9:case 10:case 13:case 32:S++;break;case 123:case 125:case 91:case 93:case 58:case 44:o=u?i.charAt(S):i[S];S++;return o;case 34:o="@";for(S++;S<n;){r=i.charCodeAt(S);if(r<32)I();else if(92==r){r=i.charCodeAt(++S);switch(r){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:o+=C[r];S++;break;case 117:s=++S;for(_=S+4;S<_;S++){r=i.charCodeAt(S);r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70||I()}o+=b("0x"+i.slice(s,S));break;default:I()}}else{if(34==r)break;r=i.charCodeAt(S);for(s=S;r>=32&&92!=r&&34!=r;)r=i.charCodeAt(++S);o+=i.slice(s,S)}}if(34==i.charCodeAt(S)){S++;return o}I();default:s=S;if(45==r){a=e;r=i.charCodeAt(++S)}if(r>=48&&r<=57){for(48==r&&(r=i.charCodeAt(S+1),r>=48&&r<=57)&&I();S<n&&(r=i.charCodeAt(S),r>=48&&r<=57);S++);if(46==i.charCodeAt(S)){for(_=++S;_<n&&(r=i.charCodeAt(_),r>=48&&r<=57);_++);_==S&&I();S=_}r=i.charCodeAt(S);if(101==r||69==r){r=i.charCodeAt(++S);(43==r||45==r)&&S++;for(_=S;_<n&&(r=i.charCodeAt(_),r>=48&&r<=57);_++);_==S&&I();S=_}return+i.slice(s,S)}a&&I();if("true"==i.slice(S,S+4)){S+=4;return e}if("false"==i.slice(S,S+5)){S+=5;return!1}if("null"==i.slice(S,S+4)){S+=4;return t}I()}}return"$"},x=function(t){var i,n;"$"==t&&I();if("string"==typeof t){if("@"==(u?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(i=[];;n||(n=e)){t=E();if("]"==t)break;if(n)if(","==t){t=E();"]"==t&&I()}else I();","==t&&I();i.push(x(t))}return i}if("{"==t){for(i={};;n||(n=e)){t=E();if("}"==t)break;if(n)if(","==t){t=E();"}"==t&&I()}else I();(","==t||"string"!=typeof t||"@"!=(u?t.charAt(0):t[0])||":"!=E())&&I();i[t.slice(1)]=x(E())}return i}I()}return t},j=function(e,t,i){i=k(e,t,i);i===a?delete e[t]:e[t]=i},k=function(e,t,i){var n=e[t],s;if("object"==typeof n&&n)if("[object Array]"==o.call(n))for(s=n.length;s--;)j(n,s,i);else _(n,function(e){j(n,e,i)});return i.call(e,t,n)};c.parse=function(e,i){var n,s;S=0;w=""+e;n=x(E());"$"!=E()&&I();S=w=t;return i&&"[object Function]"==o.call(i)?k((s={},s[""]=n,s),"",i):n}}}r&&define(function(){return c})}(this);return JSON}();I$(133,function(_m,_p,_o,_f,_r){if("trident"===_m._$KERNEL.engine&&"2.0"==_m._$KERNEL.release)I$(164,function(){JSON.parse=function(){var _isSafeJSON=function(e){return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(e.replace(/"(\\.|[^"\\])*"/g,""))};return JSON.parse._$aop(function(_event){var _str=_event.args[0]||"";if(_str.length>=5e5){_event.stopped=!0;_event.value=eval("("+_str+")")}})}()});return JSON},43);I$(82,function(){return JSON},133);I$(141,function(e,t,i,n,o,s,_,a,r,c,d,l){var u;r._$$ProxyAbstract=e._$klass();u=r._$$ProxyAbstract._$extend(s._$$EventTarget);u.__reset=function(e){this.__super(e);this.__request=t._$fetch({url:"",sync:!1,cookie:!1,type:"text",method:"GET",timeout:6e4},e);var i=n._$get("csrf");if(i.cookie&&i.param){var s=encodeURIComponent(i.param)+"="+encodeURIComponent(_._$cookie(i.cookie)||""),a=this.__request.url.indexOf("?")<0?"?":"&";this.__request.url+=a+s}this.__headers=e.headers||{};var r=this.__headers[o._$HEAD_CT];if(null==r)this.__headers[o._$HEAD_CT]=o._$HEAD_CT_FORM};u.__destroy=function(){this.__super();delete this.__rkey;delete this.__request;delete this.__headers};u.__onLoadRequest=function(e){var t=e.status;if(t!=-1)if(0==(""+t).indexOf("2"))this._$dispatchEvent("onload",i._$text2type(e.result,this.__request.type));else this._$dispatchEvent("onerror",{data:t,result:e.result,code:o._$CODE_ERRSERV,message:"服务器返回异常状态["+t+"]!"});else this._$dispatchEvent("onerror",{code:o._$CODE_TIMEOUT,message:"请求["+this.__request.url+"]超时！"})};u.__doSendRequest=d;u.__getResponseHeader=d;u._$send=function(e){var t=this.__request.url;if(t)try{this.__request.data=null==e?null:e;var i={request:this.__request,headers:this.__headers};try{this._$dispatchEvent("onbeforerequest",i)}catch(n){console.error(n.message);console.error(n.stack)}this.__doSendRequest(i)}catch(s){this._$dispatchEvent("onerror",{code:o._$CODE_ERRSERV,message:"请求["+t+"]失败:"+s.message+"！"})}else this._$dispatchEvent("onerror",{code:o._$CODE_NOTASGN,message:"没有输入请求地址！"})};u._$abort=d;u._$header=function(e){if(!t._$isArray(e))return this.__getResponseHeader(e)||"";var i={};t._$forEach(e,function(e){i[e]=this._$header(e)},this);return i};return r},15,1,17,107,68,60,83,82);I$(169,function(e,t,i,n){e.__getXMLHttpRequest=function(){return new XMLHttpRequest};return e});I$(142,function(e,t,i,n,o,s,_){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="2.0")I$(170,function(){t.__getXMLHttpRequest=function(){var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.5.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];return function(){var t=null;i._$forIn(e,function(e){try{t=new ActiveXObject(e);return!0}catch(i){}});return t}}()});return t},43,169,1);I$(94,function(e,t,i,n,o,s,_,a,r){var c;s._$$ProxyXHR=i._$klass();c=s._$$ProxyXHR._$extend(e._$$ProxyAbstract);c.__destroy=function(){this.__super();window.clearTimeout(this.__timer);delete this.__timer;try{this.__xhr.onreadystatechange=a;this.__xhr.abort()}catch(e){}delete this.__xhr};c.__doSendRequest=function(){var e=function(e,t){this.__xhr.setRequestHeader(t,e)};var i=function(e){var i=[];t._$reverseEach(e.getElementsByTagName("input"),function(e){if("file"==e.type)if(e.name){if(e.files.length>1){t._$forEach(e.files,function(t){i.push({name:e.name,file:t})});e.parentNode.removeChild(e)}}else e.parentNode.removeChild(e)});return i.length>0?i:null};return function(s){var _=s.request,a=s.headers;this.__xhr=o.__getXMLHttpRequest();if(a[n._$HEAD_CT]===n._$HEAD_CT_FILE){delete a[n._$HEAD_CT];this.__xhr.upload.onprogress=this.__onStateChange._$bind(this,1);if("FORM"===_.data.tagName){var r=i(_.data);_.data=new FormData(_.data);t._$forEach(r,function(e){var i=e.file;_.data.append(e.name||i.name||"file-"+t._$uniqueID(),i)})}}this.__xhr.onreadystatechange=this.__onStateChange._$bind(this,2);if(0!==_.timeout)this.__timer=window.setTimeout(this.__onStateChange._$bind(this,3),_.timeout);this.__xhr.open(_.method,_.url,!_.sync);t._$loop(a,e,this);if(this.__request.cookie&&"withCredentials"in this.__xhr)this.__xhr.withCredentials=!0;if(!(a[n._$HEAD_CT]!==n._$HEAD_CT_FORM||window.FormData&&_.data instanceof window.FormData))_.data=t._$object2string(_.data,"&");this.__xhr.send(_.data)}}();c.__onStateChange=function(e){switch(e){case 1:this._$dispatchEvent("onuploading",arguments[1]);break;case 2:if(4==this.__xhr.readyState)this.__onLoadRequest({status:this.__xhr.status,result:this.__xhr.responseText||""});break;case 3:this.__onLoadRequest({status:-1})}};c.__getResponseHeader=function(e){return!this.__xhr?"":this.__xhr.getResponseHeader(e)};c._$abort=function(){this.__onLoadRequest({status:0})};return s},141,1,15,68,142);I$(174,function(e,t,i,n,o){var s=this,_=e._$KERNEL.prefix.pro,a=e._$is("desktop")?80:e._$is("ios")?50:30;t.__requestAnimationFrame=function(){var t=e._$is("android")?null:s.requestAnimationFrame||s[_+"RequestAnimationFrame"];return function(){if(!t)t=function(e){return window.setTimeout(function(){try{e(+new Date)}catch(t){}},1e3/a)};return t.apply(this,arguments)}}();t.__cancelAnimationFrame=function(){var t=e._$is("android")?null:s.cancelAnimationFrame||s[_+"CancelAnimationFrame"];return function(){if(!t)t=function(e){window.clearTimeout(e)};return t.apply(this,arguments)}}();return t},43);I$(153,function(e,t){return e},174,43);I$(102,function(e,t,i,n,o,s){i.requestAnimationFrame=function(){t.__requestAnimationFrame.apply(null,arguments)};i.cancelAnimationFrame=function(){t.__cancelAnimationFrame.apply(null,arguments)};if(!0){if(!this.requestAnimationFrame)this.requestAnimationFrame=i.requestAnimationFrame;if(!this.cancelAnimationFrame)this.cancelAnimationFrame=i.cancelAnimationFrame}return i},43,153);I$(187,function(e,t,i,n,o){t.__canFlashEventBubble=function(e){return"transparent"!=(e||"").toLowerCase()};return t},43);I$(182,function(e,t,i,n,o,s){if("trident"===t._$KERNEL.engine)I$(188,function(){e.__canFlashEventBubble=function(e){return!0}});if("webkit"===t._$KERNEL.engine)I$(189,function(){e.__canFlashEventBubble=function(e){return!0}});return e},187,43);I$(183,'{var hide  = defined("hidden")&&!!hidden}\n{var param = defined("params")&&params||NEJ.O}\n{var width = !hide?width:"1px",height = !hide?height:"1px"}\n{if hide}<div style="position:absolute;top:0;left:0;width:1px;height:1px;z-index:10000;overflow:hidden;">{/if}\n<object classid = "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"\n        codebase = "http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"\n        width = "${width|default:"100px"}"\n        height = "${height|default:"100px"}" id="${id}">\n    <param value="${src}" name="movie">\n    {for x in param}\n    <param value="${x}" name="${x_key}"/>\n    {/for}\n    <embed src="${src}" name="${id}"\n           width="${width|default:"100px"}"\n           height="${height|default:"100px"}"\n           pluginspage="http://www.adobe.com/go/getflashplayer"\n           type="application/x-shockwave-flash"\n           {for x in param}${x_key}="${x}" {/for}></embed>\n</object>\n{if hide}</div>{/if}');I$(167,function(e,t,i,n,o,s,_,a,r,c,d,l){var u=o._$add(a);r._$flash=function(){var a={},r,c=/^(?:mouse.*|(?:dbl)?click)$/i;window.onflashevent=function(e){var t=decodeURIComponent(e.target),i=e.type.toLowerCase();var n=a[t+"-tgt"];if(n&&c.test(i))l(n,e);var o=a[t+"-on"+i];if(o){var s="";try{s=o(e)}catch(_){}return s}};var d=function(e){r=document.title;var i=t._$get(e.parent)||document.body,n=o._$get(u,e);i.insertAdjacentHTML(!e.hidden?"beforeEnd":"afterBegin",n)};var l=function(e,t){var n=t.type.toLowerCase();s.requestAnimationFrame(function(){
i._$dispatchEvent(e,n)})};var f=function(e){return!!e&&!!e.inited&&!!e.inited()};var h=function(e){var i=[document.embeds[e],t._$get(e),document[e],window[e]],o=n._$forIn(i,f),s=i[o],_=e+"-count";a[_]++;if(!(s||a[_]>100))window.setTimeout(h._$bind(null,e),300);else{if(r){document.title=r;r=null}a[e](s);delete a[e];delete a[_]}};var m=function(e){var i=e.id,o=e.params;if(!o){o={};e.params=o}var s=o.flashvars||"";s+=(!s?"":"&")+("id="+i);if(!e.hidden&&(e.target||_.__canFlashEventBubble(o.wmode))){var r=t._$id(e.target)||t._$id(e.parent);a[i+"-tgt"]=r}o.flashvars=s;n._$loop(e,function(e,t){if(n._$isFunction(e)&&"onready"!=t)a[i+"-"+t]=e})};return function(t){t=e.X({},t);if(t.src){var i="_"+n._$uniqueID();t.id=i;m(t);d(t);if(t.onready){a[i]=t.onready;a[i+"-count"]=0;h(i)}}}}();if(!0)e.copy(e.P("nej.e"),r);return r},41,17,16,1,18,102,182,183);I$(137,function(e,t,i,n,o,s,_,a,r){var c,d={},l=n._$uniqueID();this["ld"+l]=function(e,t){var i=d[e];if(i){delete d[e];i.__onLoadRequest({status:200,result:t})}};this["er"+l]=function(e,t){var i=d[e];if(i){delete d[e];i.__onLoadRequest({status:t||0})}};s._$$ProxyFlash=t._$klass();c=s._$$ProxyFlash._$extend(e._$$ProxyAbstract);c.__doSendRequest=function(e){var t=d.flash;if(!n._$isArray(t))if(t){this.__rkey=n._$uniqueID();d[this.__rkey]=this;var s=n._$fetch({url:"",data:null,method:"GET"},e.request);s.key=this.__rkey;s.headers=e.headers;s.onerror="cb.er"+l;s.onloaded="cb.ld"+l;var _=i._$getFlashProxy(s.url);if(_)s.policyURL=_;t.request(s)}else{d.flash=[this.__doSendRequest._$bind(this,e)];o._$flash({hidden:!0,src:i._$get("ajax.swf"),onready:function(e){if(e){var t=d.flash;d.flash=e;n._$reverseEach(t,function(e,t,i){try{e()}catch(n){}})}}})}else t.push(this.__doSendRequest._$bind(this,e))};c._$abort=function(){delete d[this.__rkey];this.__onLoadRequest({status:0})};return s},141,15,107,1,167);I$(190,function(e,t,i,n){e.__formatOrigin=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){t=t||"";if(e.test(t))return RegExp.$1;else return"*"}}();e.__formatPassData=function(e){return e};e.__postMessage=function(i,n){if(i.postMessage){n=n||t;i.postMessage(e.__formatPassData(n.data),e.__formatOrigin(n.origin))}};return e});I$(184,function(e,t,i,n,o,s,_,a){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release>="4.0"&&e._$KERNEL.release<="5.0")I$(191,function(){t.__formatPassData=function(e){return JSON.stringify(e)}});if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="3.0")I$(192,function(e){var o="MSG|",_=[];var a=function(){var e=unescape(window.name||"").trim();if(e&&0==e.indexOf(o)){window.name="";var s=i._$string2object(e.replace(o,""),"|"),_=(s.origin||"").toLowerCase();if(!_||"*"==_||0==location.href.toLowerCase().indexOf(_))n._$dispatchEvent(window,"message",{data:JSON.parse(s.data||"null"),source:window.frames[s.self]||s.self,origin:t.__formatOrigin(s.ref||document.referrer)})}};var r=function(){var e;var t=function(t,n,o){if(i._$indexOf(e,t.w)<0){e.push(t.w);o.splice(n,1);t.w.name=t.d}};return function(){e=[];i._$reverseEach(_,t);e=null}}();t.__postMessage=function(){var e=function(e){var t={};e=e||s;t.origin=e.origin||"";t.ref=location.href;t.self=e.source;t.data=JSON.stringify(e.data);return o+i._$object2string(t,"|",!0)};return function(t,i){_.unshift({w:t,d:escape(e(i))})}}();e._$$CustomEvent._$allocate({element:window,event:"message"});setInterval(r,100);setInterval(a,20)},44,82);return t},43,190,1,16);I$(168,function(e,t,i,n,o,s,_,a){o._$postMessage=function(){var e=window.name||"_parent",o={_top:window.top,_self:window,_parent:window.parent};return function(_,a){if(t._$isString(_)){_=o[_]||window.frames[_]||(i._$get(_)||s).contentWindow;if(!_)return}var r=t._$fetch({data:null,origin:"*",source:e},a);n.__postMessage(_,r)}}();if(!0)e.copy(e.P("nej.j"),o);return o},41,1,17,184);I$(138,function(e,t,i,n,o,s,_,a,r,c,d){var l,u={};a._$$ProxyFrame=i._$klass();l=a._$$ProxyFrame._$extend(e._$$ProxyAbstract);l.__init=function(){var e="NEJ-AJAX-DATA:",t=!1;var i=function(t){var i=t.data;if(0==i.indexOf(e)){i=JSON.parse(i.replace(e,""));var n=u[i.key];if(n){delete u[i.key];i.result=decodeURIComponent(i.result||"");n.__onLoadRequest(i)}}};var o=function(){if(!t){t=!0;n._$addEvent(window,"message",i)}};return function(){this.__super();o()}}();l.__doSendRequest=function(e){var i=e.request,a=o._$getFrameProxy(i.url),r=u[a];if(!t._$isArray(r))if(r){this.__rkey=t._$uniqueID();u[this.__rkey]=this;var c=t._$fetch({url:"",data:null,timeout:0,method:"GET"},i);c.key=this.__rkey;c.headers=e.headers;_._$postMessage(u[a],{data:c})}else{u[a]=[this.__doSendRequest._$bind(this,e)];s._$createXFrame({src:a,visible:!1,onload:function(e){var i=u[a];u[a]=n._$getElement(e).contentWindow;t._$reverseEach(i,function(e){try{e()}catch(t){}})}})}else r.push(this.__doSendRequest._$bind(this,e))};l._$abort=function(){delete u[this.__rkey];this.__onLoadRequest({status:0})};return a},141,1,15,16,107,17,168);I$(139,function(e,t,i,n,o,s,_,a,r,c,d,l){var u,f={},h="NEJ-UPLOAD-RESULT:";r._$$ProxyUpload=t._$klass();u=r._$$ProxyUpload._$extend(e._$$ProxyAbstract);u.__init=function(){var e=!1;var t=function(e){var t=e.data;if(0==t.indexOf(h)){t=JSON.parse(t.replace(h,""));var i=f[t.key];if(i){delete f[t.key];i.__onLoadRequest(decodeURIComponent(t.result))}}};var i=function(){if(!e){e=!0;n._$addEvent(window,"message",t)}};return function(){this.__super();i()}}();u.__destroy=function(){this.__super();o._$remove(this.__frame);delete this.__frame;window.clearTimeout(this.__timer);delete this.__timer};u.__onLoadRequest=function(e){try{var t=o._$text2type(e,this.__request.type);this._$dispatchEvent("onload",t)}catch(i){this._$dispatchEvent("onerror",{code:s._$CODE_ERREVAL,message:e})}};u.__doSendRequest=function(){var e=function(){var e,t;try{var e=this.__frame.contentWindow.document.body,t=(e.innerText||e.textContent||"").trim();if(t.indexOf(h)>=0||e.innerHTML.indexOf(h)>=0)return}catch(i){return}this.__onLoadRequest(t)};var t=function(e,i,n){_._$request(e,{type:"json",method:"POST",cookie:n,mode:parseInt(i)||0,onload:function(o){if(this.__timer){this._$dispatchEvent("onuploading",o);this.__timer=window.setTimeout(t._$bind(this,e,i,n),1e3)}}._$bind(this),onerror:function(o){if(this.__timer)this.__timer=window.setTimeout(t._$bind(this,e,i,n),1e3)}._$bind(this)})};return function(_){var a=_.request,r=_.headers,d=a.data,l=i._$uniqueID();f[l]=this;d.target=l;d.method="POST";d.enctype=s._$HEAD_CT_FILE;d.encoding=s._$HEAD_CT_FILE;var u=d.action||"",h=u.indexOf("?")<=0?"?":"&";d.action=u+h+"_proxy_=form";this.__frame=o._$createXFrame({name:l,onload:function(i){var o=n._$getElement(i);n._$addEvent(o,"load",e._$bind(this));d.submit();var s=(d.nej_query||c).value;if(s){var _=(d.nej_mode||c).value,a="true"===(d.nej_cookie||c).value;this.__timer=window.setTimeout(t._$bind(this,s,_,a),100)}}._$bind(this)})}}();u._$abort=function(){this._$dispatchEvent("onerror",{code:s._$CODE_ERRABRT,message:"客户端终止文件上传"})};return r},141,15,1,16,17,68,46,168);I$(140,function(e,t,i,n,o,s,_,a){o.__getProxyByMode=function(o,s,_){var a=s?{2:n._$$ProxyUpload}:{2:i._$$ProxyFrame,3:t._$$ProxyFlash};return(a[o]||e._$$ProxyXHR)._$allocate(_)};return o},94,137,138,139);I$(95,function(e,t,i,n,o,s){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="5.0")I$(143,function(){t.__getProxyByMode=function(){var e={0:2,1:3};return t.__getProxyByMode._$aop(function(t){var i=t.args,n=i[0]||0;i[0]=i[1]?2:e[n]||n})}()});return t},43,140);I$(46,function(e,t,i,n,o,s,_,a,r,c){var d={},l=r;_._$abort=function(e){var t=d[e];if(t)t.req._$abort()};_._$filter=function(e){l=e||r};_._$request=function(){var e=(location.protocol+"//"+location.host).toLowerCase();var n=function(t){var n=i._$url2origin(t);return!!n&&n!=e};var _=function(e){return(e||a)[t._$HEAD_CT]==t._$HEAD_CT_FILE};var c=function(e){var t=_(e.headers);if(!n(e.url)&&!t)return o._$$ProxyXHR._$allocate(e);else return s.__getProxyByMode(e.mode,t,e)};var u=function(e,t){var i={data:t};var n=e.result.headers;if(n)i.headers=e.req._$header(n);return i};var f=function(e){var t=d[e];if(t){if(t.req)t.req._$recycle();delete d[e]}};var h=function(e,t){var i=d[e];if(i){var n=arguments[2];if("onload"==t&&i.result)n=u(i,n);f(e);var o={type:t,result:n};l(o);if(!o.stopped)(i[t]||r)(o.result)}};var m=function(e,t){h(e,"onload",t)};var p=function(e,t){h(e,"onerror",t)};var $=function(e,t){var n=e.indexOf("?")<0?"?":"&",t=t||"";if(i._$isObject(t))t=i._$object2query(t);if(t)e+=n+t;return e};return function(e,t){t=t||{};var n=i._$uniqueID(),o={result:t.result,onload:t.onload||r,onerror:t.onerror||r};d[n]=o;t.onload=m._$bind(null,n);t.onerror=p._$bind(null,n);if(t.query)e=$(e,t.query);var s=t.method||"";if((!s||/get/i.test(s))&&t.data){e=$(e,t.data);t.data=null}t.url=e;o.req=c(t);o.req._$send(t.data);return n}}();_._$upload=function(e,o){e=n._$get(e);if(!e)return"";var s=i._$fetch({mode:0,type:"json",query:null,cookie:!1,headers:{},onload:null,onerror:null,onuploading:null,onbeforerequest:null},o);s.data=e;s.method="POST";s.timeout=0;s.headers[t._$HEAD_CT]=t._$HEAD_CT_FILE;return _._$request(e.action,s)};if(!0)e.copy(e.P("nej.j"),_);return _},41,68,1,17,94,95);I$(90,function(e,t,i,n,o,s,_,a){var r;o._$$LoaderText=t._$klass();r=o._$$LoaderText._$extend(e._$$LoaderAbstract);r.__getRequest=function(){return null};r.__doRequest=function(){n._$request(this.__url,{method:"GET",type:"text",onload:this.__onLoaded._$bind(this),onerror:this.__onError._$bind(this)})};r.__onLoaded=function(e){this.__doCallback("onload",{url:this.__url,content:e})};return o},135,15,17,46);I$(165,function(e,t,i,n,o){t.__removeIFrameKeepHistory=function(t){e._$remove(t)};return t},17);I$(136,function(e,t,i,n,o,s,_){if("trident"===i._$KERNEL.engine&&i._$KERNEL.release<="2.0")I$(166,function(){e.__removeIFrameKeepHistory=function(e){t._$setStyle(e,"display","none");try{e.contentWindow.document.body.innerHTML="&nbsp;"}catch(i){}}});return e},165,17,43);I$(91,function(e,t,i,n,o,s,_,a){var r;o._$$LoaderHtml=t._$klass();r=o._$$LoaderHtml._$extend(e._$$LoaderAbstract);r.__getRequest=function(){
var e=i._$create("iframe");e.width=0;e.height=0;e.style.display="none";return e};r.__doRequest=function(e){try{document.body.appendChild(e);e.src=this.__url}catch(t){console.log(e);console.error(t)}};r.__onError=function(e){var t=(this.__getLoadData(this.__url)||s).request;this.__doCallback("onerror",e);n.__removeIFrameKeepHistory(t)};r.__onLoaded=function(){var e=null,t=(this.__getLoadData(this.__url)||s).request;try{if(t.src!=this.__url)return;e=t.contentWindow.document.body}catch(i){}this.__doCallback("onload",e);n.__removeIFrameKeepHistory(t)};return o},135,15,17,136);I$(92,function(e,t,i,n,o,s,_){var a;n._$$LoaderStyle=t._$klass();a=n._$$LoaderStyle._$extend(e._$$LoaderAbstract);a.__getRequest=function(){return i._$create("link")};a.__doRequest=function(e){e.href=this.__url;document.head.appendChild(e)};return n},135,15,17);I$(93,function(e,t,i,n,o,s,_){var a;n._$$LoaderScript=t._$klass();a=n._$$LoaderScript._$extend(e._$$LoaderAbstract);a.__reset=function(e){this.__super(e);this.__async=e.async;this.__charset=e.charset;this.__qopt.async=!1;this.__qopt.charset=this.__charset};a.__getRequest=function(){var e=i._$create("script");if(null!=this.__async)e.async=!!this.__async;if(null!=this.__charset)e.charset=this.__charset;return e};a.__doClearRequest=function(e){i._$remove(e)};return n},135,15,17);I$(45,function(e,t,i,n,o,s,_,a,r){s._$loadScript=function(e,t){o._$$LoaderScript._$allocate(t)._$load(e)};s._$queueScript=function(e,t){o._$$LoaderScript._$allocate(t)._$queue(e)};s._$loadStyle=function(e,t){n._$$LoaderStyle._$allocate(t)._$load(e)};s._$queueStyle=function(e,t){n._$$LoaderStyle._$allocate(t)._$queue(e)};s._$loadHtml=function(e,t){i._$$LoaderHtml._$allocate(t)._$load(e)};s._$loadText=function(e,i){t._$$LoaderText._$allocate(i)._$load(e)};if(!0)e.copy(e.P("nej.j"),s);return s},41,90,91,92,93);I$(2,function(e,t,i,n,o,s,_,a,r,c,d,l,u,f){var h={},m="ntp-"+ +new Date+"-";d.tpl=function(){return h};d._$parseTemplate=function(){var e=0;var c=function(){if(!(e>0)){e=0;i._$dispatchEvent(document,"templateready");i._$clearEvent(document,"templateready")}};var u=function(e,i){var o=n._$dataset(e,"src");if(o){i=i||l;var s=i.root;if(!s)s=e.ownerDocument.location.href;else s=t._$absolute(s);o=o.split(",");t._$forEach(o,function(e,i,n){n[i]=t._$absolute(e,s)});return o}};var f=function(e){if(o._$is("mac")&&"safari"===o._$KERNEL.browser)return t._$unescape(e.innerHTML);else return e.value||e.innerText||""};var h=function(e,t){if(e){var i=u(e,t);if(i)a._$queueStyle(i,{version:n._$dataset(e,"version")});n._$addStyle(e.value)}};var m=function(t){e--;n._$addScript(t);c()};var p=function(t,i){if(t){var o=u(t,i),s=t.value;if(!o)n._$addScript(s);else{e++;var i={version:n._$dataset(t,"version"),onload:m._$bind(null,s)};window.setTimeout(a._$queueScript._$bind(a,o,i),0)}}};var $=function(t){e--;d._$parseTemplate(t);c()};var g=function(t,i){if(t){var o=u(t,i)[0];if(o){e++;var i={version:n._$dataset(t,"version"),onload:$};window.setTimeout(a._$loadHtml._$bind(a,o,i),0)}}};var v=function(t,i){e--;d._$addTextTemplate(t,i||"");c()};var y=function(t,i){if(t&&t.id){var o=t.id,s=u(t,i)[0];if(s){e++;var _=s+(s.indexOf("?")<0?"?":"&")+(n._$dataset(t,"version")||""),i={type:"text",method:"GET",onload:v._$bind(null,o)};window.setTimeout(r._$request._$bind(r,_,i),0)}}};var b=function(e,t){var i=e.name.toLowerCase();switch(i){case"jst":s._$addTemplate(f(e),e.id);return;case"txt":d._$addTextTemplate(e.id,f(e));return;case"ntp":d._$addNodeTemplate(f(e),e.id);return;case"js":p(e,t);return;case"css":h(e,t);return;case"html":g(e,t);return;case"res":y(e,t);return}};_._$$CustomEvent._$allocate({element:document,event:"templateready",oneventadd:c});return function(e,i){e=n._$get(e);if(e){var o="TEXTAREA"==e.tagName?[e]:t._$object2array(e.getElementsByTagName("textarea"));t._$forEach(o,function(e){b(e,i)});n._$remove(e,!0)}c()}}();d._$addTextTemplate=function(e,t){if(null!=h[e]&&typeof h[e]==typeof t){console.warn("text template overwrited with key "+e);console.debug("old template content: "+h[e].replace(/\n/g," "));console.debug("new template content: "+t.replace(/\n/g," "))}h[e]=t||""};d._$getTextTemplate=function(e){return h[e]||""};d._$addNodeTemplate=function(e,i){i=i||t._$uniqueID();e=n._$get(e)||e;d._$addTextTemplate(m+i,e);if(!t._$isString(e))n._$removeByEC(e);return i};d._$getNodeTemplate=function(e){if(!e)return null;e=m+e;var i=d._$getTextTemplate(e);if(!i)return null;var o;if(t._$isString(i)){i=n._$html2node(i);var s=i.getElementsByTagName("textarea");if(!("TEXTAREA"==i.tagName||s&&s.length))d._$addTextTemplate(e,i);else o=i}if(!o)o=i.cloneNode(!0);n._$removeByEC(o);return o};d._$getItemTemplate=function(){var e=function(e,t){return"offset"==t||"limit"==t};return function(i,n,o){var s=[];if(!i||!i.length||!n)return s;o=o||l;var _=i.length,a=parseInt(o.offset)||0,r=Math.min(_,a+(parseInt(o.limit)||_)),c={total:i.length,range:[a,r]};t._$merge(c,o,e);for(var d=a,u;d<r;d++){c.index=d;c.data=i[d];u=n._$allocate(c);var f=u._$getId();h[f]=u;u._$recycle=u._$recycle._$aop(function(e,t){delete h[e];delete t._$recycle}._$bind(null,f,u));s.push(u)}return s}}();d._$getItemById=function(e){return h[e]};d._$parseUITemplate=function(){var e=/#<(.+?)>/g;return function(i,o){o=o||{};i=(i||"").replace(e,function(e,i){var n=o[i];if(!n){n="tpl-"+t._$uniqueID();o[i]=n}return n});d._$parseTemplate(n._$html2node(i));return o}}();c._$merge({_$parseTemplate:d._$parseTemplate,_$addNodeTemplate:d._$addNodeTemplate});if(!0)e.copy(e.P("nej.e"),d);return d},41,1,16,17,43,18,44,45,46,47);I$(72,function(e,t,i,n,o,s,_,a,r,c){var d;_._$$Abstract=t._$klass();d=_._$$Abstract._$extend(o._$$EventTarget);d.__init=function(){this.__super();i._$dumpCSSText();this.__initXGui();this.__initNode()};d.__reset=function(e){this.__super(e);this.__doInitClass(e.clazz);this.__doInitDataset(e.dataset);this._$appendTo(e.parent)};d.__destroy=function(){this.__super();this.__doDelParentClass();this.__doDelParentDataset();delete this.__parent;i._$removeByEC(this.__body);i._$delClassName(this.__body,this.__class);delete this.__class};d.__initXGui=r;d.__initNode=function(){if(!this.__seed_html)this.__initNodeTemplate();this.__body=s._$getNodeTemplate(this.__seed_html);if(!this.__body)this.__body=i._$create("div",this.__seed_css);i._$addClassName(this.__body,this.__seed_css)};d.__initNodeTemplate=r;d.__doInitClass=function(e){this.__class=e||"";i._$addClassName(this.__body,this.__class)};d.__doInitDataset=function(e){this.__datamap=n._$merge({},e);i._$dataset(this.__body,this.__datamap)};d.__doDelParentDataset=function(){n._$forIn(this.__datamap,function(e,t){i._$dataset(this.__body,t,"")},this)};d.__doAddParentClass=function(){if(this.__seed_css){var e=this.__seed_css.split(/\s+/);i._$addClassName(this.__parent,e.pop()+"-parent")}};d.__doDelParentClass=function(){if(this.__seed_css){var e=this.__seed_css.split(/\s+/);i._$delClassName(this.__parent,e.pop()+"-parent")}};d._$getBody=function(){return this.__body};d._$appendTo=function(e){if(this.__body){this.__doDelParentClass();if(n._$isFunction(e))this.__parent=e(this.__body);else{this.__parent=i._$get(e);if(this.__parent)this.__parent.appendChild(this.__body)}this.__doAddParentClass()}};d._$show=function(){if(this.__parent&&this.__body&&this.__body.parentNode!=this.__parent)this.__parent.appendChild(this.__body)};d._$hide=function(){i._$removeByEC(this.__body)};if(!0)e.copy(e.P("nej.ui"),_);return _},41,15,17,1,60,2);I$(24,function(e,t,i,n,o,s,_){_=e._$klass();s=_._$extend(n._$$EventTarget);s.__init=function(e){this.__super(e)};s.__exist=function(e,t){for(var i=0;i<e.length;i++)if(e[i].id==t.idClient||e[i].id==t.msgIdClient)return!0;return!1};s._$isExistMessage=function(e,t){var i=c[e],n=window.ysfCache.message._$getListInCache("msg-session-"+i),o=!1;if(this.__exist(n,t))return!0;else return!1};s._$transform=function(e,t){if(t&&e){if(c[e])console.warn("why process twice this function, please check it",t,e);c[e]=t;c[t]=e}else console.error("bid and sessionid not exist when process it, please check it",t,e)};s._$getTransformCache=function(){return c};s._$getCurrentSessionId=function(){return this._$getSessionId(this.SHOPID)};s._$getSessionId=function(e){if(c[e])return c[e];else return-1};s._$getSessionById=function(e){try{var t=window.ysfCache.session,i=t._$getItemInCache(e);return i}catch(n){console.error("get session when process eventbus",n)}return null};s._$getSessionByBid=function(e){var t=window.ysfCache.session._$getListInCache("ses-online"),n=null;i._$forEach(t,function(t){if(t.shop){if(t.shop.id==e)n=t}else console.error("why session without shop",t)});return n};var a={};s._$setSessionQueue=function(e,t){if(e&&t)a[e]=t;else console.error("sid or timer not exist",e,t)};s._$getSessionTimerBySid=function(e){return a[e]};var r={};s._$setEntryQueue=function(e,t){if(e&&t)r[e]=t;else console.error("bid or param not exist",e,t)};s._$getEntryItemByBid=function(e){return r[e]};s._$replaceSessionByBid=function(e,t){var n=this._$getSessionByBid(e);if(n){t.lastMessage=n.lastMessage;delete n.groupname;delete n.isMock;t=i._$merge(n,t);window.ysfCache.session.__doSaveItemToCache(t);return t}else console.error("session not exist when emit sessionchange event",e,t)};s._$replaceSessionBySid=function(e,t){var n=this._$getSessionById(e);if(n){t=i._$merge(n,t);window.ysfCache.session.__doSaveItemToCache(t);return t}else console.error("session not exist when emit sessionchange event",e,t)};s._$initSaveUrlParam=function(e){d=i._$merge({},e);delete d.bid};s._$getInitUrlparam=function(){var e=[];for(var t in d)e.push(t+"="+d[t]);return e.join("&")};s._$getUnreadTotal=function(){var e=ysfCache.session._$getListInCache("ses-online");var t=0;i._$forEach(e,function(e){if(e.unread)t+=e.unread});return t};var c={};s.SHOPID=-1;s.YUNXIN_USER=null;var d={};window.ysfManage=_._$allocate();return window.ysfManage},15,16,1,60);I$(3,function(e,t,i,n,o){var s=8;var _=function(e,t){return e<<t|e>>>32-t};var a=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i;
};var r=function(e,t,i,n){if(e<20)return t&i|~t&n;if(e<40)return t^i^n;if(e<60)return t&i|t&n|i&n;else return t^i^n};var c=function(e){if(e<20)return 1518500249;if(e<40)return 1859775393;if(e<60)return-1894007588;else return-899497514};var d=function(){var e=function(e){return e%32},t=function(e){return 32-s-e%32};return function(i,n){var o=[],_=(1<<s)-1,a=n?e:t;for(var r=0,c=i.length*s;r<c;r+=s)o[r>>5]|=(i.charCodeAt(r/s)&_)<<a(r);return o}}();var l=function(){var e="0123456789abcdef",t=function(e){return e%4},i=function(e){return 3-e%4};return function(n,o){var s=[],_=o?t:i;for(var a=0,r=4*n.length;a<r;a++)s.push(e.charAt(n[a>>2]>>8*_(a)+4&15)+e.charAt(n[a>>2]>>8*_(a)&15));return s.join("")}}();var u=function(){var e=function(e){return e%32},t=function(e){return 32-s-e%32};return function(i,n){var o=[],_=(1<<s)-1,a=n?e:t;for(var r=0,c=32*i.length;r<c;r+=s)o.push(String.fromCharCode(i[r>>5]>>>a(r)&_));return o.join("")}}();var f=function(){var e="=",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(e){return e%4},n=function(e){return 3-e%4};return function(o,s){var _=[],a=s?i:n;for(var r=0,c;r<4*o.length;r+=3){c=(o[r>>2]>>8*a(r)&255)<<16|(o[r+1>>2]>>8*a(r+1)&255)<<8|o[r+2>>2]>>8*a(r+2)&255;for(var d=0;d<4;d++)_.push(8*r+6*d>32*o.length?e:t.charAt(c>>6*(3-d)&63))}return _.join("")}}();var h=function(e,t,i,n,o,s){return a(_(a(a(t,e),a(n,s)),o),i)};var m=function(e,t,i,n,o,s,_){return h(t&i|~t&n,e,t,o,s,_)};var p=function(e,t,i,n,o,s,_){return h(t&n|i&~n,e,t,o,s,_)};var $=function(e,t,i,n,o,s,_){return h(t^i^n,e,t,o,s,_)};var g=function(e,t,i,n,o,s,_){return h(i^(t|~n),e,t,o,s,_)};var v=function(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var i=1732584193,n=-271733879,o=-1732584194,s=271733878;for(var _=0,r=e.length,c,d,l,u;_<r;_+=16){c=i;d=n;l=o;u=s;i=m(i,n,o,s,e[_+0],7,-680876936);s=m(s,i,n,o,e[_+1],12,-389564586);o=m(o,s,i,n,e[_+2],17,606105819);n=m(n,o,s,i,e[_+3],22,-1044525330);i=m(i,n,o,s,e[_+4],7,-176418897);s=m(s,i,n,o,e[_+5],12,1200080426);o=m(o,s,i,n,e[_+6],17,-1473231341);n=m(n,o,s,i,e[_+7],22,-45705983);i=m(i,n,o,s,e[_+8],7,1770035416);s=m(s,i,n,o,e[_+9],12,-1958414417);o=m(o,s,i,n,e[_+10],17,-42063);n=m(n,o,s,i,e[_+11],22,-1990404162);i=m(i,n,o,s,e[_+12],7,1804603682);s=m(s,i,n,o,e[_+13],12,-40341101);o=m(o,s,i,n,e[_+14],17,-1502002290);n=m(n,o,s,i,e[_+15],22,1236535329);i=p(i,n,o,s,e[_+1],5,-165796510);s=p(s,i,n,o,e[_+6],9,-1069501632);o=p(o,s,i,n,e[_+11],14,643717713);n=p(n,o,s,i,e[_+0],20,-373897302);i=p(i,n,o,s,e[_+5],5,-701558691);s=p(s,i,n,o,e[_+10],9,38016083);o=p(o,s,i,n,e[_+15],14,-660478335);n=p(n,o,s,i,e[_+4],20,-405537848);i=p(i,n,o,s,e[_+9],5,568446438);s=p(s,i,n,o,e[_+14],9,-1019803690);o=p(o,s,i,n,e[_+3],14,-187363961);n=p(n,o,s,i,e[_+8],20,1163531501);i=p(i,n,o,s,e[_+13],5,-1444681467);s=p(s,i,n,o,e[_+2],9,-51403784);o=p(o,s,i,n,e[_+7],14,1735328473);n=p(n,o,s,i,e[_+12],20,-1926607734);i=$(i,n,o,s,e[_+5],4,-378558);s=$(s,i,n,o,e[_+8],11,-2022574463);o=$(o,s,i,n,e[_+11],16,1839030562);n=$(n,o,s,i,e[_+14],23,-35309556);i=$(i,n,o,s,e[_+1],4,-1530992060);s=$(s,i,n,o,e[_+4],11,1272893353);o=$(o,s,i,n,e[_+7],16,-155497632);n=$(n,o,s,i,e[_+10],23,-1094730640);i=$(i,n,o,s,e[_+13],4,681279174);s=$(s,i,n,o,e[_+0],11,-358537222);o=$(o,s,i,n,e[_+3],16,-722521979);n=$(n,o,s,i,e[_+6],23,76029189);i=$(i,n,o,s,e[_+9],4,-640364487);s=$(s,i,n,o,e[_+12],11,-421815835);o=$(o,s,i,n,e[_+15],16,530742520);n=$(n,o,s,i,e[_+2],23,-995338651);i=g(i,n,o,s,e[_+0],6,-198630844);s=g(s,i,n,o,e[_+7],10,1126891415);o=g(o,s,i,n,e[_+14],15,-1416354905);n=g(n,o,s,i,e[_+5],21,-57434055);i=g(i,n,o,s,e[_+12],6,1700485571);s=g(s,i,n,o,e[_+3],10,-1894986606);o=g(o,s,i,n,e[_+10],15,-1051523);n=g(n,o,s,i,e[_+1],21,-2054922799);i=g(i,n,o,s,e[_+8],6,1873313359);s=g(s,i,n,o,e[_+15],10,-30611744);o=g(o,s,i,n,e[_+6],15,-1560198380);n=g(n,o,s,i,e[_+13],21,1309151649);i=g(i,n,o,s,e[_+4],6,-145523070);s=g(s,i,n,o,e[_+11],10,-1120210379);o=g(o,s,i,n,e[_+2],15,718787259);n=g(n,o,s,i,e[_+9],21,-343485551);i=a(i,c);n=a(n,d);o=a(o,l);s=a(s,u)}return[i,n,o,s]};var y=function(e,t){var i=d(e,!0);if(i.length>16)i=v(i,e.length*s);var n=Array(16),o=Array(16);for(var _=0;_<16;_++){n[_]=909522486^i[_];o[_]=1549556828^i[_]}var a=v(n.concat(d(t,!0)),512+t.length*s);return v(o.concat(a),640)};var b=function(e,t){e[t>>5]|=128<<24-t%32;e[(t+64>>9<<4)+15]=t;var i=Array(80),n=1732584193,o=-271733879,s=-1732584194,d=271733878,l=-1009589776;for(var u=0,f=e.length,h,m,p,$,g;u<f;u+=16){h=n;m=o;p=s;$=d;g=l;for(var v=0;v<80;v++){i[v]=v<16?e[u+v]:_(i[v-3]^i[v-8]^i[v-14]^i[v-16],1);var y=a(a(_(n,5),r(v,o,s,d)),a(a(l,i[v]),c(v)));l=d;d=s;s=_(o,30);o=n;n=y}n=a(n,h);o=a(o,m);s=a(s,p);d=a(d,$);l=a(l,g)}return[n,o,s,d,l]};var C=function(e,t){var i=d(e);if(i.length>16)i=b(i,e.length*s);var n=Array(16),o=Array(16);for(var _=0;_<16;_++){n[_]=909522486^i[_];o[_]=1549556828^i[_]}var a=b(n.concat(d(t)),512+t.length*s);return b(o.concat(a),672)};t._$hmacsha12hex=function(e,t){return l(C(e,t))};t._$hmacsha12b64=function(e,t){return f(C(e,t))};t._$hmacsha12str=function(e,t){return u(C(e,t))};t._$hmacmd52hex=function(e,t){return l(y(e,t),!0)};t._$hmacmd52b64=function(e,t){return f(y(e,t),!0)};t._$hmacmd52str=function(e,t){return u(y(e,t),!0)};t._$sha12hex=function(e){return l(b(d(e),e.length*s))};t._$sha12b64=function(e){return f(b(d(e),e.length*s))};t._$sha12str=function(e){return u(b(d(e),e.length*s))};t._$md52hex=function(e){return l(v(d(e,!0),e.length*s),!0)};t._$md52b64=function(e){return f(v(d(e,!0),e.length*s),!0)};t._$md52str=function(e){return u(v(d(e,!0),e.length*s),!0)};t._$str2hex=function(e,t){return l(d(e,!t),!t)};if(!0)e.copy(e.P("nej.u"),t);return t},41);I$(29,function(e,t){var i=e._$uniqueID(),n=new RegExp("\\["+i+"\\](.+?)\\[\\/"+i+"\\]","gi"),o=new RegExp("((?:(http|https|rtsp):\\/\\/(?:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,64}(?:\\:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,25})?\\@)?)?(?:(([a-zA-Z0-9]([a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9]){0,1}\\.)+[a-zA-Z]{2,63}|((25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9]))))(?:\\:\\d{1,5})?)(\\/(?:(?:[a-zA-Z0-9¡-퟿豈-﷏ﷰ-￯\\;\\/\\?\\:\\@\\&\\=\\#\\~\\-\\.\\+\\!\\*\\'\\(\\)\\,\\_])|(?:\\%[a-fA-F0-9]{2}))*)?(?:\\b|$)","gi");t._$encode=function(e){return(e||"").replace(o,function(e){return"["+i+"]"+e+"[/"+i+"]"})};t._$decode=function(e){RegExp.lastIndex=-1;return(e||"").replace(n,function(e,t){var i=t||"";if(i.indexOf("://")<0)i="http://"+i;return'<a target="_blank" href="'+i+'">'+t+"</a>"})};t._$complete=function(i){return t._$decode(e._$escape(t._$encode(i)))}},1);I$(80,function(e,t,i){i._$parse=function(t){var n=[],o=JSON.parse(t.answer_list||"null")||[],s=t.answer_label;if(s||o.length>1)n.push({list:o,type:"qa-list",origin:t.question,label:t.answer_label||""});else if(1==o.length)n.push({type:"rich",content:(o[0]||{}).answer||""});if(1==t.operator_hint){var _=e._$uniqueID(),a=e._$uniqueID();n.push({id:_,msgIdClient:a,type:"action",action:"kefu",content:i._$action(_,t.operator_hint_desc||"")})}return n};i._$action=function(){var i=e._$uniqueID(),n=new RegExp("\\["+i+"(.+?)"+i+"\\]","gi"),o=/<a\s+href\s*=\s*('|")qiyu:\/\/action.qiyukf.com\?command=(.+?)\1\s*>(.+?)<\/a>/gi,s={applyHumanStaff:"kefu"};return function(_,a){var r={};a=(a||"").replace(o,function(t,n,o,a){var c=s[o];if(!c)return t;var d=e._$uniqueID();r[d]='<a href="#" data-id="'+_+'" data-name="'+c+'">'+a+"</a>";return"["+i+d+i+"]"});a=t._$complete(a);return a.replace(n,function(e,t){return r[t]||e})}}()},1,29);I$(193,function(e,t,i,n){e.__getItemInStorage=function(e){return localStorage.getItem(e)};e.__setItemToStorage=function(e,t){localStorage.setItem(e,t)};e.__removeItemFromStorage=function(e){localStorage.removeItem(e)};e.__clearStorage=function(){localStorage.clear()};e.__initStorage=function(){(document.onstorageready||i)()};e.__isStorageReady=function(){return!0};return e});I$(186,function(e,t,i,n,o,s,_){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="3.0")I$(194,function(e,n){var o;var s=function(){if(!o)n._$flash({hidden:!0,src:e._$get("storage.swf"),params:{AllowScriptAccess:"sameDomain"},onready:function(e){if(!e)console.log("flash for localStorage unavailable");else{o=e;o.initStorage("nej-storage")}t._$dispatchEvent(document,"storageready")}})};i.__getItemInStorage=function(e){if(o)return o.getItem(e)};i.__setItemToStorage=function(e,t){if(o)o.setItem(e,t)};i.__removeItemFromStorage=function(e){if(o)o.removeItem(e)};i.__clearStorage=function(){if(o)o.clear()};i.__initStorage=function(){s()};i.__isStorageReady=function(){return!!o}},107,167);return i},43,16,193);I$(179,function(e,t,i,n,o,s,_,a,r){var c={};s._$setDataInStorage=function(e,t){var i=JSON.stringify(t);try{o.__setItemToStorage(e,i)}catch(n){console.error(n.message);console.error(n)}if(i!=o.__getItemInStorage(e))c[e]=t};s._$getDataInStorage=function(e){var t=JSON.parse(o.__getItemInStorage(e)||"null");return null==t?c[e]:t};s._$getDataInStorageWithDefault=function(e,t){var i=s._$getDataInStorage(e);if(null==i){i=t;s._$setDataInStorage(e,i)}return i};s._$delDataInStorage=function(e){delete c[e];o.__removeItemFromStorage(e)};s._$clearDataInStorage=function(){var e=function(e,t,i){delete i[t]};return function(){t._$loop(c,e);o.__clearStorage()}}();n._$$CustomEvent._$allocate({element:document,event:"storageready",oneventadd:function(){if(o.__isStorageReady())i._$dispatchEvent(document,"storageready")}});var d=function(){var e=function(e,t,i){o.__setItemToStorage(t,JSON.stringify(e));delete i[t]};return function(){t._$loop(c,e)}}();i._$addEvent(document,"storageready",d);o.__initStorage();if(!0)e.copy(e.P("nej.j"),s);return s},41,1,16,44,186);I$(157,function(e,t,i,n,o,s,_,a,r){var c,d="dat-"+ +new Date;s._$$CacheAbstract=t._$klass();c=s._$$CacheAbstract._$extend(n._$$EventTarget);c.__init=function(){this.__super();
this.__cache=this.constructor[d];if(!this.__cache){this.__cache={};this.__cache[d+"-l"]={};this.constructor[d]=this.__cache}};c.__getDataInCache=function(e){return this.__cache[e]};c.__setDataInCache=function(e,t){this.__cache[e]=t};c.__getDataInCacheWithDefault=function(e,t){var i=this.__getDataInCache(e);if(null==i){i=t;this.__setDataInCache(e,i)}return i};c.__delDataInCache=function(e){if(null==e)i._$loop(this.__cache,function(e,t){if(t!=d+"-l")this.__delDataInCache(t)},this);else delete this.__cache[e]};c.__delDataInStorage=function(e){return o._$delDataInStorage(e)};c.__getDataInStorage=function(e){return o._$getDataInStorage(e)};c.__setDataInStorage=function(e,t){o._$setDataInStorage(e,t)};c.__getDataLocalWithDefault=function(e,t){var i=this.__getDataLocal(e);if(null==i){i=t;this.__setDataLocal(e,i)}return i};c.__getDataLocal=function(e){var t=this.__getDataInCache(e);if(null!=t)return t;t=this.__getDataInStorage(e);if(null!=t)this.__setDataInCache(e,t);return t};c.__setDataLocal=function(e,t){this.__setDataInStorage(e,t);this.__setDataInCache(e,t)};c.__delDataLocal=function(e){if(null==e)i._$loop(this.__cache,function(e,t){if(t!=d+"-l")this.__delDataLocal(t)},this);else{delete this.__cache[e];o._$delDataInStorage(e)}};c._$clearDataLocal=function(){this.__delDataLocal()};c.__doCallbackRequest=function(e){var t=this.__cache[d+"-l"],n=r.slice.call(arguments,1);i._$forEach(t[e],function(e){try{e.apply(this,n)}catch(t){if(!1)throw t;console.error(t.message);console.error(t.stack)}});delete t[e]};c.__doQueueRequest=function(e,t){t=t||a;var i=this.__cache[d+"-l"][e];if(!i){i=[t];this.__cache[d+"-l"][e]=i;return!1}i.push(t);return!0};c.__doClearReqQueue=function(e){delete this.__cache[d+"-l"][e]};c.__hasFragment=function(e,t,i){if(!e)return!1;t=parseInt(t)||0;i=parseInt(i)||0;if(!i){if(!e.loaded)return!1;i=e.length}if(e.loaded)i=Math.min(i,e.length-t);for(var n=0;n<i;n++)if(!e[t+n])return!1;return!0};c._$isFragmentFilled=function(e,t,i){return this.__hasFragment(this._$getListInCache(e),t,i)};if(!0)e.P("nej.ut")._$$Cache=s._$$CacheAbstract;return s},41,15,1,60,179);I$(124,function(e,t,i,n,o,s,_,a){var r;o._$$CacheList=t._$klass();r=o._$$CacheList._$extend(n._$$CacheAbstract);r.__reset=function(e){this.__super(e);this.__key=e.key||"id";this.__data=e.data||s;this.__auto=!!e.autogc;this.__doSwapCache(e.id)};r.__destroy=function(){this.__super();if(this.__timer)this.__doGCAction()};r.__doSwapCache=function(e){var t;if(e){t=this.__cache[e];if(!t){t={};this.__cache[e]=t}}t=t||this.__cache;t.hash=t.hash||{};this.__lspl=t};r.__doGCAction=function(){this.__timer=window.clearTimeout(this.__timer);var e={};i._$loop(this.__lspl,function(t,n){if("hash"!=n)if(i._$isArray(t))i._$forEach(t,function(t){if(t)e[t[this.__key]]=!0},this)},this);i._$loop(this.__getHash(),function(t,i,n){if(!e[i])delete n[i]})};r.__doGCSchedule=function(){if(this.__timer)this.__timer=window.clearTimeout(this.__timer);this.__timer=window.setTimeout(this.__doGCAction._$bind(this),150)};r.__doSaveItemToCache=function(e,t){if(!i._$isArray(e)){e=this.__doFormatItem(e,t)||e;if(!e)return null;var n=e[this.__key];if(null!=n){var o=this.__getHash()[n];if(o)e=i._$merge(o,e);this.__getHash()[n]=e}delete e.__dirty__;return e}var s=[];i._$forEach(e,function(e){s.push(this.__doSaveItemToCache(e,t))},this);return s};r.__doRemoveItemFromList=function(e,t){var n=null,o=this.__key;if(!i._$isArray(t)){var n=null,o=this.__key;t=t[o]||t;var s=this._$getListInCache(e),_=i._$indexOf(s,function(e){return!!e&&e[o]==t});if(_>=0){n=s[_];s.splice(_,1)}return n}var n=[];i._$reverseEach(t,function(t){n.unshift(this.__doRemoveItemFromList(e,t))},this);return n};r.__doFormatItem=_;r.__doUnshiftToList=function(e,t){if(t)if(i._$isArray(t))i._$reverseEach(t,function(t){this.__doUnshiftToList(e,t)});else{var n=this._$getListInCache(e),t=this.__doSaveItemToCache(t,e);if(t)n.unshift(t)}};r._$setTotal=function(e,t){var i=this._$getListInCache(e);i.length=Math.max(i.length,t);this._$setLoaded(e)};r._$getTotal=function(e){return this._$getListInCache(e).length};r._$setLoaded=function(e,t){this._$getListInCache(e).loaded=t!==!1};r._$isLoaded=function(e){return!!this._$getListInCache(e).loaded};r._$setListInCache=function(e,t){this._$clearListInCache(e);this.__getList({key:e,offset:0,limit:t.length+1},{list:t,total:t.length})};r._$getListInCache=function(){var e=function(e){return(e||"")+(!e?"":"-")+"list"};return function(t){var t=e(t),i=this.__lspl[t];if(!i){i=[];this.__lspl[t]=i}return i}}();r.__getHash=function(){var e=this.__lspl.hash;if(!e){e={};this.__lspl.hash=e}return e};r._$pullRefresh=function(){var e=function(e){return"r-"+e.key};return function(t){var n=i._$merge({},t),o=e(n),s=this._$dispatchEvent._$bind(this);if(!this.__doQueueRequest(o,s)){n.rkey=o;n.onload=this.__pullRefresh._$bind(this,n);this._$dispatchEvent("dopullrefresh",n)}}}();r.__pullRefresh=function(e,t){var i=e.key,n=parseInt(t.total),o=t.list||t.result;this.__doUnshiftToList(i,o||t);if(!isNaN(n)&&o){this._$getListInCache(i).length=n;this._$setLoaded(i)}this.__doCallbackRequest(e.rkey,"onpullrefresh",e)};r._$getList=function(){var e=function(e){return"r-"+e.key+"-"+e.offset+"-"+e.limit};return function(t){t=t||s;var i={key:""+t.key||"",ext:t.ext||null,data:t.data||null,offset:parseInt(t.offset)||0,limit:parseInt(t.limit)||0},n=this._$getListInCache(i.key),o=this.__hasFragment(n,i.offset,i.limit);if(!o){var _=e(i),a=this._$dispatchEvent._$bind(this);if(!this.__doQueueRequest(_,a)){i.rkey=_;i.onload=this.__getList._$bind(this,i);this._$dispatchEvent("doloadlist",i)}}else this._$dispatchEvent("onlistload",i)}}();r.__getList=function(){var e=function(e,t,i){if(e)return!0;i.splice(t,1)};return function(t,n){t=t||s;if(n){var o=t.key,_=t.offset,a=this._$getListInCache(o);var r=n||[];if(!i._$isArray(r)){r=n.result||n.list||[];var c=parseInt(n.total);if(!isNaN(c)||c>r.length)this._$setTotal(o,c)}i._$forEach(r,function(e,t){a[_+t]=this.__doSaveItemToCache(e,o)},this);if(r.length<t.limit){this._$setLoaded(o);i._$reverseEach(a,e)}this.__doCallbackRequest(t.rkey,"onlistload",t)}else this.__doCallbackRequest(t.rkey,"onlistload",t)}}();r._$clearListInCache=function(){var e=function(e,t,i){i.splice(t,1)};return function(t){if(t){var n=this._$getListInCache(t);i._$reverseEach(n,e);this._$setLoaded(t,!1);if(this.__auto)this.__doGCSchedule()}else i._$loop(this.__lspl,function(e,t){if("hash"!=t&&i._$isArray(e)){t=t.substr(0,t.length-5);this._$clearListInCache(t)}},this)}}();r.__doCheckItemValidity=function(e,t){return!e.__dirty__};r._$getItemInCache=function(e){return this.__getHash()[e]};r._$clearItemInCache=function(e){var t=this._$getItemInCache(e);if(t)t.__dirty__=!0};r._$getItem=function(){var e=function(e){return"r-"+e.key+"-"+e.id};return function(t){t=t||s;var i=t[this.__key],n={id:i,ext:t.ext,data:t.data||{},key:""+t.key||""};_item=this._$getItemInCache(i);n.data[this.__key]=i;if(!_item||!this.__doCheckItemValidity(_item,n.key)){var o=e(n),_=this._$dispatchEvent._$bind(this);if(!this.__doQueueRequest(o,_)){n.rkey=o;n.onload=this.__getItem._$bind(this,n);this._$dispatchEvent("doloaditem",n)}}else this._$dispatchEvent("onitemload",n)}}();r.__getItem=function(e,t){e=e||s;this.__doSaveItemToCache(t,e.key);this.__doCallbackRequest(e.rkey,"onitemload",e)};r._$addItem=function(e){e=i._$merge({},e);e.onload=this.__addItem._$bind(this,e);this._$dispatchEvent("doadditem",e)};r.__addItem=function(e,t){var i=e.key;t=this.__doSaveItemToCache(t,i);if(t){var n=0,o=this._$getListInCache(i);if(!e.push){n=-1;var s=e.offset||0;o.splice(s,0,t)}else if(o.loaded){n=1;o.push(t)}else o.length++}var _={key:i,flag:n,data:t,action:"add",ext:e.ext};this._$dispatchEvent("onitemadd",_);return _};r._$deleteItem=function(e){e=i._$merge({},e);e.onload=this.__deleteItem._$bind(this,e);this._$dispatchEvent("dodeleteitem",e)};r.__deleteItem=function(e,t){var i,n=e.key;if(t){var o=e.id;i=this._$getItemInCache(o)||null;this.__doRemoveItemFromList(n,o)}var s={key:n,data:i,action:"delete",ext:e.ext};this._$dispatchEvent("onitemdelete",s);return s};r._$updateItem=function(e){e=i._$merge({},e);e.onload=this.__updateItem._$bind(this,e);this._$dispatchEvent("doupdateitem",e)};r.__updateItem=function(e,t){var i=e.key;if(t)t=this.__doSaveItemToCache(t,i);var n={key:i,data:t,action:"update",ext:e.ext};this._$dispatchEvent("onitemupdate",n);return n};if(!0)e.P("nej.ut")._$$ListCache=o._$$CacheList;return o},41,15,1,157);I$(132,function(e,t,i,n,o,s,_){var a;n._$$CacheListAbstract=t._$klass();a=n._$$CacheListAbstract._$extend(i._$$CacheList);a.__reset=function(e){this.__super(e);this._$batEvent({doloadlist:this.__doLoadList._$bind(this),doloaditem:this.__doLoadItem._$bind(this),doadditem:this.__doAddItem._$bind(this),dodeleteitem:this.__doDeleteItem._$bind(this),doupdateitem:this.__doUpdateItem._$bind(this),dopullrefresh:this.__doPullRefresh._$bind(this)})};a.__doLoadList=s;a.__doPullRefresh=s;a.__doLoadItem=s;a.__doAddItem=s;a.__doDeleteItem=s;a.__doUpdateItem=s;if(!0)e.P("nej.ut")._$$AbstractListCache=n._$$CacheListAbstract;return n},41,15,124);I$(81,function(e,t,i,n,o,s){var _={};o._$$Cache=e._$klass();s=o._$$Cache._$extend(n._$$CacheListAbstract);s.__doSendRequest=function(e,n){var o=_[e];if(o){if(t._$isFunction(o.filter))o.filter.call(this,n);var s=function(e){var i=!1,s=n.onerror||o.onerror||"onerror";if(t._$isFunction(s))i=s.call(this,e,n);if(!i&&t._$isString(s))this._$dispatchEvent(s,e,n)};var a=function(e){if(e&&0===(""+e.code).indexOf("2")){if(t._$isFunction(o.format))o.format.call(this,e,n);var i=n.onload||o.onload;if(t._$isFunction(i))i.call(this,e.result);else if(t._$isString(i))this._$dispatchEvent(i,e.result);if(t._$isFunction(o.finaly))o.finaly.call(this,n,e.result)}else s.call(this,e)};var r=t._$merge({},n,{cookie:!0,type:"json",method:o.method||"POST",onload:a._$bind(this),onerror:s._$bind(this)});if(o.domain)o.__url=o.domain+o.url;i._$request(o.__url||o.url,r)}else console.error("not found request config for "+e)};s._$hasItem=function(e){return!!this._$getItemInCache(e);
};o._$config=function(e){t._$forIn(e,function(e,t){if("string"==typeof e)e={url:e};_[t]=e})};o._$do=function(e,i){if(t._$isFunction(i)){var n=e._$allocate(),o=i.call(null,n);n._$recycle();return o}}},15,1,46,132);I$(27,function(e,t,i,n,o,s,_,a,r,c,d,l){l=e._$klass();d=l._$extend(r._$$Cache);var u=-1;var h=3e3;r._$config({"user-add":{url:"/webapi/user/create.action",format:function(e){var t=e.info;e.result={token:t.token,account:t.accid,exchange:t.exchange,bid:t.bid}},onerror:function(e,t){if(4001==e.code)this._$dispatchEvent("onusererror");else this.__cbCreateYXUser(t.data.appkey,null);return!0}}});d.__init=function(e){this.__nopt={debug:window.MIN_DEBUG_MODE,syncTeams:!1,syncFriends:!1,syncRoamingMsgs:!1,syncTeamMembers:!1,syncFilter:!0,onmsg:this.__cbReceiveMessage._$bind(this),onofflinemsgs:function(e){e.sort(function(e,t){return e.time-t.time?1:-1});i._$forEach(e,function(e){this.__cbReceiveMessage(e,!0)},this)}._$bind(this),onerror:this.__onConnectError._$bind(this),onconnect:this.__cbConnect2Yunxin._$bind(this),ondisconnect:this.__onDisConnect._$bind(this),oncustomsysmsg:this.__onReceiveInstr._$bind(this)};this.__super(e)};d.__sendMessageBody=function(e){var t={cc:!0,filter:!0,scene:"p2p",to:u,content:"",done:function(e,t){if(e)console.error("send message is error",e)}};return e?i._$merge(t,{to:e}):t};d.__receiveMessageBody=function(e){var t=e.idClient.split("#")[0];if(!t){console.error("msg idClient without #",e.idClient,e);return e}return i._$merge(e,{id:e.idClient,sessionid:t,from:this.__getSessionKefuInfo(t).kefu,_type:e.type})};d.__onConnectError=function(){var e={302:function(){this._$dispatchEvent("onusererror")}};return function(t){var n=e[t.code];if(i._$isFunction(n))n.call(this);else if(i._$isString(n))e[n].call(this)}}();d.__doCreateYXUser=function(e){this.__doSendRequest("user-add",{data:{deviceid:this.__getDeviceID(),appkey:e},onload:this.__cbCreateYXUser._$bind(this,e)})};d.__cbCreateYXUser=function(e,t){if(t){if(!setting.bid)setting.bid=t.bid;this.__saveYunxinUser(t);t.appKey=e;this.__setDataInCache("corp-appkey",e);this._$dispatchEvent("lifecyclecreated");t=i._$merge({},t,this.__nopt);window.nim=this.__nim=new NIM(t)}else window.setTimeout(this.__doCreateYXUser._$bind(this,e),h)};d.__onDisConnect=function(e){if("kicked"==e.code)this._$dispatchEvent("onkickout");else this._$dispatchEvent("ondisconnect")};d.__cbConnect2Yunxin=function(e){var t=this.__getCurrentShopID(),i=1e3;this._$dispatchEvent("lifecycleconnected",{bid:t});this.__applyKefu(t,e);setInterval(function(){this._$reportUserInfo(t)}._$bind(this),i)};d.__applyKefu=function(e,t){var n={setDataInfo:function(e,t){i._$merge(e,{ip:e.ip||t.ip||""});i._$merge(t,{staffid:setting.staffid||0,groupid:setting.groupid||0,qtype:setting.qtype||0,robotShuntSwitch:setting.robotShuntSwitch||0})},resetSessionStatus:function(e,t){var i=a._$getSessionByBid(e);if(i)i.sessionStatus.status=t}};var o=e,s=this.__getDataInCache("yunxin-user"),_={};n.setDataInfo(s,t);this.__handleEntryInfo(e,t);n.resetSessionStatus(e,-1);this.__nim.sendCustomSysMsg({to:o,cc:!0,filter:!0,scene:"p2p",content:JSON.stringify({cmd:1,deviceid:this.__getDeviceID(),exchange:o,foreignid:s.fid||"",fromTitle:_.title||"未知页面名称",fromPage:document.referrer||_.referrer,fromType:"WEB",fromIp:s.ip,fromSubType:[navigator.platform||"",navigator.userAgent||""].join(" - "),version:"7",stafftype:t.type||0,staffid:t.staffid||0,groupid:t.groupid||0,entryid:t.entryid||0}),done:function(e,i){if(!e);else window.setTimeout(this.__cbConnect2Yunxin._$bind(this,t),h)}._$bind(this)})};d.__getDeviceID=function(){return setting.device};d.__getAppkey=function(){return setting.appkey};d.__getCurrentShopID=function(){return setting.bid};d.__saveEntryInfoByBid=function(e,t){a._$setEntryQueue(e,t)};d.__getEntryInfoByBid=function(e){a._$getEntryItemByBid(e)};d.__cbAllocateKefu=function(){var e=null;var t=function(t,n,o){var s=i._$merge({shop:{id:-1,name:"",logo:""},lastMessage:t.lastMessage||{}},t,{kefu:{staffname:t.staffname,groupname:t.groupname,staffid:t.staffid,groupid:t.groupid,entryid:t.entryid||0,isRobot:1==t.stafftype,iconurl:t.iconurl,isKefu:1},client:{isKefu:0},id:t.sessionid,sessionStatus:{status:o,hasKefuEntry:1==t.operator_enable,hasEvaluation:t.evaluation_enable},token:t.session_token,unread:1,evaluation:JSON.parse(t.evaluation||"{}")});if(a.SHOPID==s.shop.id){s.unread=0;e._$clearUnreadMsg(s.shop.id,s.id)}if(201==o)s.id=i._$uniqueID();a._$transform(s.id,s.shop.id);return s};var n={200:function(i,n){i.shop=i.shop||{};var o=a._$getSessionId(i.shop.id);var s=t(i,n,200);this.__doClearQueueCheck(i.shop.id);if(o==-1)e._$dispatchEvent("onsession",s);else e._$dispatchEvent("onsessionchange",i.shop.id,s)},201:function(i,n){i.shop=i.shop||{};var o=a._$getSessionId(i.shop.id),s=t(i,n,201);this.__doClearQueueCheck(i.shop.id);if(o==-1)e._$dispatchEvent("onsession",s);else e._$dispatchEvent("onsessionchange",i.shop.id,s)},203:function(i,n){i.shop=i.shop||{};var o=a._$getSessionId(i.shop.id),s=t(i,n,203);this.__doCheckQueue(s.shop.id);if(o==-1)e._$dispatchEvent("onsession",s);else e._$dispatchEvent("onsessionchange",i.shop.id,s);this._$dispatchEvent("onqueuestart",s)},x:function(e,i,n){var o=t(e,i,"x");this.__doClearQueueCheck(e.shop.id);this._$dispatchEvent(n,e)}};return function(t,o){e=this;var s=n[t.code];if(i._$isFunction(s))s.call(this,t,o);else n.x.call(this,t,o,"onkefuerror")}}();d.__cbReceiveMessage=function(){var e={image:"file",audio:"file",video:"file"};var t={60:!0,90:!0,95:!0,72:!0,200:!0};return function(n,o){var s=n.idClient.split("#")[0];if(!a._$isExistMessage(s,n)){n=this.__receiveMessageBody(n);if("custom"!=n.type)this._$dispatchEvent("onmessage",i._$merge(n,{content:n[e[n.type]||n.type]}));else{n.isOffline=o;this.__onReceiveInstr(n,t)}}else console.warn("receive duplicate message",s,n)}}();d.__getUserInfo=function(){var e=this.__getDataInCache("yunxin-user");if(window.localStorage){var t="X-"+this.__getAppkey().toUpperCase()+"-YSF-INFO",n=localStorage.getItem(t);if(!n)return;var o=i._$query2object(n);if(o.uid)e.fid=o.uid;o.source=n;if(!o.title){var s=i._$query2object(location.search.substr(1));var _=decodeURIComponent(s.t);o.title=_}return o}};d.__getForeignInfo=function(e){var t={email:"email",real_name:"name",mobile_phone:"mobile",avator:"avator"},n=JSON.parse(e.profile||"null")||[];i._$forEach(n,function(i){var n=t[i.key];if(n){delete t[i.key];i.value=i.value||e[n]||setting[n]||""}});i._$loop(t,function(t,i){var o=e[t]||setting[t];if(null!=o)n.unshift({key:i,value:o})});return n};d.__onReceiveInstr=function(){var e={"-1000":function(e,t){this.__nim.sendCustomSysMsg({cc:!1,filter:!1,to:u,scene:"p2p",content:JSON.stringify(e),done:function(e,t){if(e);}})},2:function(e,t){this.__cbAllocateKefu(e,t)},90:function(e,t){if(e.entries)this._$dispatchEvent("onshuntentries",e,t)},6:function(e,t){e.isSysClose=0==e["close_reason"]?!1:!0;this.__doDisConnect(e,t);if(1==e.evaluate)this._$dispatchEvent("oneval",e,t)},15:function(e,t){if(200==e.code)this._$dispatchEvent("onqueuechange",e,t);else if(302==e.code){this._$dispatchEvent("onqueuefail",e,t);this.__doClearQueueCheck(e.bid)}},17:function(e,t){},60:function(e,t){var n=_._$parse(e);i._$forEach(n,function(e){var n=this.__getMessageBody(t);this._$dispatchEvent("onmessage",i._$merge(n,e))},this)},70:function(e,t){this._$dispatchEvent("onovertime",i._$merge({msg:e.message,time:e.timestamp},e),t)},95:function(e,t){var n=a._$replaceSessionBySid(e.old_sessionid,{id:e.sessionid});t.from=i._$merge(n.kefu,{isKefu:1,staffid:e.staffid,staffname:e.staffname});i._$merge(n.sessionStatus,{transferred:!0,hasEvaluation:1});a._$transform(n.id,n.shop.id);this._$dispatchEvent("onsessionchange",n.shop.id,n);this._$dispatchEvent("ontransferresult",e,t)},72:function(e,t){}};e["17"]=e["6"];return function(t,n,o){if(!a._$isExistMessage(t)){var s=t.content||"";try{s=JSON.parse(s);if(n&&!n[s.cmd]&&!o)return}catch(_){}var r=e[s.cmd||o];if(i._$isFunction(r))r.call(this,s,t)}}}();d.__handleEntryInfo=function(e,t){var n=this.__getEntryInfoByBid(e);if(n)i._$merge(t,n);this.__saveEntryInfoByBid(e,{entryid:t.entryid,groupid:t.groupid,staffid:t.staffid})};d._$sendMessage=function(){var e=function(e){var t={c:e.content.file,m:"sendFile"};var n=e.content.file;if(i._$isString(n))if(0===n.indexOf("data:image"))t.r="dataURL";else{t.r="file";t.c={url:n,size:1,md5:n,ext:"png",w:1,h:1}}else if("INPUT"===n.tagName)t.r="fileInput";else if(n.md5)t.r="file";else t.r="blob";return t};var t={image:e,audio:e,video:e,file:e,geo:{m:"sendGeo",r:"geo"},text:{m:"sendText",r:"text"}};return function(e){if(this._$canSendMessage()){var n=t[e.type];if(i._$isFunction(n))n=n.call(this,e);if(n){var o=a.SHOPID;var s=i._$merge(this.__sendMessageBody(o),e);s[n.r]=n.c||s.content;delete s.content;return this.__nim[n.m](s)}else(e.done||f)({code:-2,message:"消息类型不支持"})}else(e.done||f)({code:-1,message:"长连接未建立"})}}();d.__doCheckQueue=function(e){var t=a._$getSessionId(e),n=this,o=a._$getSessionTimerBySid(t),s=1e4;if(t){if(o)clearInterval(o);o=setInterval(function(){n.__nim.sendCustomSysMsg(i._$merge(n.__sendMessageBody(e),{content:n.__prepareMessage("doqueuecheck",{bid:e})}))},s);a._$setSessionQueue(t,o)}};d.__doClearQueueCheck=function(e){var t=a._$getSessionId(e),i=a._$getSessionTimerBySid(t);if(!i)console.warn("why timer is null",t);clearTimeout(i)};d.__doDisConnect=function(e,t){e=i._$merge({time:t.time},e);this.__removeSessionPrd(e.sessionid);this._$dispatchEvent("onfinish",e)};d.__prepareMessage=function(e,t){var n=this;var o={doqueuecheck:function(e){return JSON.stringify({cmd:16,deviceid:n.__getDeviceID(),sessionid:a._$getSessionId(e.bid)})},clearunread:function(e){return JSON.stringify({cmd:500,sessionid:a._$getSessionId(e.bid)})},sendevaluate:function(e){return JSON.stringify(i._$merge({cmd:51,fromType:"web"},e))},sendofflinemessage:function(e){return JSON.stringify(i._$merge({cmd:83,deviceid:n.__getDeviceID()},e))}};if(i._$isFunction(o[e]))return o[e].call(this,t);else{console.error("prepare message is failure",e,t);
return!1}};d.__getMessageBody=function(e){return{time:e.time,id:e.idClient,sessionid:e.sessionid,from:e.from,to:{id:e.to}}};d.__saveYunxinUser=function(){var e=!1;return function(t){if(!e)e=!0;else console.warn("why process saveyunxinuser function twice",t);this.__setDataInCache("yunxin-user",t);a.YUNXIN_USER=t}}();d.__getSessionKefuInfo=function(e){var t=a._$getSessionById(e);if(!t){console.warn("maybe session is transformed",e);return{}}return{kefu:t.kefu,client:t.client}};d._$canSendMessage=function(){return!0};d._$config=function(e){if(e.appkey)this.__doCreateYXUser(e.appkey);else console.error("config data appkey not exist",e)};d._$doClearSessionUnread=function(e){var t=this,n=1e3;this.__nim.sendCustomSysMsg(i._$merge({},this.__sendMessageBody(e),{content:this.__prepareMessage("clearunread",{bid:e}),done:function(i){if(i)setTimeout(function(){t._$doClearSessionUnread._$bind(t,e)},n)}}))};d._$applyRGKefuByBid=function(e){var t=a._$getSessionByBid(e),i=a._$getEntryItemByBid(e)||{};if(t)this.__applyKefu(e,{type:1,staffid:i.staffid||0,groupid:i.groupid||0,entryid:i.entryid||0})};d._$applyNormalKefuByBid=function(e){var t=a._$getSessionByBid(e),i=a._$getEntryItemByBid(e)||{};if(t)this.__applyKefu(e,{type:0,staffid:i.staffid||0,groupid:i.groupid||0,entryid:i.entryid||0})};d._$sendEvaluate=function(e,t){var n=this,o=1e3;this.__nim.sendCustomSysMsg(i._$merge({},this.__sendMessageBody(e),{content:this.__prepareMessage("sendevaluate",{sessionid:t.sessionid,remarks:t.remarks,evaluation:t.evaluation}),done:function(i){if(i)setTimeout(function(){n._$sendEvaluate._$bind(n,e,t)},o)}}))};d._$sendOfflineMessage=function(e,t){var n=this,o=1e3;this.__nim.sendCustomSysMsg(i._$merge({},this.__sendMessageBody(e),{content:this.__prepareMessage("sendofflinemessage",{bid:e,message:t.content||"",mobile:t.mobile||"",email:t.email||""}),done:function(i){if(i)setTimeout(function(){n._$sendOfflineMessage._$bind(n,e,t)},o)}}));this._$dispatchEvent("onsendleavemsg",e)};d._$sendKefuHeart=function(){var e=this,t=8e3;var i=function(){e.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:u,scene:"p2p",content:JSON.stringify({cmd:-1e3,deviceid:e.__getDeviceID()}),done:function(n,o){if(e.__timeout)clearTimeout(e.__timeout);e.__timeout=setTimeout(function(){i()},t)}})};i()};d._$doCheckQueue=function(e){this.__doCheckQueue(e)};d._$clearUnreadMsg=function(e,t){var n=this,o=1e3;this.__nim.sendCustomSysMsg(i._$merge({},this.__sendMessageBody(e),{content:this.__prepareMessage("clearunread",{bid:e}),done:function(i){if(i)setTimeout(function(){n._$clearUnreadMsg._$bind(n,e,t)},o)}}))};d._$reportUserInfo=function(e){var t=this.__getUserInfo(),i=this;if(t)if(this.__last!=t.source){this.__last=t.source;var n=this.__getDataInCache("yunxin-user");this.__nim.sendCustomSysMsg({to:e||u,cc:!0,filter:!0,scene:"p2p",content:JSON.stringify({cmd:52,foreignid:t.uid,userinfo:JSON.stringify(this.__getForeignInfo(t))}),done:function(e,t){}})}};d._$syncRobotEx=function(e,t){var n={matched_question:"question",id:"questionid"};var o=function(e){var t={};for(var i in e)if(n[i])t[n[i]]=e[i];else t[i]=e[i];return t};if(this._$canSendMessage()){var s=this.__getDataInCache("yunxin-user"),_=this.__getDataInCache("yunxin-kefu"),a=i._$uniqueID(),r=i._$merge({cmd:63},o(e),{msgIdClient:a});this.__nim.sendCustomSysMsg({to:t||u,cc:!0,filter:!0,scene:"p2p",content:JSON.stringify(r),done:function(t,i){if(!t);else window.setTimeout(this._$syncRobotEx._$bind(this,e),1e4)}._$bind(this)})}};d._$sendSelectShunt=function(e,t,n){var o={type:1};i._$merge(o,e);this.__cbConnect2Yunxin(o);this._$dispatchEvent("onsendshunt",t,n)};d._$sendPrdMsg=function(e){var t=this,n=a._$getSessionId(e);if(n){e=e||-1;if(window.localStorage){var o="X-"+this.__getDataInCache("yunxin-user").appKey.toUpperCase()+"-"+e+"-YSF-PRODUCT",s=localStorage.getItem(o),_="YSF-PRODUCT-"+n+"-last",r=localStorage.getItem(_);if(s&&s!=r)this.__sender3rdProductsInfo(function(e){window.localStorage.setItem(_,s);window.localStorage.removeItem(o);if(1==e.show)t._$dispatchEvent("onmessage",i._$merge({sessionid:n,from:{id:-72}},e))},e)}}};d.__sender3rdProductsInfo=function(e,t){var n=this.__getDataInCache("yunxin-user"),o=this.__getUserInfo(),s=this,_=s.__getProductInfo(t);var a=function(){s.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:t||u,scene:"p2p",content:JSON.stringify(i._$merge({cmd:121},_)),done:function(t,n){if(!t)e(i._$merge({id:i._$uniqueID(),type:"productinfo",content:_.url},_));else s._$dispatchEvent("onproducterror",{type:"product-error",content:"商品链接参数错误"})}})};if(_)a()};d.__getProductInfo=function(e){var t=this.__getDataInCache("yunxin-user");var n="X-"+t.appKey.toUpperCase()+"-"+e+"-YSF-PRODUCT",o=localStorage.getItem(n);return null==o?null:i._$query2object(o)};d.__removeSessionPrd=function(e){if(window.localStorage){var t="YSF-PRODUCT-"+e+"-last",i=localStorage.getItem(t);if(i)window.localStorage.removeItem(t)}};return l._$allocate()},15,16,1,3,82,83,80,24,81);I$(26,function(e,t,i,n,o,s,_,a,r){a._$$EventBus=e._$klass();r=a._$$EventBus._$extend(n._$$EventTarget);r.__init=function(){var e=!1;return function(t){if(!e){e=!0;i._$loop({onmessage:this.__receiveMessage._$bind(this),onsession:this.__addSession._$bind(this),onsessionchange:this.__onSessionChange._$bind(this),oneval:this.__onEval._$bind(this),onovertime:this.__onOvertime._$bind(this),onfinish:this.__onFinish._$bind(this),onqueuestart:this.__onQueueStart._$bind(this),onqueuefail:this.__onQueueFail._$bind(this),onqueuechange:this.__onQueueChange._$bind(this),ontransferresult:this.__onTransferResult._$bind(this),onshuntentries:this.__onShuntEntries._$bind(this),onsendshunt:this.__onSendShunt._$bind(this),onsendleavemsg:this.__onSendLeaveMsg._$bind(this),onusererror:this.__onUserError._$bind(this),onkickout:this.__onKickout._$bind(this),lifecyclecreated:this.__cbLifeCycleCreated._$bind(this)},function(e,t){_._$addEvent(t,e)})}this.__super(t)}}();r.__addSession=function(e){this.__handleSession("onsession",null,e);t._$dispatchEvent(this.constructor,"onsession",e)};r.__onKickout=function(e){t._$dispatchEvent(this.constructor,"onkickout",e)};r.__onEval=function(e,i){var n=this.__handleSession("oneval",e.sessionid);t._$dispatchEvent(this.constructor,"oneval",n)};r.__onOvertime=function(e,i){var n=this.__handleSession("onovertime",e.sessionid);t._$dispatchEvent(this.constructor,"onovertime",n)};r.__onFinish=function(e,n){var o=this.__handleSession("onfinish",e.sessionid,e.close_reason);if(1==e.close_reason)i._$merge(o.sessionStatus,{isOverTime:!0});t._$dispatchEvent(this.constructor,"onfinish",o)};r.__receiveMessage=function(e){i._$merge(e,{_type:e.type});t._$dispatchEvent(this.constructor,"onmessage",e)};r.__onTransferResult=function(e,i){var n=this.__handleSession("ontransferresult",e.sessionid,null,e);t._$dispatchEvent(this.constructor,"ontransferresult",n,e)};r.__onSessionChange=function(e,i){try{i=s._$replaceSessionByBid(e,i);t._$dispatchEvent(this.constructor,"onsessionchange",i)}catch(n){console.error("onsessionchange function error when process eventbus",e,i,n)}};r.__onUserError=function(e,i){t._$dispatchEvent(this.constructor,"onusererror",e,i)};r.__onQueueStart=function(e){try{if(e.shop.id==s.SHOPID)t._$dispatchEvent(this.constructor,"onqueuestart",e)}catch(i){console.error("onqueuestart function error when process eventbus",i)}};r.__onQueueFail=function(e,i){var n=s._$getSessionId(e.bid);var o=this.__handleSession("onqueuefail",n,null,e);try{if(o.shop.id==s.SHOPID)t._$dispatchEvent(this.constructor,"onqueuefail",o)}catch(_){console.error("onqueuefail function error when process eventbus",_)}};r.__onQueueChange=function(e,i){var n=this.__handleSession("onqueuechange",e.sessionid,null,e);try{if(n.shop.id==s.SHOPID)t._$dispatchEvent(this.constructor,"onqueuechange",n)}catch(o){console.error("onqueuechange function error when process eventbus",o)}};r.__onShuntEntries=function(e,n){try{var o=s._$getSessionId(e.shop.id);var _,a;if(o==-1){a=!0;_={id:i._$uniqueID(),kefu:{},lastMessage:{},sessionStatus:{status:200,hasEvaluation:0,hasKefuEntry:0},shop:e.shop,startTime:+new Date,unread:0,isMock:!0};s._$transform(_.id,_.shop.id);this.__addSession(_)}else{a=!1;_=this.__handleSession("onshuntentries",o);this.__onSessionChange(_.shop.id,_)}var r=JSON.parse(e.entries);var n=i._$merge(e,{entries:r,label:e.message,from:{portrait:e.iconurl}});t._$dispatchEvent(this.constructor,"onshuntentries",{session:_,msg:n,isFirstSes:a})}catch(c){console.error("onshuntentries function error when process eventbus",c)}};r.__onSendShunt=function(e,i){var n=s._$getSessionByBid(e);if(n.shop.id==s.SHOPID)t._$dispatchEvent(this.constructor,"onsendshunt",{bid:e,mid:i})};r.__cbLifeCycleCreated=function(){t._$dispatchEvent(this.constructor,"lifecyclecreated")};r.__handleSession=function(e,t,n,o){var _={onsession:function(e){return e},onsessionchange:function(e){return e},oneval:function(e,t){e=s._$getSessionById(t);return e},onkickout:function(e,t){e=s._$getSessionById(t);return e},onovertime:function(e,t){e=s._$getSessionById(t);return e},onfinish:function(e,t){e=s._$getSessionById(t);e.sessionStatus.status=500;return e},onevaluate:function(e,t){e=s._$getSessionById(t);e.sessionStatus.hasEvaluation=0;return e},onofflinemessage:function(e,t){e=s._$getSessionById(t);return e},onqueuefail:function(e,t,n){e=s._$getSessionById(t);i._$merge(e.sessionStatus,{status:201});e.message=n.message;return e},onqueuechange:function(e,t,n){e=s._$getSessionById(t);i._$merge(e.sessionStatus,{status:203});e.before=n.before;return e},ontransferresult:function(e,t,n){var o=function(e){e.id=n.sessionid;e.sessionid=n.sessionid;i._$merge(e.sessionStatus,{status:200});i._$merge(e.lastMessage,{type:"text",content:"会话转接给"+n.staffname,time:n.time})};e=s._$getSessionById(t);o(e,n);return e},onshuntentries:function(e,t){var n=s._$getSessionById(t);e={id:i._$uniqueID(),lastMessage:{},sessionStatus:{status:200,hasEvaluation:0,hasKefuEntry:0},kefu:{},shop:n.shop,startTime:+new Date,isMock:!0};s._$transform(e.id,e.shop.id);return e}};var a=_[e];if(i._$isFunction(a))return a.call(this,n,t,o);else console.warn("no function exist when handle session",e,n);
};r._$doCheckQueue=function(e){_._$doCheckQueue(e)};a._$do=function(e){if(i._$isFunction(e)){var t=a._$$EventBus._$allocate(),n=e.call(null,t);t._$recycle();return n}};r._$upload=function(e,i){t._$dispatchEvent(this.constructor,"upload",{_type:e,result:i})};r._$sendEvaluate=function(e,i){this.__handleSession("onevaluate",s._$getSessionId(e));_._$sendEvaluate(e,i);t._$dispatchEvent(this.constructor,"onevaluate",{bid:e,param:i})};r._$delMessageById=function(e,i){window.ysfCache.message._$clearItemInCache(i);t._$dispatchEvent(this.constructor,"ondelmessage",{bid:e,messageId:i})};r._$sendOfflineMessage=function(e,i){var n=this.__handleSession("onofflinemessage",s._$getSessionId(e));_._$sendOfflineMessage(e,i);t._$dispatchEvent("onofflinemessage",e,i)};r._$receiveMessage=function(e){this._$dispatchEvent("receivemessage",e)};r._$clearUnreadMsg=function(e){try{var t=s._$getSessionById(e);if(!t||!t.shop.id){console.warn("why session not exist when process clearUnreadMsg",e);return}t.unread=0;_._$clearUnreadMsg(t.shop.id,e);this._$dispatchEvent("clearunreadmsg",e)}catch(i){}};r._$transToRGKefu=function(e,i){_._$applyRGKefuByBid(e);t._$dispatchEvent(this.constructor,"transtorgkefu",{bid:e,mid:i})};r.__onSendLeaveMsg=function(e){t._$dispatchEvent(this.constructor,"onsendleavemsg",e)};o._$$CustomEvent._$allocate({element:a._$$EventBus,event:["onsessionload","onfinish","onovertime","oneval","onkickout","onusererror","onconnect","onsession","onmessage","onsessionchange","upload","onofflinemessage","onevaluate","onqueuechange","onqueuefail","onqueuestart","ontransferresult","onshuntentries","onsendshunt","onsendleavemsg","clearunreadmsg","lifecyclecreated","ondelmessage","transtorgkefu"]});a._$$instrance=a._$$EventBus._$allocate()},15,16,1,60,44,24,27);I$(152,function(e){e.__pushHistory=function(e){};return e});I$(103,function(e,t,i,n,o,s,_){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="4.0")I$(154,function(){window.hst_lock={};t.__pushHistory=function(){var e,n,o=[],s="cb-"+ +new Date,_='<script>parent.hst_lock["'+s+'"] = !0;parent.location.hash = decodeURIComponent("#<HASH>");</script>';var a=function(){e=window.clearTimeout(e);if(o.length){var t=o.shift();try{var i=n.contentWindow.document;i.open();i.write("<head><title>");i.write(document.title);i.write("</title>");i.write(_.replace("#<HASH>",encodeURIComponent(t)));i.write("</head><body></body>");if(location.hostname!=document.domain)i.domain=document.domain;i.close();hst_lock[s]=!1}catch(r){console.log(r.message||r);o.unshift(t)}e=window.setTimeout(a,50)}};return function(e){if(!t[s]&&(n||e)){o.push(e);if(!n)n=i._$createXFrame();a()}}}()});return t},43,152,17);I$(59,function(e,t,i,n,o,s,_,a,r,c){var d=/^[#?]+/,l=/#(.*?)$/,u=this;var f=function(){return!history.pushState||i._$IS.android||!history.auto};var h=function(e,t){var i=!t?"pushState":"replaceState";u.history[i](null,document.title,e)};var m=function(){return location.parse(u.location.href)};h=h._$aop(function(e){if(f()){e.stopped=!0;var t=e.args;_url=t[0].replace(d,"");!t[1]?u.location.hash=_url:u.location.replace("#"+_url)}});m=m._$aop(function(e){if(f()){e.stopped=!0;var t=l.test(u.location.href)?RegExp.$1:"";e.value=location.parse(t.replace(d,""))}});location.redirect=function(e,t){h(e,t)};location.active=function(){var e,n,_,a,r;var c=function(e){if(!a){var i={oldValue:_,newValue:m()};if(location.ignored)location.ignored=!1;else{t._$dispatchEvent(location,"beforeurlchange",i);if(i.stopped){if(_){a=!0;h(_.href,!0)}return}}n=u.location.href;_=i.newValue;t._$dispatchEvent(location,"urlchange",_);s.__pushHistory(_.href)}else a=!1};var d=function(){if(n!=u.location.href)c();e=o.requestAnimationFrame(d)};var l=function(){var e=i._$KERNEL;_ie7="trident"==e.engine&&e.release<="3.0";return f()&&"onhashchange"in window&&!_ie7};return function(i){if(!r){r=!0;u=i||window;if(l()){t._$addEvent(u,"hashchange",c);c()}else if(!e){e=o.requestAnimationFrame(d);d()}}}}();location.parse=function(){var t=/^https?:\/\/.*?\//i,i=/[?#]/;return function(n){var o={href:n};n=(n||"").replace(t,"/").split(i);var s=1;if("/"==n[0]&&0==(n[1]||"").indexOf("/"))s=2;o.path=n.splice(0,s).join("?");o.query=e._$query2object(n.join("&"));return o}}();location.same=function(e){return m().href==e};n._$$CustomEvent._$allocate({element:location,event:["beforeurlchange","urlchange"]});return _},1,16,43,44,102,103);I$(62,function(e,t,i,n,o,s,_,a){var r;o._$$Node=t._$klass();r=o._$$Node._$extend(n._$$EventTarget);r.__init=function(){this.__super();this.__children=[]};r.__reset=function(e){this.__super(e);this._$setParent(e.parent);this.__name=e.name||"/";this.__data=e.data||{}};r.__destroy=function(){var e=function(e,t,i){i.splice(t,1);e._$recycle()};return function(){this.__super();delete this.__data;i._$reverseEach(this.__children,e);this._$setParent(null)}}();r.__isNode=function(e){return e instanceof this.constructor};r.__hasChild=function(e){return i._$indexOf(this.__children,e)>=0};r._$getName=function(){return this.__name};r._$getData=function(){return this.__data};r._$getPath=function(){var e=this._$getParent(),t=this._$getName();if(!e)return t;var i=e._$getName();if("/"!=i&&"/"!=t)t="/"+t;return e._$getPath()+t};r._$getParent=function(){return this.__parent};r._$getChildren=function(){return this.__children};r._$getChildByName=function(e){var t=i._$indexOf(this.__children,function(t){return e==t._$getName()});return this.__children[t]||null};r._$setParent=function(e){e=this.__isNode(e)?e:null;if(e!=this.__parent){e?e._$appendChild(this):this.__parent._$removeChild(this);this.__parent=e}};r._$appendChild=function(e){e=this.__isNode(e)?e:null;if(e&&!this.__hasChild(e)){this.__children.push(e);e._$setParent(this)}};r._$removeChild=function(e){e=this.__isNode(e)?e:null;var t=i._$indexOf(this.__children,e);if(t>=0){this.__children.splice(t,1);e._$setParent(null)}return e};return o},41,15,1,60);I$(61,function(e,t,i,n,o,s,_){var a=function(t,i,n){var o=t,n=n||s;if("/"!=i)e._$forEach(i.split("/"),function(e){var t=n(o,e);if(!t)return!0;o=t});return o};n._$getNodeByUMI=function(){var e=function(e,t){var t=t||"/",i=e._$getName();if("/"==i&&"/"==t)return e;else return e._$getChildByName(t)};return function(t,i){return a(t,i,e)}}();n._$appendNodeByUMI=function(){var e=function(e,i){var n=e._$getName();if(!i&&"/"==n)return e;var o=null;if("/"!=n){o=e._$getChildByName("/");if(!o){o=t._$$Node._$allocate();e._$appendChild(o)}}if(i){o=e._$getChildByName(i);if(!o){o=t._$$Node._$allocate({name:i});e._$appendChild(o)}}return o};return function(t,i){return a(t,i,e)}}();n._$getCommonRoot=function(t,i,o){if(!i||!o)return t;var i=i._$getPath().split("/"),o=o._$getPath().split("/"),s=e._$forIn(i,function(e,t){if(e!=o[t])return!0})||1,_=i.splice(0,s).join("/")||"/";return n._$getNodeByUMI(t,_)};n._$breadthFirstSearch=function(e,t){var i=[e],n=i.shift(),t=t||s;for(;n;){i.push.apply(i,n._$getChildren());t(n);n=i.shift()}};n._$isNode=function(e){return e instanceof t._$$Node};n._$isModule=function(e){return e instanceof i._$$ModuleAbstract};n._$isUMIPrivate=function(){var e=/^\/?\?(?=\/|$)/;return function(t){return e.test(t||"")}}();n._$path2umi=function(){var e=/[\?#]/;return function(t){var i=(t||"").trim().split(e),n="/"==i[0]&&0==(i[1]||"").indexOf("/");return i[0]+(n?"?"+i[1]:"")}}();return n},1,62,65);I$(63,function(e,t,i,n,o,s,_,a,r,c,d,l){var u;r._$$GroupManager=t._$klass();u=r._$$GroupManager._$extend(s._$$EventTarget);u.__reset=function(e){this.__super(e);this.__root=e.root;this.__dispatcher=e.dispatcher;this.__mpool={}};u.__destroy=function(){this.__super();delete this.__root;delete this.__mpool;delete this.__dispatcher};u.__isStopped=function(e){if(!a._$isNode(e))return!1;else return!!e._$getData().stopped||this.__isStopped(e._$getParent())};u.__doClearStopped=function(e){if(a._$isNode(e)){delete e._$getData().stopped;this.__doClearStopped(e._$getParent())}};u.__doModuleHide=function(e,t){this.__doModuleCheck("onhide",e,t)};u.__doModuleShow=function(e,t){this.__doModuleCheck("onshow",e,t);this.__doModuleAction(e)};u.__doModuleRefresh=function(e){this.__doModuleCheck("onrefresh",e);this.__doModuleAction(e)};u.__doModuleCheck=function(e,t,i){if(t!=i&&a._$isNode(t)){if("onhide"==e)this.__doModuleDispatch(t,e);this.__doModuleCheck(e,t._$getParent(),i);if("onhide"!=e)this.__doModuleDispatch(t,e)}};u.__doModuleAction=function(t){if(!a._$isNode(t))return!0;var i=t._$getData(),n=i.action,o=i.module;if(!this.__doModuleAction(t._$getParent())||n&&e._$isString(o))return!1;if(o&&o._$allocate&&n&&"onhide"!=n){if(this.__isStopped(t))return;var s={umi:t._$getPath(),composite:i.composite,dispatcher:this.__dispatcher};o=o._$allocate(s);if(a._$isModule(o)){i.module=o;this.__doModuleDispatch(t,"onshow")}else delete i.module}delete i.action;return!0};u.__doModuleDispatch=function(){var t=function(e){var t;e=e._$getParent();for(;e;){t=e._$getData().module;if(a._$isModule(t))return t._$getExportData();e=e._$getParent()}return null};return function(i,s){if(a._$isNode(i)){var r=i._$getData(),d=r.module,l="onhide"!=s;if(a._$isModule(d)){if(l&&this.__isStopped(i))return;var u=!this.__source?r.event:this.__source._$getData().event;if(u){u.umi=i._$getPath();u.data=t(i)}var f=r.xname||"onhide";if("onshow"==s&&"onhide"!=f)s="onrefresh";if("onrefresh"==s&&"onhide"==f)s="onshow";r.xname=s;d._$dispatchEvent(s,u||{});if(l&&u&&u.pos&&u.umi==u.target)n._$scrollTo(u.pos);if(l&&u){r.stopped=u.stopped;delete u.stopped}}else if(d){r.action=s;if("onshow"==s&&e._$isString(d)){var h=n._$get("umi://"+d);if(h)_._$parseTemplate(h);else{var m=location.config||c;o._$loadHtml((m.root||"")+d,{version:(m.ver||c)[d],onload:_._$parseTemplate})}}}}}}();u._$hasUMI=function(e){return!!this.__mpool[e]};u._$addUMI=function(e){this.__mpool[e]=!0};u._$delUMI=function(e){delete this.__mpool[e]};u._$loadedUMI=function(e){if(this._$hasUMI(e))this.__doModuleAction(a._$getNodeByUMI(this.__root,e))};u._$dispatchUMI=function(e){if(this._$hasUMI(e)){var t=a._$getNodeByUMI(this.__root,e);this.__doClearStopped(t);this.__doModuleShow(t);
}};u._$hideUMI=function(e){if(this._$hasUMI(e))this.__doModuleHide(a._$getNodeByUMI(this.__root,e))};return r},1,15,68,17,45,60,2,61);I$(64,function(e,t,i,n,o,s,_,a){var r;o._$$GroupManagerSingle=e._$klass();r=o._$$GroupManagerSingle._$extend(n._$$GroupManager);r.__reset=function(e){this.__super(e);this.__classed=!!e.classed};r.__destroy=function(){this.__super();delete this.__cmroot;delete this.__source};r._$exitable=function(e){if(!this.__source)return!0;var t=this.__source._$getData().module;if(i._$isModule(t))t._$dispatchEvent("onbeforehide",e);return!e.stopped};r._$refresh=function(){if(this.__source)window.setTimeout(this._$dispatchUMI._$bind(this,this.__source._$getPath()),0)};r._$dispatchUMI=function(e){if(this._$hasUMI(e)){var n=i._$getNodeByUMI(this.__root,e),o=n._$getData();if(o.module){var _=this.__source,a=o.event,r=s;this.__source=n;this.__doClearStopped(n);if(_){r=_._$getData().event;a.referer=r.href||""}if(_!=n){this.__cmroot=i._$getCommonRoot(this.__root,_,n);if(null!=_){if(_!=this.__cmroot){if(this.__classed)t._$delClassName(document.body,r.clazz);this.__doModuleHide(_,this.__cmroot)}this.__doModuleRefresh(this.__cmroot)}else this.__doModuleShow(this.__cmroot);if(n!=this.__cmroot){if(this.__classed)t._$addClassName(document.body,a.clazz);this.__doModuleShow(n,this.__cmroot)}}else this.__doModuleRefresh(this.__source)}}};r._$loadedUMI=function(e){if(this._$hasUMI(e))this.__doModuleAction(this.__source)};r._$hide=function(){if(this.__source){this._$hideUMI(this.__source._$getPath());delete this.__cmroot;delete this.__source}};return o},15,17,61,63);I$(104,function(e,t,i,n,o){t.__doFixTitle=function(){var e=/#.*?$/i;return function(t){var i=document.title,n=i.replace(e,"");if(i!=n){t=n||t;document.title=t}return document.title}}();t.__doFixHashTitle=function(e){};return t},43);I$(66,function(e,t,i,n,o,s){if("trident"===t._$KERNEL.engine&&t._$KERNEL.release>="7.0")I$(105,function(t){e.__doFixHashTitle=function(i){new MutationObserver(function(n){t._$reverseEach(n,function(t){if("TITLE"==t.target.tagName||"characterData"==t.type){i=e.__doFixTitle(i);return!0}})}).observe(document,{subtree:!0,childList:!0,characterData:!0})}},1);if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<"7.0")I$(106,function(t){e.__doFixHashTitle=function(i){t._$addEvent(document,"propertychange",function(t){if("title"==t.propertyName)i=e.__doFixTitle(i)})}},16);return e},104,43);I$(12,function(e,t,i,n,o,s,_,a,r,c,d,l,u,f,h,m,p,$){var g;h._$$Dispatcher=t._$klass();g=h._$$Dispatcher._$extend(a._$$EventTarget);g.__init=function(){this.__super();var e=o._$uniqueID();this.__pbseed="pb-"+e;this.__pvseed="pv-"+e};g.__reset=function(e){this.__dtmp={};this.__rest=!!e.rest;this.__root=c._$$Node._$allocate();this.__config={m:{},mg:{},r:[],rr:{},al:{},am:{}};this.__groups={};this.__doBuildGroup(this.__pbseed);this.__groups[this.__pvseed]=d._$$GroupManager._$allocate({root:this.__root,dispatcher:this});f.__doFixHashTitle(document.title);this.__doInitDomEvent([[location,"urlchange",this.__onURLChange._$bind(this)]]);this.__super(e);this._$rule(e.rules);this._$regist(e.modules)};g.__destroy=function(){var e=function(e,t,i){delete i[t];e._$recycle()};return function(){delete this.__config;this.__root=this.__root._$recycle();o._$loop(this.__groups,e);this.__super()}}();g.__setModuleConf=function(e,t,i){var n=this.__config.m[e];if(!n){n={};this.__config.m[e]=n}n[t]=i};g.__getModuleConf=function(e,t){var i=this.__config.m[e];return!i?"":i[t]};g.__doBuildGroup=function(e){if(e){var t=this.__groups[e];if(!t){t=l._$$GroupManagerSingle._$allocate({root:this.__root,dispatcher:this,classed:e==this.__pbseed});this.__groups[e]=t}return t}};g.__doAddUMI2Group=function(e,t){var i=this.__doBuildGroup(t);if(!i){t=r._$isUMIPrivate(e)?this.__pvseed:this.__pbseed;i=this.__groups[t]}i._$addUMI(e);this.__config.mg[e]=t};g.__doRewriteUMI=function(){var e=/\$\d/;return function(t,i){var n;o._$forIn(this.__config.r,function(s){o._$forIn(s,function(s,_){if(null!=s){if(o._$isFunction(s)){var a=!1;try{a=s.call(null,{umi:t,href:i})}catch(r){}if(a){n=_;return!0}}if(o._$isArray(s)){var c=o._$indexOf(s,function(e){return e===t||e===i});if(c>=0){n=_;return!0}}if(s.test&&(s.test(t)||s.test(i))){n=e.test(_)?t.replace(s,_):_;return!0}if(s===t||s===i){n=_;return!0}}});return!!n});return n||t}}();g.__onURLChange=function(){var e=/(?:^\/+)|(?:\/+$)/gi,t=/#(\$.*?)$/,i=/\/$/;var n=function(t,i){var n=i._$getPath(),t=t.replace(n,"").replace(e,"");return t.split("/")};var o=function(e,t){var i,n=e.split("/");for(;n.length>0;){if(!n[n.length-1])n.pop();else n[n.length-1]="";i=t[n.join("/")];if(i)return i}return""};return function(e){if(0!=e.path.indexOf("$")){var s=this.__dtmp[e.path];delete this.__dtmp[e.path];this._$dispatchEvent("onbeforechange",e);var _=this.__doRewriteUMI(e.path,e.href),a=this.__config.mg[_];if(!a&&this.__rest)a=o(_,this.__config.mg);if(!a&&!r._$isUMIPrivate(_)){_=this.__config.rr["404"];a=this.__config.mg[_]}if(!a&&this.__rest)a=o(_,this.__config.mg);if(a){var c=r._$getNodeByUMI(this.__root,_),d=null;if(this.__rest){d=n(_,c);if(!i.test(_)&&this.__config.mg[_+"/"])c=c._$getChildByName("/")}var l=_;_=c._$getPath();c._$getData().event={target:_,source:l,href:e.href,param:e.query,input:s,prest:d,clazz:this.__getModuleConf(_,"clazz"),pos:t.test(e.href)?RegExp.$1:""};var u=this.__getModuleConf(l,"title");if(u)document.title=u;this.__groups[a]._$dispatchUMI(_)}}}}();g.__onClickDelegate=function(){var e=function(e,t){if(e){var i=location.parse(e);this._$dispatchEvent("onbeforechange",i);var n=this.__doRewriteUMI(i.path,t||i.href);return this.__groups[this.__pbseed]._$hasUMI(n)}};var t=function(t){var n=i._$dataset(t,"href");if(n)return n;var s=i._$attr(t,"href");if(s&&!i._$dataset(t,"notUmi")){var _=s.split("#");_.shift();var n=_.join("#");if(e.call(this,n,s))return n;if(e.call(this,s)){var a=location.parse(s);return a.path+"?"+o._$object2query(a.query)}}};var s=function(e){return!!t.call(this,e)};return function(e){var i=n._$getElement(e,s._$bind(this));if(i){n._$stopDefault(e);this._$redirect(t.call(this,i))}}}();g.__onActionDelegate=function(e){var t=this.__config.am,o=t[e.type];if(o){var s=n._$getElement(e,"d:resAction");if(s){var _=i._$dataset(s,"resAction")||"",a=o[_.toLowerCase()];if(a){var r={action:_,target:s,id:i._$dataset(s,"resId"),type:i._$dataset(s,"resType"),extra:i._$dataset(s,"resExtra")};this._$dispatchEvent("onbeforeaction",{event:e,target:s,result:r});a.call(this,r)}}}};g._$rule=function(){var e=["404"];var t=function(e,t){this._$rule(t,e)};var i=function(e,t){this.__setModuleConf(t,"title",e)};var n=function(e,t){this.__config.al[t]=e};var s=function(t){if(t){this.__config.r.push(t);o._$forEach(e,function(e){if(t[e]){this.__config.rr[e]=t[e];delete t[e]}},this)}};var _=function(e,t){var i=this.__config.am;var n="click",s=e,t=(t||"").toLowerCase();if(o._$isObject(e)){n=e.event||n;s=e.value}if(o._$isString(s))s=function(e,t){this._$redirect(e,{force:!0,input:t})}._$bind(this,s);else if(o._$isFunction(s))s=s._$aop(null,function(e){var t=e.value;if(o._$isString(t))this._$redirect(t,{force:!0,input:e.args[0]})}._$bind(this));if(o._$isFunction(s)){if(!i[n]){this.__doInitDomEvent([[document,n,this.__onActionDelegate._$bind(this)]]);i[n]={}}i[n][t]=s}};var a={title:function(e){o._$loop(e,i,this)},rewrite:function(e){if(!o._$isArray(e))s.call(this,e);else o._$forEach(e,s,this)},alias:function(e){o._$loop(e,n,this)},action:function(e){o._$loop(e,_,this)}};return function(e,i){if(o._$isArray(e)){i=e;e="rewrite"}else if(!o._$isString(e)){o._$forIn(e,t,this);return}(a[e]||p).call(this,i)}}();g._$regist=function(){var e=function(e,t){this._$regist(t,e)};var t=function(e){return!!e&&!!e._$extend};return function(i,n){if(o._$isString(i)){var s=r._$appendNodeByUMI(this.__root,i)._$getData(),_=s.module;if(!r._$isModule(_)&&!t(_)){var a=this.__config.mg[i],_;if(o._$isString(n)||t(n))_=n;else{n=n||m;a=n.gid;_=n.module;if(n.title)this.__setModuleConf(i,"title",n.title);if(n.clazz)this.__setModuleConf(i,"clazz",n.clazz);if(n.composite)s.composite=n.composite}this.__doAddUMI2Group(i,a);s.module=_}}else o._$forIn(i,e,this)}}();g._$message=function(){var e=function(e,t){var i=e._$getData().module;if(r._$isModule(i))i._$dispatchEvent("onmessage",t)};var t=[e,function(t,i){var n=i.from;for(;t;){if(t._$getPath()!=n)e(t,i);t=t._$getParent()}},function(t,i){var n=i.from;r._$breadthFirstSearch(t,function(t){if(t._$getPath()!=n)e(t,i)})}];return function(e){var i=o._$merge({},e),n=r._$getNodeByUMI(this.__root,i.to);i.path=n._$getPath();(t[i.mode]||t[0]).call(this,n,i)}}();g._$publish=function(e,t){var t=o._$merge({},t);t.type=e||"";this._$dispatchEvent((t.from||"")+":"+t.type,t)};g._$subscribe=function(e,t,i){e=this.__config.al[e]||e;this._$addEvent((e||"")+":"+(t||""),i)};g._$unsubscribe=function(e,t,i){e=this.__config.al[e]||e;this._$delEvent((e||"")+":"+(t||""),i)};g._$hide=function(e){var t=this.__config.mg[e];if(t==this.__pvseed)this.__groups[t]._$hideUMI(e)};g._$hideGroup=function(e){var t=this.__groups[e];if(t)t._$hide()};g._$redirect=function(e,t){t=t||m;var i=r._$path2umi(e),n=location.parse(e);this.__dtmp[n.path]=t.input;if(r._$isUMIPrivate(i))this.__onURLChange(n);else{var o=this.__groups[this.__pbseed],s={target:n,umi:i};if(o._$exitable(s))if(location.same(e)&&t.force)this.__onURLChange(n);else{location.ignored=!!t.ignored;location.redirect(e,!!t.replace)}}};g._$refresh=function(e){if(e)this._$redirect(e,{replace:!0,force:!0});else this.__groups[this.__pbseed]._$refresh()};g._$delegate=function(){this.__doInitDomEvent([[document,"click",this.__onClickDelegate._$bind(this)]])};g._$active=function(){location.active()};g._$loaded=function(e,t){e=this.__config.al[e]||e;if(!o._$isArray(e)){this._$regist(e,t);this.__groups[this.__config.mg[e]]._$loadedUMI(e)}else o._$forEach(e,function(e){this._$loaded(e,t)},this)};h._$startup=function(e){window.dispatcher=h._$$Dispatcher._$getInstance(e);u._$dumpModules();_._$parseTemplate((e||m).tid||"template-box",location.config);
n._$addEvent(document,"templateready",function(){window.setTimeout(dispatcher._$active._$bind(dispatcher),0)});return window.dispatcher};if(!0){e.P("nej.e")._$startup=h._$startup;e.P("nej.ut")._$$Dispatcher=h._$$Dispatcher}return h},41,15,17,16,1,59,2,60,61,62,63,64,65,66);I$(65,function(e,t,i,n,o,s,_,a,r,c){var d;_._$$ModuleAbstract=t._$klass();d=_._$$ModuleAbstract._$extend(o._$$EventTarget);d.__init=function(){this.__super();this.__export={};this.__doBuild()};d.__reset=function(e){this.__super(e);this.__umi=e.umi||"";this.__dispatcher=e.dispatcher;this.__composites=e.composite||a;this._$batEvent({onshow:this.__onShow._$bind(this),onhide:this.__onHide._$bind(this),onrefresh:this.__onRefresh._$bind(this),onmessage:this.__onMessage._$bind(this),onbeforehide:this.__onBeforeHide._$bind(this)})};d.__destroy=function(){this.__super();this.__export={};delete this.__umi;delete this.__composites;delete this.__dispatcher};d.__stop=function(e){if(e)e.stopped=!0};d.__doBuild=r;d.__onBeforeHide=r;d.__doClearComponentExDsp=function(){var e=function(e){return!!s._$$Dispatcher&&e instanceof s._$$Dispatcher};return function(){this.__doClearComponent(e)}}();d.__onMessage=r;d.__doSendMessage=function(e,t,i){this.__dispatcher._$message({to:e,mode:i||0,data:t,from:this.__umi})};d.__doPublishMessage=function(e,t){this.__dispatcher._$publish(e,{from:this.__umi,data:t})};d.__doSubscribeMessage=function(){this.__dispatcher._$subscribe.apply(this.__dispatcher,arguments)};d._$getExportData=function(){return this.__export};d.__doParseParent=function(e){var t;if(!t){var n=e.input||a;t=i._$get(n.parent)}if(!t){var n=e.data||a;t=i._$get(n.parent)}if(!t)t=i._$get(e.parent);return t};d.__onShow=function(e){var t=this.__doParseParent(e);if(t&&this.__body)t.appendChild(this.__body);this.__doApplyComposite("onshow",e);this.__onRefresh(e)};d.__onRefresh=function(e){this.__doApplyComposite("onrefresh",e)};d.__onHide=function(){this.__doHideComposite();i._$removeByEC(this.__body)};d.__isEscapedComposite=function(){var e=/^onshow|onrefresh|delay$/;return function(t){return e.test(t)}}();d.__doGenCompositeParam=r;d.__doApplyComposite=function(){var e=function(e,t,i,n){if(!this.__isEscapedComposite(n)){if(e)i+=(i.indexOf("?")>1?"&":"?")+e;var o=this.__doGenCompositeParam(n,t)||{};o.location=t;o.parent=this.__export[n];this.__dispatcher._$redirect(i,{input:o})}};return function(t,i){if(!i.nodelay){if(this.__composites.delay)return;var o=this.__composites[t]||a;if(o.delay)return}var s=n._$object2query(i.param)||"";if("onrefresh"==t)n._$loop(this.__composites,e._$bind(this,s,i));n._$loop(o,e._$bind(this,s,i))}}();d.__doHideComposite=function(){var e=function(e,t){if(!this.__isEscapedComposite(t))this.__dispatcher._$hide(e)};return function(){n._$loop(this.__composites,e,this);n._$loop(this.__composites.onshow,e,this);n._$loop(this.__composites.onrefresh,e,this)}}();_._$regist=function(){var e;_._$dumpModules=function(){if(e){n._$loop(e,function(e,t){dispatcher._$loaded(t,e)});e=null}};return function(t,i){if(window.dispatcher)dispatcher._$loaded.apply(dispatcher,arguments);else{if(!e)e={};e[t]=i}}}();if(!0){e.P("nej.e")._$regist=_._$regist;e.P("nej.ut")._$$Module=_._$$ModuleAbstract;e.P("nej.ut")._$$AbstractModule=_._$$ModuleAbstract}return _},41,15,17,1,60,12);I$(28,function(e,t,i,n,o,s,_,a){_._$$Module=e._$klass();a=_._$$Module._$extend(s._$$ModuleAbstract);a.__doBuild=function(){this.__super();var e=o._$getTextTemplate(this.__tid);if(!e)this.__body=t._$create("div");else this.__body=t._$html2node(e)};a.__init=function(e){this.__super(e)};a.__onRefresh=function(e){this.__super(e)};a.__onShow=function(e){this.__super(e)};a.__onHide=function(){this.__doClearDomEvent();this.__super()};_._$regist=s._$regist._$bind(s)},15,17,1,16,2,65);I$(156,function(e,t,i,n,o,s,_){var a;n._$$Item=t._$klass();a=n._$$Item._$extend(i._$$Abstract);a.__init=function(){this.__id=this.__genId();this.__super()};a.__reset=function(e){this.__super(e);this.__index=e.index;this.__total=e.total;this.__range=e.range;this._$refresh(e.data)};a.__destroy=function(){this.__super();delete this.__data;delete this.__index;delete this.__total;delete this.__range};a.__doRefresh=s;a.__genId=function(){var e=+new Date;return function(){return"itm-"+ ++e}}();a._$getId=function(){return this.__id};a._$getData=function(){return this.__data};a._$refresh=function(e){this.__data=e||{};this.__doRefresh(this.__data)};if(!0)e.copy(e.P("nej.ui"),n);return n},41,15,72);I$(122,function(e,t,i,n,o,s,_){var a;n._$$ListItem=t._$klass();a=n._$$ListItem._$extend(i._$$Item);a.__reset=function(e){this.__pkey=e.pkey||"id";this.__prefix=e.prefix||"";this.__super(e)};a.__onDelete=function(e){this._$dispatchEvent("ondelete",{ext:e,id:this._$getId(),data:this._$getData(),body:this._$getBody()})};a.__onUpdate=function(e){this._$dispatchEvent("onupdate",{ext:e,id:this._$getId(),data:this._$getData(),body:this._$getBody()})};a._$refresh=function(e){this.__super(e);var t=this.__data[this.__pkey];this.__id=this.__prefix+t||this.__genId()};if(!0)e.copy(e.P("nej.ui"),n);return n},41,15,156);I$(178,".#<uispace>{font-size:12px;line-height:160%;}\n.#<uispace> a{margin:0 2px;padding:2px 8px;color:#333;border:1px solid #aaa;text-decoration:none;}\n.#<uispace> .js-disabled{cursor:default;}\n.#<uispace> .js-selected{cursor:default;background-color:#bbb;}");I$(158,function(e,t,i,n,o,s,_,a,r,c,d){var l;a._$$AbstractPager=t._$klass();l=a._$$AbstractPager._$extend(o._$$Abstract);l.__reset=function(e){this.__bopt=n._$merge({},e);this.__popt=n._$merge({},e);delete this.__bopt.onchange;this.__popt.onchange=this.__onChange._$bind(this);this.__super(e);this.__doResetNumber(e)};l.__destroy=function(){if(this.__page){this.__page._$recycle();delete this.__page}this.__super();delete this.__bopt;delete this.__popt;this._$unbind();this.__body.innerHTML="&nbsp;"};l.__initXGui=function(){var e=i._$pushCSSText(_);return function(){this.__seed_css=e}}();l.__doResetNumber=function(e){var t=e.label||r;if(!e.noprv){this.__popt.pbtn=i._$create("a","zbtn zprv",this.__body);this.__popt.pbtn.innerHTML=t.prev||"上一页"}var n=[];for(var o=1,s=e.number;o<=s;o++)n.push(i._$create("a","zpgi zpg"+o,this.__body));this.__popt.list=n;if(!e.nonxt){this.__popt.nbtn=i._$create("a","zbtn znxt",this.__body);this.__popt.nbtn.innerHTML=t.next||"下一页"}};l.__onChange=function(e){if(!this.__flag){var t=e.index,i=e.total;this.__flag=!0;this._$updatePage(t,i);n._$forEach(this.__binders,function(e){e._$updatePage(t,i)});this.__flag=!1;this._$dispatchEvent("onchange",e)}};l._$bind=function(e){e=i._$get(e);if(e){var t=n._$merge({},this.__bopt);t.parent=e;t.index=this._$getIndex();t.total=this._$getTotal();var o=this.constructor._$allocate(t);o._$setEvent("onchange",this.__popt.onchange);if(!this.__binders)this.__binders=[];this.__binders.push(o)}};l._$unbind=function(){var e=function(e,t,i){e._$recycle();i.splice(t,1)};return function(){n._$reverseEach(this.__binders,e)}}();l._$setIndex=function(e){if(this.__page)this.__page._$setIndex(e)};l._$getIndex=function(){if(!this.__page)return 1;else return this.__page._$getIndex()};l._$getTotal=function(){if(!this.__page)return 1;else return this.__page._$getTotal()};l._$updatePage=function(e,t){if(this.__page)this.__page._$updatePage(e,t)};l._$updateTotal=function(e){if(this.__page)this.__page._$updateTotal(e)};if(!0)e.copy(e.P("nej.ui"),a);return a},41,15,17,1,72,18,178);I$(180,function(e,t,i,n,o,s,_,a,r,c){var d;_._$$PageAbstract=t._$klass();d=_._$$PageAbstract._$extend(s._$$EventTarget);d.__reset=function(e){this.__super(e);this.__pbtn=e.pbtn;this.__nbtn=e.nbtn;this.__sbtn=e.sbtn;this.__ebtn=e.ebtn;this.__name=e.event||"click";this.__parented=!!e.parented;this.__selected=e.selected||"js-selected";this.__disabled=e.disabled||"js-disabled";this.__doPageListCheck(e.list);this.__limit=e.limit||1/0;this._$updatePage(e.index||1,e.total||1)};d.__destroy=function(){this.__super();delete this.__list;delete this.__name;delete this.__pbtn;delete this.__nbtn;delete this.__sbtn;delete this.__ebtn;delete this.__last;delete this.__total;delete this.__index;delete this.__extdata;delete this.__selected;delete this.__disabled};d.__getSelectNode=function(e){return!this.__parented?e:e.parentNode};d.__doPageListCheck=function(){var e=function(e){this.__list.push(e);this.__doInitDomEvent([[e,this.__name,this.__onClick._$bind2(this,0)]])};return function(t){this.__list=[];this.__doInitDomEvent([[this.__pbtn,"click",this.__onClick._$bind2(this,-1)],[this.__nbtn,"click",this.__onClick._$bind2(this,1)],[this.__sbtn,"click",this.__onClick._$bind2(this,-2)],[this.__ebtn,"click",this.__onClick._$bind2(this,2)]]);i._$forEach(t,e,this)}}();d.__doSetNodeIndex=function(e,t){var i=this.__getSelectNode(e);if(null==t){e.innerText="";n._$setStyle(e,"display","none");n._$delClassName(i,this.__selected)}else{e.innerText=t;n._$setStyle(e,"display","");t==this.__index?n._$addClassName(i,this.__selected):n._$delClassName(i,this.__selected)}};d.__doSyncBtnState=function(){if(this.__index<=1){n._$addClassName(this.__pbtn,this.__disabled);n._$addClassName(this.__sbtn,this.__disabled)}else{n._$delClassName(this.__pbtn,this.__disabled);n._$delClassName(this.__sbtn,this.__disabled)}if(this.__index>=this.__total){n._$addClassName(this.__nbtn,this.__disabled);n._$addClassName(this.__ebtn,this.__disabled)}else{n._$delClassName(this.__nbtn,this.__disabled);n._$delClassName(this.__ebtn,this.__disabled)}};d.__doRefreshPage=r;d.__doChangeIndex=function(){this.__doRefreshPage();this.__doSyncBtnState();this._$dispatchEvent("onchange",{last:this.__last,total:this.__total,index:this.__index,ext:this.__extdata})};d.__doSaveIndex=function(e){e=parseInt(e);if(isNaN(e)||null==this.__total)return!1;e=Math.max(1,Math.min(e,this.__total));this.__last=this.__index;this.__index=e;return!0};d.__doSaveTotal=function(e){e=parseInt(e);if(isNaN(e)||e<1)return!1;this.__total=Math.min(e,this.__limit);return!0};d.__onClick=function(e,t){o._$stopDefault(e);var i=o._$getElement(e),s=n._$hasClassName(this.__getSelectNode(i),this.__selected),_=n._$hasClassName(i,this.__disabled);
if(i&&!s&&!_){var a=i.innerText;switch(t){case 1:case-1:a=this.__index+t;break;case 2:a=this.__total;break;case-2:a=1}this._$setIndex(a)}};d._$getIndex=function(){return this.__index};d._$setIndex=function(e){var t=this.__index;this.__doSaveIndex(e);if(t!=this.__index)this.__doChangeIndex()};d._$getTotal=function(){return this.__total};d._$setTotal=function(e){if(this.__doSaveTotal(e)&&null!=this.__index){this.__index=1;this.__doChangeIndex()}};d._$updateTotal=function(e){if(this.__doSaveTotal(e)){this.__doRefreshPage();this.__doSyncBtnState()}};d._$updatePage=function(e,t){if(this.__doSaveTotal(t)&&this.__doSaveIndex(e))this.__doChangeIndex()};if(!0)e.P("nej.ut")._$$AbstractPage=_._$$PageAbstract;return _},41,15,1,17,16,60);I$(159,function(e,t,i,n,o,s,_,a,r){var c;s._$$PageFragment=t._$klass();c=s._$$PageFragment._$extend(o._$$PageAbstract);c.__init=function(){this.__ndot=[];this.__super()};c.__destroy=function(){this.__super();this.__doRecycleDotNode()};c.__doRecycleDotNode=function(){var e=function(e,t,n){i._$remove(e);n.splice(t,1)};return function(){n._$reverseEach(this.__ndot,e)}}();c.__doRefreshPage=function(){this.__extdata={last:!1,first:!1,list:this.__list};this.__doRecycleDotNode();this.__doSetNodeIndex(this.__list[0],1);var e=1,t=this.__list.length;if(!(this.__total<t)){if(this.__index>1){var n=Math.floor((t-2)/2),o=this.__total-t+2,s=Math.max(2,this.__index-n);if(this.__total>=t)s=Math.min(s,o);if(s>2){var _=i._$create("span","zdot");this.__ndot.push(_);_.innerText="...";this.__list[0].insertAdjacentElement("afterEnd",_);this.__extdata.first=!0}for(var a;;e++){a=s+e-1;if(a>this.__index)break;this.__doSetNodeIndex(this.__list[e],a)}}if(this.__index<this.__total){var a,s=this.__index+1;for(var r=0,c=t-2;;r++,e++){a=s+r;if(e>c||a>this.__total)break;this.__doSetNodeIndex(this.__list[e],a)}if(a<this.__total){var _=i._$create("span","zdot");this.__ndot.push(_);_.innerText="...";this.__list[e].insertAdjacentElement("beforeBegin",_);this.__extdata.last=!0}if(a<=this.__total)this.__doSetNodeIndex(this.__list[e++],this.__total)}for(;e<t;e++)this.__doSetNodeIndex(this.__list[e])}else for(var d;e<t;e++){d=e+1;this.__doSetNodeIndex(this.__list[e],d>this.__total?null:d)}};if(!0)e.P("nej.ut")._$$Page=s._$$PageFragment;return s},41,15,17,1,180);I$(123,function(e,t,i,n,o,s,_,a,r){var c;s._$$Pager=t._$klass();c=s._$$Pager._$extend(n._$$AbstractPager);c.__reset=function(e){e.number=parseInt(e.number)||9;this.__super(e);this.__page=o._$$PageFragment._$allocate(this.__popt)};c.__onChange=function(e){if(this.__bopt.noend){var t=e.ext||_,n=t.list||r;if(t.last)i._$setStyle(n[n.length-1],"display","none")}this.__super(e)};if(!0)e.copy(e.P("nej.ui"),s);return s},41,15,17,158,159);I$(71,function(e,t,i,n,o,s,_,a,r,c,d,l,u,f,h){var m;l._$$ListModule=t._$klass();m=l._$$ListModule._$extend(a._$$EventTarget);m.__reset=function(e){this.__ropt={};this.__super(e);this.__lbox=o._$get(e.parent);this.__iopt={parent:this.__lbox};this.__limit=parseInt(e.limit)||10;this.__first=parseInt(e.first)||this.__limit;this.__doResetTemplate(e.item);this.__doResetCache(e.cache||u);this.__doResetPager(e.pager||u);this._$refresh()};m.__destroy=function(){this._$dispatchEvent("onbeforerecycle");this.__doClearListBox();this.__super();if(this.__ropt.clear)this.__cache._$clearListInCache(this.__ropt.key);this.__cache._$recycle();if(this.__pager){this.__pager._$recycle();delete this.__pager}delete this.__pkls;delete this.__popt;delete this.__pulling;delete this.__cache;delete this.__lbox;delete this.__ikls;delete this.__iopt;delete this.__iext;delete this.__ropt};m.__getItemBodyId=function(e){return this.__getItemId(e)+r._$seed()};m.__getItemId=function(e){var t=(this.__iopt||u).prefix||"";return t+e};m.__getPageInfo=function(e,t,i,n){var o={index:1,total:1};if(t>=e)o.index=Math.floor((t-e)/i)+2;if(n>e)o.total=Math.ceil((n-e)/i)+1;return o};m.__doResetJSTTemplate=function(e){delete this.__ikls;this.__ikey=e;this.__doInitDomEvent([[this.__lbox,"click",this.__onCheckAction._$bind(this)]])};m.__doResetTemplate=function(e){if(!i._$isString(e)){i._$merge(this.__iopt,e);this.__iext=i._$merge({},e,function(e){return!i._$isFunction(e)});var t=this.__iopt.klass;delete this.__iopt.klass;if(!i._$isString(t)){delete this.__ikey;this.__ikls=t;this.__iopt.ondelete=this._$dispatchEvent._$bind(this,"ondelete");this.__iopt.onupdate=this._$dispatchEvent._$bind(this,"onupdate")}else this.__doResetJSTTemplate(t)}else this.__doResetJSTTemplate(e)};m.__doResetCache=function(e){var t=e.klass,n=i._$merge({},e);this.__ropt.key=n.lkey;this.__ropt.ext=n.ext;this.__ropt.data=n.data||{};this.__ropt.clear=!!n.clear;this.__iopt.pkey=n.key||"id";n.onerror=this._$dispatchEvent._$bind(this,"onerror");n.onlistload=this.__cbListLoad._$bind(this);n.onpullrefresh=this.__cbPullRefresh._$bind(this);if(t&&"onlistchange"in t)this.__doInitDomEvent([[t,"listchange",this.__cbListChange._$bind(this)]]);else{n.onitemadd=this.__cbItemAdd._$bind(this);n.onitemdelete=this.__cbItemDelete._$bind(this);n.onitemupdate=this.__cbItemUpdate._$bind(this)}this.__cache=(t||d._$$CacheList)._$allocate(n);if(null!=e.total)this.__cache._$setTotal(this.__ropt.key,e.total);if(e.list)this.__cache._$setListInCache(this.__ropt.key,e.list)};m.__doResetPager=function(e){this.__pkls=e.klass||_._$$Pager;this.__popt=i._$merge({},e);if(i._$isArray(e.parent)){this.__popt.parent=e.parent[0];this.__pbid=e.parent.slice(1);if(!this.__pbid||!this.__pbid.length)delete this.__pbid}delete this.__popt.klass};m.__doClearListBox=function(){var e=/^(?:table|tr|tbody|ul|ol|select)$/i;return function(){this._$dispatchEvent("onbeforelistclear",{parent:this.__lbox});if(this.__items&&this.__items.length>0){this.__items=this.__ikls._$recycle(this.__items);delete this.__items}if(e.test(this.__lbox.tagName))o._$clearChildren(this.__lbox);else this.__lbox.innerHTML=""}}();m.__doSwitchPagerShow=function(e){if(!this.__popt.fixed){o._$setStyle(this.__popt.parent,"display",e);i._$forEach(this.__pbid,function(t){o._$setStyle(t,"display",e)},this)}};m.__doRefreshByPager=function(){var e=this.__popt.index||1;delete this.__popt.index;if(this.__pager)e=this.__pager._$getIndex();this.__doChangePage({last:e,index:e})};m.__doChangePage=function(e){this._$dispatchEvent("onpagechange",e)};m.__doChangeOffset=function(e){this.__ropt.offset=e;this.__doLoadList()};m.__doGenRequestOpt=function(e){return e};m.__doLoadList=function(){this.__doBeforeListLoad();var e=this.__ropt.data;e.offset=this.__ropt.offset;var t=0==e.offset;e.total=t;this.__ropt.limit=t?this.__first:this.__limit;e.limit=this.__ropt.limit;this.__cache._$getList(this.__doGenRequestOpt(i._$merge({},this.__ropt)))};m.__cbListLoad=function(e){if(e.key==this.__ropt.key&&e.offset==this.__ropt.offset){this.__doBeforeListShow();var t=this.__cache._$getListInCache(e.key);if(!t||!t.length){if(!this._$cache()._$isLoaded(e.key))this._$dispatchEvent("onlistloaderror",{parent:this.__lbox});else this.__doShowEmpty();return!0}var i=e.limit,n=e.offset;if(!this.__cache._$isFragmentFilled(e.key,n,i)){this._$dispatchEvent("onlistloaderror",{parent:this.__lbox});return!0}if(!this.__doBeforeListRender(t,n,i)){this._$dispatchEvent("onbeforelistrender",{list:t,limit:i,offset:n,parent:this.__lbox,total:this.__cache._$getTotal(e.key)});if(this.__ikey){this.__iopt.xlist=t;this.__iopt.beg=n;this.__iopt.end=Math.min(t.length,n+i)-1;this.__iopt.act="list";var o=r._$get(this.__ikey,this.__iopt,this.__iext);this.__doShowListByJST(o)}else{this.__iopt.limit=i;this.__iopt.offset=n;var s=c._$getItemTemplate(t,this.__ikls,this.__iopt);this.__doShowListByItem(s)}this._$dispatchEvent("onafterlistrender",{list:t,limit:i,offset:n,parent:this.__lbox,total:this.__cache._$getTotal(e.key)})}}};m.__cbPullRefresh=function(e){if(this.__pulling){delete this.__pulling;this.__doBeforeListShow("onafterpullrefresh");this._$refresh()}};m.__doSyncPager=function(e,t){if(this.__pager){if((this.__popt||u).limit>0)t=Math.min(t,this.__popt.limit);var n=this.__pager._$getIndex(),o=this.__pager._$getTotal();if(n>t||t!=o){this.__pager._$recycle();delete this.__pager;this.__doChangePage({last:n,index:Math.min(e,t)});return!0}}else{this.__popt.index=e;this.__popt.total=t;this.__pager=this.__pkls._$allocate(this.__popt);this.__pager._$setEvent("onchange",this.__doChangePage._$bind(this));i._$forEach(this.__pbid,function(e){this.__pager._$bind(e)},this)}};m.__doFormatData=function(){var e=+new Date;return function(t){var i=t[this.__iopt.pkey];if(!i){t["dirty-data"]=!0;t[this.__iopt.pkey]="dirty-"+e++}return t}}();m.__doSplitDirty=function(e){var t=e[this.__iopt.pkey];if(e["dirty-data"]){delete e["dirty-data"];delete e[this.__iopt.pkey]}return t};m.__doInsertOneItem=function(){var e=function(e,t){this.__lbox.insertAdjacentElement(e,t)};return function(t,n){var o=[n];if(this.__ikey){var o=this.__cache._$getListInCache(this.__ropt.key),s=i._$indexOf(o,n);if(s<0){s=0;o=[n]}this.__iopt.xlist=o;this.__iopt.beg=s;this.__iopt.end=s;this.__iopt.act="add";this.__doShowListByJST(r._$get(this.__ikey,this.__iopt,this.__iext),t)}else{this.__iopt.limit=1;this.__iopt.offset=0;this.__iopt.parent=e._$bind(this,t);var _=c._$getItemTemplate(o,this.__ikls,this.__iopt);this.__iopt.parent=this.__lbox;this.__doShowListByItem(_)}this._$dispatchEvent("onafterinsert")}}();m.__doBeforeListLoad=f;m.__doBeforeListShow=function(e){var t={parent:this.__lbox};this._$dispatchEvent(e||"onafterlistload",t);if(!t.stopped)o._$removeByEC(this.__ntip)};m.__doBeforeListRender=f;m.__doRenderMessage=function(e,t){if(i._$isString(e)){if(!this.__ntip)this.__ntip=o._$create("div");this.__ntip.innerHTML=e}else this.__ntip=e;this.__lbox.insertAdjacentElement(t||"beforeEnd",this.__ntip)};m.__doShowMessage=function(e,t,i){var n={parent:this.__lbox};if(e)this._$dispatchEvent(e,n);if(!n.stopped)this.__doRenderMessage(n.value||t,i)};m.__doShowEmpty=f;m.__doShowListByJST=f;m.__doShowListByItem=f;m.__onCheckAction=function(){var e=/^(?:delete|update)$/;return function(t){var i=n._$getElement(t,"d:action");if(i){var s=o._$dataset(i,"action");
if(e.test(s)){var _=o._$dataset(i,"id");if(_){var a=this.__cache._$getItemInCache(_);if(a){n._$stop(t);this._$dispatchEvent("on"+s,{data:a,id:a[this.__iopt.pkey],body:o._$get(this.__getItemBodyId(_))})}}}}}}();m.__cbItemAdd=f;m.__doDeleteItem=function(e){var t=e.data||{},i={data:t,key:this.__ropt.key,id:t[this.__iopt.pkey]};this._$dispatchEvent("onbeforedelete",i);this.__cache._$deleteItem(i)};m.__cbItemDelete=f;m.__doUpdateItem=function(e){var t=e.data||{},i={data:t,key:this.__ropt.key};this._$dispatchEvent("onbeforeupdate",i);this.__cache._$updateItem(i)};m.__cbItemUpdate=function(e){this.__doCheckResult(e,"onafterupdate");if(!e.stopped){var t=e.data[this.__iopt.pkey];if(this.__items){var n=c._$getItemById(this.__getItemId(t));if(n)n._$refresh(e.data)}else{var s=this._$getItemBody(t);if(!s)return;var _=this.__cache._$getListInCache(e.key),a=i._$indexOf(_,e.data);if(a<0)return;this.__iopt.xlist=_;this.__iopt.beg=a;this.__iopt.end=a;this.__iopt.act="update";var d=r._$get(this.__ikey,this.__iopt,this.__iext);s.insertAdjacentHTML("afterEnd",d);o._$remove(s)}this._$dispatchEvent("onafterupdaterender",{data:e.data,parent:this.__lbox})}};m.__doCheckResult=function(e,t){var i=e.data;if(!i||null==i[this.__iopt.pkey]){this._$dispatchEvent("onerror",e);e.stopped=!0}if(!e.stopped)this._$dispatchEvent(t,e)};m.__cbAppendList=f;m.__cbUnshiftList=f;m.__cbListChange=function(e){if(e.key==this.__ropt.key)switch(e.action){case"add":this.__cbItemAdd(e);break;case"delete":this.__cbItemDelete(e);break;case"update":this.__cbItemUpdate(e);break;case"refresh":this._$refresh();break;case"unshift":this.__cbUnshiftList(e.offset,e.limit);break;case"append":this.__cbAppendList(e.offset,e.limit)}};m._$update=function(e){this.__doUpdateItem({data:e})};m._$delete=function(e){this.__doDeleteItem({data:e})};m._$add=function(e){this.__cache._$addItem({data:e,key:this.__ropt.key})};m._$cache=function(){return this.__cache};m._$unshift=function(e){this.__doInsertOneItem("afterBegin",this.__doFormatData(e));return this.__doSplitDirty(e)};m._$append=function(e){this.__doInsertOneItem("beforeEnd",this.__doFormatData(e));return this.__doSplitDirty(e)};m._$refresh=function(){this.__doClearListBox();this.__doRefreshByPager()};m._$refreshWithClear=function(){this.__cache._$clearListInCache(this.__ropt.key);this._$refresh()};m._$pullRefresh=function(){if(!this.__pulling){this.__pulling=!0;this.__doShowMessage("onbeforepullrefresh","列表刷新中...","afterBegin");this.__cache._$pullRefresh({key:this.__ropt.key,data:this.__ropt.data})}};m._$getTotal=function(){return this.__cache._$getTotal(this.__ropt.key)};m._$getPager=function(){return this.__pager};m._$items=function(){return this.__items};m._$getItemBody=function(e){if(this.__ikey)return o._$get(this.__getItemBodyId(e));else{var t=c._$getItemById(this.__getItemId(e));if(t)return t._$getBody()}};m._$isLoaded=function(){return this.__cache._$isLoaded(this.__ropt.key)};m._$showMessage=function(e){this.__doClearListBox();this.__doShowMessage(null,e)};m._$nextPage=function(){if(this.__pager){var e=this.__pager._$getIndex()+1,t=this.__pager._$getTotal();e=Math.max(1,Math.min(e,t));this._$pageTo(e);return e<t}};m._$prevPage=function(){if(this.__pager){var e=this.__pager._$getIndex()-1,t=this.__pager._$getTotal();e=Math.max(1,Math.min(e,t));this._$pageTo(e);return e<=1}};m._$pageTo=function(e){if(this.__pager){var t=this.__pager._$getTotal();e=Math.max(1,Math.min(e,t));this.__pager._$setIndex(e)}};if(!0)e.copy(e.P("nej.ut"),l);return l},41,15,1,16,17,122,123,60,18,2,124);I$(19,function(e,t,i,n,o,s,_,a,r,c,d){var l;a._$$ListModuleWF=t._$klass();l=a._$$ListModuleWF._$extend(_._$$ListModule);l.__reset=function(e){this.__doResetMoreBtn(e.more);this.__sbody=n._$get(e.sbody);this.__doInitDomEvent([[this.__sbody,"scroll",this.__onCheckScroll._$bind(this)]]);var t=e.delta;if(null==t)t=30;this.__delta=Math.max(0,t);var i=parseInt(e.count)||0;this.__count=Math.max(0,i);var o=parseInt(e.number)||0;if(o>1&&o<=i)this.__number=o;this.__super(e)};l.__destroy=function(){this.__super();delete this.__nmore;delete this.__sbody;delete this.__endskr;delete this.__nexting};l.__getPageInfo=function(e,t){var i=this.__first+(this.__count-1)*this.__limit,n=this.__count*this.__limit;return this.__super(i,e,n,t)};l.__doResetMoreBtn=function(e){this.__nmore=n._$get(e);this.__doInitDomEvent([[this.__nmore,"click",this._$next._$bind(this)]])};l.__doCheckScroll=function(e){if(!this.__endskr&&e&&this.__lbox.clientHeight){if(!e.scrollHeight)e=n._$getPageBox();var t=n._$offset(this.__lbox,this.__sbody),i=t.y+this.__lbox.offsetHeight-e.scrollTop-e.clientHeight,o=e.scrollHeight<=e.clientHeight;if(i<=this.__delta||o&&!this.__endskr)window.setTimeout(this._$next._$bind(this),0)}};l.__onCheckScroll=function(e){if(!this.__endskr){var t=i._$getElement(e);if(!t)t=n._$getPageBox();this.__doCheckScroll(t)}};l.__doChangePage=function(e){this.__super(e);if(!e.stopped){this.__doClearListBox();var t=0;if(e.index>1)t=this.__first+((e.index-1)*this.__count-1)*this.__limit;this.__offset=t;this._$next()}};l.__doGenRequestOpt=function(e){if(this.__number){var t=e.offset>0?this.__limit:this.__first,i=t+this.__limit*(this.__number-1);this.__offset=e.offset+i;e.data.limit=i;e.limit=i;delete this.__number}return e};l.__cbListLoad=function(e){delete this.__nexting;if(!this.__super(e))this._$resize()};l.__cbListChange=function(e){if(!e.key||e.key==this.__ropt.key){switch(e.action){case"refresh":case"append":delete this.__nexting}this.__super(e)}};l.__doBeforeListLoad=function(){this.__doShowMessage("onbeforelistload","");n._$setStyle(this.__nmore,"display","none")};l.__doBeforeListRender=function(e,t,i){var o=e.length,s=e.loaded?t+i>=o:t+i>o;this.__offset=Math.min(this.__offset,o);n._$setStyle(this.__nmore,"display",s?"none":"");if(s)this.__endskr=!0;if(this.__count>0){var _=this.__getPageInfo(t,e.length);if(this.__doSyncPager(_.index,_.total))return!0;var a=this.__first-this.__limit,r=this.__count*this.__limit;this.__endskr=(t+i-a)%r==0||s;n._$setStyle(this.__nmore,"display",this.__endskr?"none":"");this.__doSwitchPagerShow(this.__endskr&&_.total>1?"":"none")}};l.__doShowEmpty=function(){this.__offset=0;this.__endskr=!0;this.__doShowMessage("onemptylist","没有列表数据！")};l.__doShowListByJST=function(e,t){this.__lbox.insertAdjacentHTML(t||"beforeEnd",e)};l.__doShowListByItem=function(e){this.__items=this.__items||[];if(o._$isArray(e))d.push.apply(this.__items,e);else this.__items.push(e)};l.__cbItemAdd=function(e){n._$removeByEC(this.__ntip);this.__doCheckResult(e,"onafteradd");var t=e.flag;if(!e.stopped&&t)if(!(this.__count>0)){this.__offset+=1;t==-1?this._$unshift(e.data):this._$append(e.data)}else this.__doRefreshByPager()};l.__cbItemDelete=function(e){this.__doCheckResult(e,"onafterdelete");if(!e.stopped)if(!(this.__count>0)){var t=e.data[this.__iopt.pkey];if(this.__items){var i=s._$getItemById(this.__getItemId(t)),_=o._$indexOf(this.__items,i);if(_>=0){this.__items.splice(_,1);this.__offset-=1}if(i)i._$recycle()}else{var a=this._$getItemBody(t);if(a)this.__offset-=1;n._$remove(a)}if(this.__offset<=0)this._$next()}else this.__doRefreshByPager()};l.__cbAppendList=function(e,t){if(e==this.__offset)if(this._$isLoaded()){this.__endskr=!1;this._$resize()}};l.__cbUnshiftList=function(e,t){if(0==e){var i=this.__cache._$getListInCache(this.__ropt.key);for(var n=t-1;n>=0;n--)this._$unshift(i[n])}};l._$resize=function(){var e=this.__sbody;if(e&&!this.__endskr)this.__doCheckScroll(this.__sbody)};l._$refresh=function(){delete this.__endskr;this.__super()};l._$next=function(){if(!this.__nexting){this.__nexting=!0;var e=this.__offset;this.__offset+=0==e?this.__first:this.__limit;this.__doChangeOffset(e)}};if(!0)e.copy(e.P("nej.ut"),a);return a},41,15,16,17,1,2,71);I$(36,function(e,t,i,n,o,s,_,a,r,c){window.ysfCache=window.ysfCache||{};r._$$Cache=e._$klass();c=r._$$Cache._$extend(a._$$Cache);a._$config({"ses-online":{method:"POST",url:"/webapi/user/platform/session.action",format:function(e,i){var n=e.result,o=this._$getListInCache("ses-online");this.__parseSessionList(n);this.__pushLastMessage(n);t._$forEach(n,function(e){if(203==e.sessionStatus.status)_._$$instrance._$doCheckQueue(e.shop.id)});e.result={list:n,total:n.length}}}});c.__init=function(){var e=!1;return function(n){if(!e){e=!0;t._$loop({onsession:this.__onAddSession._$bind(this),onsessionchange:this.__onSessionChange._$bind(this),onmessage:this.__cbReceiveMessage._$bind(this),ontransferresult:this.__cbTransferResult._$bind(this),onevaluate:this.__cbEvaluate._$bind(this),onsendleavemsg:this.__cbSendLeaveMsg._$bind(this)},function(e,t){i._$addEvent(_._$$EventBus,t,e)});t._$loop({receivemessage:this.__cbReceiveMessage._$bind(this),clearunreadmsg:this.__cbClearUnreadMsg._$bind(this)},function(e,t){_._$$instrance._$addEvent(t,e)})}this.__super(n)}}();c.__doFormatItem=function(e){return e};c.__parseSessionList=function(e){var i=this;t._$forEach(e,function(e){var n=e.shop.id,o=e.id;s._$transform(o,n);i.__parseSessionItem(e);t._$merge(e.kefu,{isKefu:1});e.client=e.client||{};e.lastMessage=e.lastMessage||{};t._$merge(e.client,{isKefu:0})})};c.__pushLastMessage=function(e){t._$forEach(e,function(e){if(201!=e.sessionStatus.status&&203!=e.sessionStatus.status)e.lastMessage.content="[您正在和"+e.kefu.staffname+"对话]"},this)};c.__parseSessionItem=function(e){};c.__onAddSession=function(e){if(!this.__checkSessionExist(e.id)){this.__addItem({key:"ses-online"},e);i._$dispatchEvent(this.constructor,"listchange",{key:"ses-online",action:"refresh"})}};c.__onSessionChange=function(e){i._$dispatchEvent(this.constructor,"listchange",{key:"ses-online",action:"refresh"})};c.__doFormatItem=function(e){return e};c.__checkSessionExist=function(e){var t=function(e,t){for(var i=0;i<e.length;i++)if(e[i].id==t)return!0;return!1};var i=this._$getListInCache("ses-online");return t(i,e)};c.__doLoadList=function(e){e.data=e.data||{};t._$merge(e.data,{u:o.__getDeviceID(),k:o.__getAppkey()});this.__doSendRequest("ses-online",e)};c.__cbTransferResult=function(e,t){i._$dispatchEvent(this.constructor,"listchange",{
key:"ses-online",action:"refresh"});this.__updateSessionItem(e)};c.__cbReceiveMessage=function(e){var i=e.sessionid,n=this._$getItemInCache(i);if(s.SHOPID==n.shop.id)_._$$instrance._$clearUnreadMsg(i);if(n){if(n.shop.id!==s.SHOPID&&"finish"!==e.type&&"success"!==e.type&&"overtime"!==e.type&&"transferresult"!==e.type&&"overtimefinish"!==e.type)n.unread++;if("qa-list"==e._type&&"您是想问？"==e.label)e.content=this.__parseSameQuestion(e);t._$merge(n.lastMessage,{content:e.content||e.label,type:e._type||e.type,time:e.time});this.__updateSessionItem(n)}};c.__parseSameQuestion=function(e){var i="[您是想问： ";t._$forEach(e.list,function(e){i=i+" "+e.question+"；"},this);i+="]";return i};c.__cbClearUnreadMsg=function(e){this.__updateSessionItemById(e)};c.__cbEvaluate=function(e){};c.__cbSendLeaveMsg=function(e){var i=s._$getSessionByBid(e);t._$merge(i.lastMessage,{content:"[本次留言发送成功]",time:+(new Date).getTime()});this.__updateSessionItem(i)};c.__updateSessionItem=function(e){i._$dispatchEvent(this.constructor,"listchange",{data:e,action:"update",key:"ses-online"})};c.__updateSessionItemById=function(e){var t=s._$getSessionById(e);if(t)this.__updateSessionItem(t)};r._$do=a._$do._$bind(null,r._$$Cache);n._$$CustomEvent._$allocate({element:r._$$Cache,event:["listchange"]});r._$$instrance=r._$$Cache._$allocate();t._$merge(window.ysfCache,{session:r._$$instrance})},15,1,16,44,27,24,26,81);I$(181,function(e,t,i,n,o,s,_){var a;n._$$Media=t._$klass();a=n._$$Media._$extend(i._$$EventTarget);a.__reset=function(e){this.__state=0;this._$source(e.url);if(null!=e.volume)this._$volume(e.volume);this.__super(e)};a.__destroy=function(){this.__super();this._$stop()};a.__doPlay=s;a.__doPause=s;a.__doStop=s;a.__onStop=function(){this.__doStateChange(4);this.__doStateChange(0)};a.__doError=function(){this.__state=0};a.__setCurrentTime=s;a.__getCurrentTime=s;a.__setVolume=s;a.__getVolume=s;a.__doStateChange=function(e){if(e!=this.__state){this.__state=e;this._$dispatchEvent("onstatechange",{state:this.__state})}};a.__onVolumeChange=function(){this._$dispatchEvent("onvolumechange",{volume:this._$volume()})};a._$duration=s;a._$source=function(e){e=e||"";if(e){this._$stop();this.__source=e}};a._$play=function(){if(0==this.__state||3==this.__state)this.__doPlay()};a._$pause=function(){if(1==this.__state||2==this.__state)this.__doPause()};a._$stop=function(){if(0!=this.__state)this.__doStop()};a._$seek=function(e){if(null!=e)this.__setCurrentTime(e);return this.__getCurrentTime()};a._$volume=function(e){if(null!=e){var e=Math.max(0,Math.min(e,100));this.__setVolume(e/100)}return 100*this.__getVolume()};if(!0)e.copy(e.P("nej,ut"),n);return n},41,15,60);I$(160,function(e,t,i,n,o,s,_){var a;n._$$MediaAudio=t._$klass();a=n._$$MediaAudio._$extend(i._$$Media);a.__reset=function(e){this.__audio=new Audio;this.__doInitDomEvent([[this.__audio,"loadstart",this.__onLoading._$bind(this)],[this.__audio,"timeupdate",this.__onPlaying._$bind(this)],[this.__audio,"pause",this.__onPause._$bind(this)],[this.__audio,"volumechange",this.__onVolumeChange._$bind(this)],[this.__audio,"ended",this.__onStop._$bind(this)],[this.__audio,"error",this.__onError._$bind(this)]]);this.__super(e)};a.__destroy=function(){this.__super();delete this.__audio};a.__doPlay=function(){if(this.__audio.src!=this.__source){this.__audio.src=this.__source;this.__source=this.__audio.src}this.__audio.play()};a.__doPause=function(){this.__audio.pause()};a.__doStop=function(){this.__stopped=!0;this.__doPause();if(3==this.__state)this.__onPause()};a.__onLoading=function(){if(!this.__audio.paused)this.__doStateChange(1)};a.__onPause=function(){var e=!this.__stopped?3:0;this.__stopped=!1;this.__doStateChange(e);if(0==e)this.__audio&&this.__audio.removeAttribute("src")};a.__onPlaying=function(){var e=this.__audio.duration;if(!this.__audio.paused&&!isNaN(e)){this.__doStateChange(2);this._$dispatchEvent("ontimeupdate",{duration:this.__audio.duration,current:this.__audio.currentTime})}};a.__onError=function(e){this.__doError();var t=this.__audio.error;this._$dispatchEvent("onerror",{code:t.code})};a.__setCurrentTime=function(e){if(1!=this.__state)this.__audio.currentTime=e||0};a.__getCurrentTime=function(){return this.__audio.currentTime};a.__setVolume=function(e){this.__audio.volume=e};a.__getVolume=function(){return this.__audio.volume};a._$duration=function(){return!this.__audio?0:this.__audio.duration};if(!0)e.copy(e.P("nej.ut"),n);return n},41,15,181);I$(161,function(e,t,i,n,o){t.__getAudioInst=function(t){return e._$$MediaAudio._$allocate(t)};return t},160);I$(162,function(e,t,i,n,o,s,_,a,r){var c;s._$$MediaFlash=t._$klass();c=s._$$MediaFlash._$extend(o._$$Media);c.__init=function(){var e=function(e){this.__audio=e;if(this.__action){this.__action.call(this);delete this.__action}};return function(){this.__super();n._$flash({hidden:!0,src:i._$get("audio.swf"),onready:e._$bind(this),onended:this.__onStop._$bind(this),onpause:this.__onPause._$bind(this),onseeking:this.__onLoading._$bind(this),onprogress:this.__onLoading._$bind(this),ontimeupdate:this.__onPlaying._$bind(this),onvolumechange:this.__onVolumeChange._$bind(this),onerror:this.__onError._$bind(this)})}}();c.__destroy=function(){this.__super();delete this.__action};c.__doPlay=function(){if(this.__audio){if(this.__source){this.__audio.nej_setSrc(this.__source);delete this.__source}this.__audio.nej_play()}else this.__action=this.__doPlay};c.__doPause=function(){if(this.__audio)this.__audio.nej_pause();else this.__action=this.__doPause};c.__doStop=function(){if(this.__audio){this.__audio.nej_stop();this.__doStateChange(0)}else this.__action=this.__doStop};c.__onLoading=function(){this.__doStateChange(1)};c.__onPause=function(){this.__doStateChange(3)};c.__onPlaying=function(e){this.__doStateChange(2);this._$dispatchEvent("ontimeupdate",{duration:e.duration,current:e.currentTime});if(null!=this.__dtvol){var t=this.__dtvol;delete this.__dtvol;this.__setVolume(t)}};c.__onError=function(e){this.__doError();this._$dispatchEvent("onerror",{code:e.code})};c.__setCurrentTime=function(e){if(1!=this.__state)this.__audio.nej_seek(e||0)};c.__getCurrentTime=function(){return this.__audio.nej_flash_get_currentTime()};c.__setVolume=function(e){if(this.__audio)try{this.__audio.nej_flash_set_volume(e)}catch(t){this.__dtvol=e}else this.__dtvol=e};c.__getVolume=function(){if(this.__audio)return this.__audio.nej_flash_get_volume()};c._$duration=function(){return!this.__audio?0:this.__audio.nej_flash_get_duration()};if(!0)e.copy(e.P("nej.ut"),s);return s},41,15,107,167,181);I$(134,function(e,t,i,n,o,s){if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="4.0")I$(163,function(e){t.__getAudioInst=function(t){return e._$$MediaFlash._$allocate(t)}},162);return t},43,161);I$(84,function(e,t,i,n,o,s,_){n._$audio=function(e){return i.__getAudioInst(e)};n._$play=function(){var e={};var o=function(t,i,n,o){var _=e[t];if(_){var a=_.conf,r=a[i]||s,c=a.extra;if(o)delete e[t];n.data=c;r(n)}};var _=function(e,t){o(e,"onstatechange",{state:t},0==t)};var a=function(e,t){o(e,"onerror",{code:t},!0)};var r=function(e,t){o(e,"ontimeupdate",t)};var c=function(e,t){if(0==t.state)l(e);_(e,t.state)};var d=function(t){var n=e[t];if(n){n.audio=i.__getAudioInst({url:n.url,onerror:u._$bind(null,t),ontimeupdate:r._$bind(null,t),onstatechange:c._$bind(null,t)});n.audio._$play()}};var l=function(t){var i=e[t];if(i){if(i.audio)i.audio=i.audio._$recycle();if(i.timer)i.timer=window.clearTimeout(i.timer)}};var u=function(t,i){var n=e[t];if(n){l(t);var o=n.conf;if(o.retry>0){o.retry--;n.timer=window.setTimeout(d._$bind(null,t),o.interval||500)}else a(t,i.code)}};n._$stop=function(t){var i=e[t||"auto-audio"];if(i)i.audio._$stop()};return function(i,n){if(i){var o=t._$merge({},n),s=o.key||"auto-audio",a=e[s];if(a){l(s);_(s,0)}e[s]={url:i,conf:o};d(s)}}}();if(!0){var a=e.P("nej.e");a._$audio=n._$audio;a._$playBgSound=n._$play;a._$stopBgSound=n._$stop}return n},41,1,134);I$(30,function(e,t,i,n,o,s,_){_._$now=function(){return new Date(+new Date+((setting||{}).delta||0))};_._$datetime=function(e){var t=new Date(e);var n=_._$now();if(t.getFullYear()===n.getFullYear()){if(t.getMonth()===n.getMonth()){var o=n.getDate()-t.getDate();if(1===o)return"昨天"+i._$format(t," HH:mm");else if(0===o)return i._$format(t," HH:mm");else return i._$format(t,"MM-dd HH:mm")}return i._$format(t,"MM-dd HH:mm")}return i._$format(t,"yyyy-MM-dd HH:mm")};_._$getListModuleConfig=function(t){var o=t||{},s=e._$html2node(n._$getTextTemplate("resource-status-empty")),_=e._$html2node(n._$getTextTemplate("resource-status-loading")),a=e._$html2node(n._$getTextTemplate("resource-status-error"));var r=function(t,i){var n=(e._$getByClassName(t,"j-flag")||[])[0];n.innerText=i||""};if(!i._$isFunction(o.onemptylist))o.onemptylist=function(e){e.value=s};else o.onemptylist=o.onemptylist._$aop(function(e){e.args[0].value=s});if(!i._$isFunction(o.onbeforelistload))o.onbeforelistload=function(e){e.value=_};else o.onbeforelistload=o.onbeforelistload._$aop(function(e){e.args[0].value=_});if(!i._$isFunction(o.onlistloaderror))o.onlistloaderror=function(e){r(a);e.value=a};else o.onlistloaderror=o.onlistloaderror._$aop(function(e){r(a);e.args[0].value=a});if(!i._$isFunction(o.onerror))o.onerror=function(e){r(a);this._$showMessage(a)};else{var c=o.onerror;o.onerror=function(e){c.call(this,e);if(!e.stopped){var t=e.content||"错误提示："+(e.data||e.code)+"，"+e.message;r(a,t);this._$showMessage(a)}}}return o};_._$delegate=function(n,o,s){t._$addEvent(o,"click",function(o){try{var _=t._$getElement(o,"action")}finally{if(!_)return;var a=e._$dataset(_,"action"),r=(s||{})[a];if(i._$isFunction(r)){t._$stopDefault(o);r.call(n||this,_,o)}}})};_._$delegateWithStopEvent=function(n,o,s){t._$addEvent(o,"click",function(o){try{var _=t._$getElement(o,"action")}finally{if(!_)return;var a=e._$dataset(_,"action"),r=(s||{})[a];if(i._$isFunction(r))r.call(n||this,_,o)}})}},17,16,1,2,18,84);I$(79,'<textarea name="ntp" id="#<lbBody>">\n  <div class="m-modal m-modal-confirm m-modal-satisfyEva" style="display:none">\n\n      <table>\n          <tbody>\n          <tr>\n              <td class="j-flagmain">\n                  <div class="lywrap j-flag">\n                      <div class="close" data-action="close">\n                          &times;\n                      </div>\n                      <form class="m-form-evaluate j-form">\n                        <h2 class="form_tlt">感谢您的咨询，请对我们的服务做出评价</h2>\n                        <div class="evaWrap j-flaglist"></div>\n                        <div class="form_item itm-remarks">\n                            <textarea placeholder="备注(选填)" name="remarks">&lt/textarea>\n                        </div>\n                        <div class="form_item itm-btn">\n                            <a class="u-btn u-btn-disabled j-formbtn " data-action="submitform">确定</a>\n                        </div>\n                      </form>\n                  </div>\n              </td>\n\t          <td class="m-modal-confirmEva j-flagconfirm" style="display:none">\n\t\t          <div class="modal_dialog">\n\t\t              <div class="modal_hd">\n\t\t                  <h3 class="modal_title">标题</h3>\n\t\t              </div>\n\t\t              <div class="modal_bd">\n\t\t                  <span>是否放弃当前评价,放弃后不可恢复</span>\n\t\t              </div>\n\t\t              <div class="modal_ft">\n\t\t                  <div class="group">\n\t\t                      <a class="u-btn" data-action="confirmok">确定</a>\n\t\t                      <a class="u-btn u-btn-disabled" data-action="confirmclose">取消</a>\n\t\t                  </div>\n\t\t              </div>\n\t\t          </div>\n\t\t      </td>\n\n          </tr>\n          </tbody>\n      </table>\n  </div>\n</textarea>\n\n<textarea name="jst" id="#<lbForm>">\n    <ul class="form_item item-list j-formitm">\n        {list list as x}\n        <li>\n            <label>\n                <div class="itm head">\n                    <img src="${x.img}">\n                </div>\n                <div class="itm choice" data-action="selitem" data-index="${x_index}">\n                    <i class="u-icon-radio {if x.active}active{/if}"></i>\n                    <span>${x.name}</span>\n                    <input type="radio" name="evaluation" value="${x.value}" {if x.active}checked="true"{/if}>\n                </div>\n            </label>\n        </li>\n        {/list}\n    </ul>\n</textarea>');
I$(23,function(e,t,i,n,o,s,_,a,r,c){r._$$EvaluateModal=e._$klass();c=r._$$EvaluateModal._$extend(o._$$Abstract);var d=window.resourceConfig.satisfy;var l={2:{1:d+"s1.png",100:d+"s4.png"},3:{1:d+"s1.png",50:d+"s2.png",100:d+"s3.png"},5:{1:d+"s0.png",25:d+"s1.png",50:d+"s2.png",75:d+"s3.png",100:d+"s4.png"}};c.__init=function(){this.__super()};c.__reset=function(e){var n=i._$getByClassName(this.__container,"j-form")[0],o=e.form.list,s=e.form.type,a=l[s];this.__form=n;this.__formData=e.form;o.forEach(function(e){e.img=a[e.value]});this.__createEvalForm(e.form);t._$addEvent(n["remarks"],"keyup",this.__cbRemarks._$bind(this));r._$delegate(this,this.__body,{close:function(e,t){this.__hideModal(0)},selitem:function(t){var n=i._$dataset(t,"index"),t=i._$getByClassName(this.__container,"j-flaglist")[0];o.forEach(function(e,t){if(t!=n)e.active=0;else e.active=1});this.__cbEvaluation();_._$render(t,this.__seed_modal,e.form);this._$setEvalTypesClassName(e.form.list)},confirmclose:function(){this.__showModal()},confirmok:function(){this.__hideModal(1)},submitform:function(e,t){var i=e.getAttribute("data-flag");if(i&&0!=i){var s=function(e){for(var t=0;t<e.length;t++)if(1==e[t].checked)return parseInt(e[t].value)};var _=function(e){e.forEach(function(e){if(e.value==a.evaluation)a.name=e.name})};var a={evaluation:s(n["evaluation"]),remarks:(n["remarks"].value||"").trim(),id:this.__mid,flag:this.__evalFlag,sid:!this.__evalFlag?this.__sid:null};_(o);this._$dispatchEvent("submit",a);this.__hideModal(1)}}});this.__super(e)};c.__destroy=function(){this.__super()};c.__initXGui=function(){var e=s._$parseUITemplate(a);return function(){this.__seed_html=e.lbBody;this.__seed_modal=e.lbForm}}();c.__initNode=function(){this.__super();var e=i._$getByClassName(this.__body,"j-flag");this.__container=e[0]};c.__hideModal=function(e){var t=this.__form["remarks"].value,n=i._$getByClassName(this.__body,"j-flagmain")[0],o=i._$getByClassName(this.__body,"j-flagconfirm")[0];var s=function(){var e=i._$getByClassName(this.__container,"j-flaglist")[0];this.__form["remarks"].value="";this.__formData.list.forEach(function(e){e.active=0});_._$render(e,this.__seed_modal,this.__formData);this._$setEvalTypesClassName(this.__formData.list);this.__cbEvaluation(1)};if(!t||0!=e){if(1==e){i._$setStyle(n,"display","");i._$setStyle(o,"display","none")}s.call(this);i._$setStyle(this.__body,"display","none")}else{i._$setStyle(n,"display","none");i._$setStyle(o,"display","")}};c.__showModal=function(){var e=i._$getByClassName(this.__body,"j-flagmain")[0],t=i._$getByClassName(this.__body,"j-flagconfirm")[0];i._$setStyle(e,"display","");i._$setStyle(t,"display","none")};c._$showModal=function(e,t,n){this.__evalFlag=e;this.__sid=t;this.__mid=n;i._$setStyle(this.__body,"display","block")};c.__createEvalForm=function(e){var t=i._$getByClassName(this.__container,"j-flaglist")[0];_._$render(t,this.__seed_modal,e);this._$setEvalTypesClassName(e.list)};c.__cbRemarks=function(e){var t=e.target||{value:""},i=t.value.trim().length;if(i>100)t.value=t.value.slice(0,100)};c._$setEvalTypesClassName=function(e){var t={2:"two",3:"three",5:"five"};var n=t[e.length],o=i._$getByClassName(this.__container,"j-formitm")[0];i._$addClassName(o,n)};c.__cbEvaluation=function(e){var t=i._$getByClassName(this.__container,"j-formbtn")[0];if(e){i._$addClassName(t,"u-btn-disabled");i._$attr(t,"data-flag",0)}else{i._$delClassName(t,"u-btn-disabled");i._$attr(t,"data-flag",1)}};r._$delegate=function(e,o,s){t._$addEvent(o,"click",function(o){try{var _=t._$getElement(o,"action")}catch(a){return}if(_){var r=i._$dataset(_,"action"),c=(s||{})[r];if(n._$isFunction(c)){t._$stopDefault(o);c.call(e||this,_,o)}}})}},15,16,17,1,72,2,18,79);I$(85,'<textarea name="ntp" id="#<leaveBody>">\n    <div class="m-leavemessage j-flag">\n    </div>\n</textarea>\n<textarea name="jst" id="#<leaveInfo>">\n    <form class="m-form j-leave-form" id="leaveForm" onsubmit="return false;">\n        <p class="message">${session.message || session.leaveInfo|default:"当前客服不在线，如需帮助请留言~"}</p>\n        <div class="formcnt">\n            {if session.shop.hasMobile || session.hasMobile}\n            <div class="formitm">\n                <label for="lab" class="lab">手机<span class="u-required">&nbsp;&nbsp;*</span></label>\n                <div class="ipts">\n                    <input class="u-ipt j-ipt" type="text" name="mobile" maxlength="11" />\n                    <div class="z-error j-errmsg"></div>\n                </div>\n            </div>\n            {/if}\n            {if session.shop.hasEmail || session.hasEmail}\n            <div class="formitm">\n                <label for="lab" class="lab">邮箱<span class="u-required">&nbsp;&nbsp;*</span></label>\n                <div class="ipts">\n                    <input class="u-ipt j-ipt" type="text" name="email" maxlength="61" />\n                    <div class="z-error j-errmsg"></div>\n                </div>\n            </div>\n            {/if}\n            <div class="formitm lastItem">\n                <label for="lab" class="lab">留言<span class="u-required">&nbsp;&nbsp;*</span></label>\n                <div class="ipts">\n                    <textarea class="u-textarea j-ipt" name="content" maxlength="4000">\n                        <&#47;textarea>\n                </div>\n            </div>\n        </div>\n        <div class="btns">\n            <button class="u-btn j-leave-btn" type="button" data-action="sendLeaveMsg" name="leaveBtn" data-bid="${session.shop.id}">发送</button>\n        </div>\n    </form>\n</textarea>\n');I$(31,function(e,t,i,n,o,s,_,a,r,c){r._$$Leave=e._$klass();c=r._$$Leave._$extend(o._$$Abstract);c.__init=function(){this.__super()};c.__reset=function(e){this.__super(e);_._$render(this.__container,this.__seed_info,{session:e.session});this.__validateLeave()};c.__validateLeaveForm=function(){var e={};var t;var o={email:[/^\w+[-.\w]*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,/^[^@]{1,30}@[^@]{1,30}$/],mobile:[/^\d{11}$/]};var s=function(s){var a=!0;if(e.email&&!e.email.value&&(!s||"email"==s)||e.mobile&&!e.mobile.value&&(!s||"mobile"==s)||!t&&(!s||"content"==s))return!1;n._$forEach(["mobile","email"],function(t){if(s==t||!s){var n=e[t];var r=!0;if(n&&n.must){var c=n.value;var d=o[t];for(var l=0,u=d.length;l<u;l++)if(!d[l].test(c))r=!1}if(n&&!r){n.err.innerText=n.errTip;i._$delClassName(n.err,"f-dn");i._$addClassName(n.node,"z-ipt-error");a=!1}else if(n)_(t)}});return a};var _=function(t){if(t){var n=e[t];if(n){i._$addClassName(n.err,"f-dn");i._$delClassName(n.node,"z-ipt-error")}}};return function(n){var o=i._$get("leaveForm");if(!o)return!1;if("发送中..."===o.leaveBtn.innerText||"发送成功"===o.leaveBtn.innerText)return!1;if(o.mobile&&("mobile"==n||!n))e.mobile={must:!0,value:o.mobile.value.trim(),node:o.mobile,err:i._$getByClassName(o.mobile.parentNode,"j-errmsg")[0],errTip:"手机号不足11位"};if(o.email&&("email"==n||!n))e.email={must:!0,value:o.email.value.trim(),node:o.email,err:i._$getByClassName(o.email.parentNode,"j-errmsg")[0],errTip:"请填写正确的邮箱地址"};if("content"==n||!n)t=o.content.value.trim();return s(n)}}();c.__validateMobile=function(e){var t=e.value;e.value="NaN"===parseInt(t).toString()?"":parseInt(t);var n=/^\d{11}$/;var o=i._$getByClassName(e.parentNode,"j-errmsg")[0];if(""==t)return!1;if(n.test(t)){i._$addClassName(o,"f-dn");i._$delClassName(e,"z-ipt-error");return!0}else{i._$delClassName(o,"f-dn");o.innerText="手机号不足11位";return!1}};c.__validateEmail=function(e){var t=e.value;var n=/^\w+[-.\w]*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;var o=/^[^@]{1,30}@[^@]{1,30}$/;var s=i._$getByClassName(e.parentNode,"j-errmsg")[0];if(""==t)return!1;if(n.test(t)&&o.test(t)){i._$addClassName(s,"f-dn");i._$delClassName(e,"z-ipt-error");return!0}else{i._$delClassName(s,"f-dn");s.innerText="请填写正确的邮箱地址";return!1}};c.__validateCon=function(e){var t=e.value;if(""==t)return!1;else return!0};c.__getBtnStu=function(e){var t=i._$get("leaveForm");if(t){var n=!1;var o=!1;var s=!1;if(t.email)o=this.__validateEmail(t.email);else o=!0;if(t.mobile)n=this.__validateMobile(t.mobile);else n=!0;s=this.__validateCon(t.content);if(n&&o&&s){i._$delClassName(t.leaveBtn,"u-btn-disabled");t.leaveBtn.disabled=!1}else{i._$addClassName(t.leaveBtn,"u-btn-disabled");t.leaveBtn.disabled=!0}}};c.__validateLeave=function(){var e=i._$get("leaveForm");if(e){e.content.value="";if(e.mobile)t._$addEvent(e.mobile,"input",this.__getBtnStu._$bind(this,"mobile"));if(e.email)t._$addEvent(e.email,"input",this.__getBtnStu._$bind(this,"email"));if(e.content)t._$addEvent(e.content,"input",this.__getBtnStu._$bind(this,"content"))}};c.__destroy=function(){this.__super()};c.__initXGui=function(){var e=s._$parseUITemplate(a);return function(){this.__seed_html=e.leaveBody;this.__seed_info=e.leaveInfo}}();c.__checkIpt=function(e,t){if("mobile"==t)e.mobile.value=e.mobile.value.replace(/[^\d]/g,"");var n=!e.mobile?0:e.mobile.value.trim()?1:2;var o=!e.email?0:e.email.value.trim()?1:2;if(2==n||2==o||!e.content.value.trim()){i._$addClassName(e.leaveBtn,"u-btn-disabled");e.leaveBtn.disabled=!0}else{i._$delClassName(e.leaveBtn,"u-btn-disabled");e.leaveBtn.disabled=!1}};c.__initFormEvent=function(){var e=i._$get("leaveForm");if(e){if(e.email){t._$addEvent(e.email,"input",this.__checkIpt._$bind(this,e,"email"));t._$addEvent(e.email,"blur",this.__validateLeaveForm._$bind(this,"email"))}if(e.mobile){t._$addEvent(e.mobile,"input",this.__checkIpt._$bind(this,e,"mobile"));t._$addEvent(e.mobile,"blur",this.__validateLeaveForm._$bind(this,"mobile"))}e.content.value="";t._$addEvent(e.content,"input",this.__checkIpt._$bind(this,e,"content"));t._$addEvent(e.content,"blur",this.__validateLeaveForm._$bind(this,"content"));this.__checkIpt(e)}};c.__initNode=function(){this.__super();this.__container=this.__body}},15,16,17,1,72,2,18,85);I$(149,function(e,t,i,n,o,s,_,a,r,c){s._$$Draggable=t._$klass();c=s._$$Draggable._$extend(o._$$EventTarget);c.__reset=function(e){this.__super(e);this.__overflow=!!e.overflow;this.__body=i._$get(e.body);this.__mbar=i._$get(e.mbar)||this.__body;this.__view=i._$get(e.view)||i._$getPageBox();
this.__direction=parseInt(e.direction)||0;this.__doInitDomEvent([[document,"mouseup",this.__onDragEnd._$bind(this)],[document,"mousemove",this.__onDragging._$bind(this)],[this.__mbar,"mousedown",this.__onDragStart._$bind(this)]])};c.__destroy=function(){this.__super();delete this.__body;delete this.__mbar;delete this.__view};c.__getMaxRange=function(){return{x:this.__view.clientWidth-this.__body.offsetWidth,y:this.__view.clientHeight-this.__body.offsetHeight}};c.__onDragStart=function(e){n._$stop(e);if(!this.__offset){this.__offset={x:n._$pageX(e),y:n._$pageY(e)};this.__maxbox=this.__getMaxRange()}};c.__onDragging=function(e){if(this.__offset){n._$stop(e);var t={x:n._$pageX(e),y:n._$pageY(e)};var o=t.x-this.__offset.x,s=t.y-this.__offset.y,_=parseInt(i._$getStyle(this.__body,"top"))||0,a=parseInt(i._$getStyle(this.__body,"left"))||0,r={top:_+s,left:a+o};this.__offset=t;this._$setPosition(r)}};c.__onDragEnd=function(e){if(this.__offset){delete this.__maxbox;delete this.__offset;this._$dispatchEvent("ondragend",this._$getPosition())}};c._$setPosition=function(e){if(!this.__overflow){var t=this.__maxbox||this.__getMaxRange();e.top=Math.min(t.y,Math.max(0,e.top));e.left=Math.min(t.x,Math.max(0,e.left))}e.top=Math.round(e.top);e.left=Math.round(e.left);this._$dispatchEvent("onbeforechange",e);var i=this.__body.style;if(0==this.__direction||2==this.__direction)i.top=e.top+"px";if(0==this.__direction||1==this.__direction)i.left=e.left+"px";this._$dispatchEvent("onchange",e)};c._$getPosition=function(){return{left:parseInt(i._$getStyle(this.__body,"left"),10)||0,top:parseInt(i._$getStyle(this.__body,"top"),10)||0}};s._$$Dragger=s._$$Draggable;if(!0)e.copy(e.P("nej.ut"),s);return s},41,15,17,16,60);I$(185,function(e,t,i,n,o,s,_,a){var r;o._$$Animation=t._$klass();r=o._$$Animation._$extend(i._$$EventTarget);r.__reset=function(e){this.__super(e);this.__end=e.to||s;this.__begin=e.from||{};this.__delay=Math.max(0,parseInt(e.delay)||0)};r.__destroy=function(){this.__super();this._$stop();if(this.__dtime){window.clearTimeout(this.__dtime);delete this.__dtime}delete this.__end;delete this.__begin};r.__onAnimationFrame=function(e){if(this.__begin){if((""+e).indexOf(".")>=0)e=+new Date;if(!this.__doAnimationFrame(e))this.__timer=n.requestAnimationFrame(this.__onAnimationFrame._$bind(this));else this._$stop()}};r.__doAnimationFrame=_;r._$play=function(){var e=function(){this.__dtime=window.clearTimeout(this.__dtime);this.__begin.time=+new Date;this.__timer=n.requestAnimationFrame(this.__onAnimationFrame._$bind(this))};return function(){this.__dtime=window.setTimeout(e._$bind(this),this.__delay)}}();r._$stop=function(){this.__timer=n.cancelAnimationFrame(this.__timer);this._$dispatchEvent("onstop")};if(!0)e.copy(e.P("nej.ut"),o);return o},41,15,60,102);I$(171,function(e,t,i,n,o,s,_,a){var r;o._$$AnimBezier=t._$klass();r=o._$$AnimBezier._$extend(n._$$Animation);r.__reset=function(e){this.__super(e);this.__duration=e.duration||200;this.__epsilon=1/(200*this.__duration);this.__doParseTiming(e.timing);this.__doCalPolynomialCoefficients()};r.__destroy=function(){this.__super();delete this.__pointer;delete this.__coefficient};r.__doParseTiming=function(){var e=/^cubic\-bezier\((.*?)\)$/i,t=/\s*,\s*/i,n={linear:[0,0,1,1],ease:[.25,.1,.25,1],easein:[.42,0,1,1],easeout:[0,0,.58,1],easeinout:[0,0,.58,1]};var o=function(e,t,i){i[t]=parseFloat(e)};return function(s){s=(s||"").toLowerCase();this.__pointer=n[s];if(e.test(s)){this.__pointer=RegExp.$1.split(t);i._$forEach(this.__pointer,o)}if(!this.__pointer)this.__pointer=n.ease}}();r.__doCalPolynomialCoefficients=function(){var e=this.__pointer,t=3*e[0],i=3*(e[2]-e[0])-t,n=1-t-i,o=3*e[1],s=3*(e[3]-e[1])-o,_=1-o-s;this.__coefficient={ax:n,ay:_,bx:i,by:s,cx:t,cy:o}};r.__doCalCubicBezierAtTime=function(){var e=function(e,t){return((t.ax*e+t.bx)*e+t.cx)*e};var t=function(e,t){return((t.ay*e+t.by)*e+t.cy)*e};var i=function(e,t){return(3*t.ax*e+2*t.bx)*e+t.cx};var n=function(t,n,o){var s,_,a,r,c,d;for(a=t,d=0;d<8;d++){r=e(a,o)-t;if(Math.abs(r)<n)return a;c=i(a,o);if(Math.abs(c)<1e-6)break;a-=r/c}s=0;_=1;a=t;if(a<s)return s;if(a>_)return _;for(;s<_;){r=e(a,o);if(Math.abs(r-t)<n)return a;if(t>r)s=a;else _=a;a=.5*(_-s)+s}return a};return function(e){return t(n(e/this.__duration,this.__epsilon,this.__coefficient),this.__coefficient)}}();r.__doAnimationFrame=function(e){var t=e-this.__begin.time,n=this.__doCalCubicBezierAtTime(t),o=i._$fixed(this.__begin.offset*(1-n)+this.__end.offset*n,2),s=!1;if(t>=this.__duration){o=this.__end.offset;s=!0}this._$dispatchEvent("onupdate",{offset:1*o});return s};r._$stop=function(){this._$dispatchEvent("onupdate",{offset:this.__end.offset});this.__super()};if(!0)e.copy(e.P("nej.ut"),o);return o},41,15,1,185);I$(150,function(e,t,i,n,o,s,_,a){var r;o._$$AnimEaseInOut=t._$klass();r=o._$$AnimEaseInOut._$extend(n._$$AnimBezier);r.__reset=function(e){e=i._$merge({},e);e.timing="easeinout";this.__super(e)};if(!0)e.copy(e.P("nej.ut"),o);return o},41,15,1,171);I$(172,function(e){e.__getOverflowParent=function(e){return e}});I$(151,function(e,t){if("trident"===e._$KERNEL.engine)I$(173,function(){t.__getOverflowParent=function(e){var t=e;if("BODY"==t.tagName)t=t.ownerDocument.documentElement;return t}});return t},43,172);I$(99,function(e,t,i,n,o,s,_,a,r,c,d,l,u){var f;c._$$SimpleScroll=t._$klass();f=c._$$SimpleScroll._$extend(s._$$EventTarget);f.__init=function(){this.__aopt={to:{},from:{},duration:500,onstop:this.__doStopBarOpacity._$bind(this),onupdate:this.__doUpdateBarOpacity._$bind(this)};this.__dopt={x:{direction:1,ondragend:this.__onUpdateBarEnd._$bind(this,"x"),onbeforechange:this.__onBeforeUpdateBar._$bind(this,"x")},y:{direction:2,ondragend:this.__onUpdateBarEnd._$bind(this,"y"),onbeforechange:this.__onBeforeUpdateBar._$bind(this,"y")}};this.__dragger={};this.__super()};f.__reset=function(){var t={x:{min:0,speed:1,step:50,interval:50,left:0,right:0,hover:"js-hover",sb:"scrollWidth",cb:"clientWidth",ob:"offsetWidth",sr:"scrollLeft",ss:"width",sp:"left",dr:"right"},y:{min:0,speed:1,interval:50,step:50,top:0,bottom:0,hover:"js-hover",sb:"scrollHeight",cb:"clientHeight",ob:"offsetHeight",sr:"scrollTop",ss:"height",sp:"top",dr:"bottom"}};var n=function(n,o){if(!(o||d).body)o={body:o};var s=e.X(e.X({},t[n]),o);s.body=i._$get(s.body);if(s.body&&s.track){if(":parent"==s.track)s.track=s.body.parentNode;s.track=i._$get(s.track)}if(!s.min)s.min=!s.body?10:s.body[s.ob]||10;return s};var o=function(e,t){if(t){var i=this.__dopt[e];i.body=t;i.view=this.__parent;this.__dragger[e]=_._$$Dragger._$allocate(i)}};return function(e){this.__super(e);this.__bar={x:n("x",e.xbar),y:n("y",e.ybar)};this.__parent=i._$get(e.parent);this.__doInitDomEvent([[this.__parent,"mousewheel",this.__onMouseWheel._$bind(this)],[this.__parent,"scroll",this.__doSyncScrollBar._$bind(this)],[this.__parent,"mouseover",this.__doFixScrollBar._$bind(this)],[this.__bar.x.track,"mousedown",this.__onTrackDown._$bind(this,"x")],[this.__bar.y.track,"mousedown",this.__onTrackDown._$bind(this,"y")],[this.__bar.x.track,"mousewheel",this.__onMouseWheel._$bind(this)],[this.__bar.y.track,"mousewheel",this.__onMouseWheel._$bind(this)]]);var t=i._$get(e.trigger);if(t){this.__doInitDomEvent([[e.trigger,"mouseenter",this.__onMouseEnter._$bind(this)],[e.trigger,"mouseleave",this.__onMouseLeave._$bind(this)]]);this.__doUpdateBarOpacity({offset:0})}else this._$resize();o.call(this,"x",this.__bar.x.body);o.call(this,"y",this.__bar.y.body)}}();f.__destroy=function(){var e=function(e,t,i){e._$recycle();delete i[t];var n=this.__dopt[t];delete n.view;delete n.body};var t=function(e,t,n){if(e.body){var o={};o[e.ss]="";o[e.sp]="";i._$style(e.body,o);delete e.body}};return function(){this.__super();delete this.__isout;delete this.__parent;delete this.__dragging;this.__doStopBarOpacity();o._$loop(this.__dragger,e._$bind(this));o._$loop(this.__bar,t._$bind(this));delete this.__bar}}();f.__getOverflowParent=function(){return r.__getOverflowParent(this.__parent)};f.__doResetBarSize=function(e){var t=this.__getOverflowParent(),n=t[e.sb],o=t[e.cb],s=n-o,o=o-e[e.sp]-e[e.dr],_=n-o,a={},r={};if(s<=0){e.ratio=0;r.visibility="hidden";a[e.ss]=o+"px"}else{var c=Math.ceil(Math.max(e.min,o-o/n*_));r.visibility="visible";a[e.ss]=c+"px";e.max=Math.ceil(o-c+e[e.sp]);e.ratio=(o-c)/_}e.delta=0;if(e.body)e.delta=e.body[e.ob]-e.body[e.cb];i._$style(e.track||e.body,r);i._$style(e.body,a)};f.__doResetBarPosition=function(e,t){var n=this.__getOverflowParent();if(0!=t)n[e.sr]-=t*e.speed;if(e.body){var o=n[e.sr],s=Math.ceil(o*e.ratio)-e.delta+e[e.sp];i._$setStyle(e.body,e.sp,s+"px")}};f.__doSyncScrollBar=function(){if(!this.__dragging)this._$resize()};f.__doUpdateScrollBar=function(e,t){this.__doResetBarPosition(this.__bar.y,t);this.__doResetBarPosition(this.__bar.x,e)};f.__doAnimScrollBar=function(){this.__doStopBarOpacity();var e=this.__bar.y,t=e.track||e.body;if(!t){e=this.__bar.x;t=e.track||e.body}this.__aopt.from.offset=i._$getStyle(t,"opacity");this.__anim=a._$$AnimEaseInOut._$allocate(this.__aopt);this.__anim._$play()};f.__doUpdateBarOpacity=function(e){var t=e.offset;i._$setStyle(this.__bar.x.track||this.__bar.x.body,"opacity",t);i._$setStyle(this.__bar.y.track||this.__bar.y.body,"opacity",t)};f.__doStopBarOpacity=function(){if(this.__anim){this.__anim._$recycle();delete this.__anim}};f.__onMouseWheel=function(e){var t=this.__getOverflowParent(),i=t.scrollTop,o=t.scrollLeft;this.__doUpdateScrollBar(e.wheelDeltaX||0,e.wheelDeltaY||e.wheelDelta||0);i=t.scrollTop!=i;o=t.scrollLeft!=o;if(i||o)n._$stop(e)};f.__onMouseEnter=function(e){this.__isout=!1;this._$resize();this.__aopt.delay=0;this.__aopt.to.offset=.6;this.__doAnimScrollBar()};f.__onMouseLeave=function(e){this.__isout=!0;if(!this.__dragging){this.__aopt.delay=500;this.__aopt.to.offset=0;this.__doAnimScrollBar()}};f.__onTrackDown=function(){var e={x:function(e){this.__doUpdateScrollBar(e,0)},y:function(e){this.__doUpdateScrollBar(0,e)}};var t,o,s;var _=function(e){s=1;o=null;t=window.clearTimeout(t);n._$delEvent(e.track,"mouseup",o);
};var a=function(r,c,d){var l=this.__bar[r],u=parseInt(i._$getStyle(l.body,l.sp)),f=u+d;if(!(u<=c&&c<=f)){if(!o){o=_._$bind(this,l);n._$addEvent(l.track,"mouseup",o)}e[r].call(this,(c<u?1:-1)*l.step*s);t=window.setTimeout(a._$bind(this,r,c,d),l.interval);s++}else _(l)};return function(e,t){var o=this.__bar[e],s=i._$offset(o.track)[e],r=n._$page(t)[e],c=o.body[o.ob];_(o);a.call(this,e,r-s,c)}}();f.__onBeforeUpdateBar=function(e,t){this.__dragging=!0;var n=this.__getOverflowParent(),o=this.__bar[e],s=o[o.sp],_=Math.max(s,Math.min(o.max,t[o.sp]));n[o.sr]=Math.ceil((_-s)/o.ratio);t[o.sp]=_;i._$addClassName(o.track,o.hover)};f.__onUpdateBarEnd=function(e){this.__dragging=!1;if(this.__isout)this.__onMouseLeave();var t=this.__bar[e];i._$delClassName(t.track,t.hover)};f.__doFixScrollBar=function(e){this._$resize()};f._$resize=function(){this.__doResetBarSize(this.__bar.x);this.__doResetBarSize(this.__bar.y);this.__doUpdateScrollBar(0,0)};f._$show=function(){this.__onMouseEnter()};f._$hide=function(){this.__onMouseLeave()};if(!0)e.copy(e.P("nej.ut"),c);return c},41,15,17,16,1,60,149,150,151);I$(100,".#<uispace>-parent{position:relative;}\n");I$(101,'<textarea name="ntp" id="#<sbBody>">\n  <div class="u-scrollbar"><span class="thumb">&nbsp;</span></div>\n</textarea>');I$(57,function(e,t,i,n,o,s,_,a,r){a._$$Scrollbar=e._$klass();r=a._$$Scrollbar._$extend(o._$$Abstract);r.__init=function(){this.__sopt={ybar:{}};this.__super()};r.__reset=function(e){var n=t._$get(e.parent);if(n){var o=e.container||n.parentNode;this.__super({parent:o,clazz:"m-scrollbar"});this.__sopt.parent=n;this.__scrollbar=i._$$SimpleScroll._$allocate(this.__sopt);setTimeout(function(){if(this.__scrollbar)this.__scrollbar._$resize()}._$bind(this),1e3);this.__doInitDomEvent([[e.sbody||this.__sopt.parent,"scroll",this.__doShowScrollBar._$bind(this)]])}};r.__destroy=function(){delete this.__sopt.parent;delete this.__sopt.trigger;this.__doClearComponent();this.__super()};r.__initXGui=function(){var e=t._$pushCSSText(s),i=n._$parseUITemplate(_);return function(){this.__seed_css=e;this.__seed_html=i.sbBody}}();r.__initNode=function(){this.__super();this.__sopt.ybar.track=this.__body;this.__sopt.ybar.body=t._$getChildren(this.__body)[0]};r.__doShowScrollBar=function(){if(this.__stimer)window.clearTimeout(this.__stimer);if(this.__scrollbar)this.__scrollbar._$show()};r.__doHideScrollBar=function(){this.__stimer=window.clearTimeout(this.__stimer);if(this.__scrollbar)this.__scrollbar._$hide()};r._$resize=function(){if(this.__scrollbar)this.__scrollbar._$resize()}},15,17,99,2,72,100,101);I$(144,function(e,t,i,n,o,s){i.__handleFileLabelClick=function(){};return i});I$(96,function(e,t,i,n,o,s,_){if("gecko"===e._$KERNEL.engine)I$(145,function(){i.__handleFileLabelClick=function(){var e=function(e){t._$stop(e);t._$getElement(e,"t:label").control.click()};return function(i){t._$addEvent(i,"click",e)}}()});return i},43,16,144);I$(48,function(e,t,i,n,o,s,_,a,r,c){var d={},l=t._$pushCSSText(".#<uispace>{position:absolute;width:0;height:0;overflow:hidden;}");_._$bind=function(){var e=function(e){var t=d[e];if(!t){t={};d[e]=t}return t};var s=function(e,t){if(t){var i=[];n._$loop(t,function(e,t){i.push('<input type="hidden" name="'+t+'" value="'+e+'">')});e.insertAdjacentHTML("afterBegin",i.join(""))}};var _=function(e,i,n,o,_){var a,r=d[e],c=l+" "+(n||"");i=t._$get(i);if(i){a=t._$create("div",c);i.appendChild(a);t._$dataset(i,"id",e);s(i,o)}else{a=t._$create("form",c);t._$dataset(a,"id",e);s(a,o);(_||document.body).appendChild(a)}r.pid=t._$id(a)};var c=function(e,n){var o=n.accept||"";if(o)o='accept="'+o+'"';var s="";if(n.multiple)s='multiple="true"';var n=d[e],_=e+"-"+n.nmb,a=t._$html2node('<input type="file" '+s+" "+o+' contenteditable="false" id="'+_+'"/>');n.nmb++;t._$get(n.pid).appendChild(a);i._$addEvent(a,"change",u);return _};var u=function(e){var n=i._$getElement(e),o=n.id,s=o.split("-"),_=d[s[0]];if(n.value){if(_.multiple)t._$get(_.lab).htmlFor=c(s[0],_);if(!n.name){var a="";n.name=_.name+a}_.onchange({id:o,form:n.form,target:t._$get(_.lab)})}};return function(i,s){i=t._$get(i);if(i&&"LABEL"==i.tagName){t._$dumpCSSText();var d=n._$uniqueID(),l=e(d);s=s||a;_(d,s.form,s.clazz,s.param,t._$get(s.parent));l.nmb=0;l.name=s.name||"file";l.lab=t._$id(i);l.accept=s.accept||"";l.multiple=!!s.multiple;l.onchange=s.onchange||r;i.htmlFor=c(d,l);o.__handleFileLabelClick(i);return d}}}();_._$get=function(e){var i=d[e];if(i){var n=t._$get(i.pid);if(n){if("FORM"!=n.tagName)n=n.parentNode;return n}}};_._$unbind=function(e){var i=d[e];if(i){t._$remove(i.pid);delete d[e]}};_._$selectable=function(){var e;return function(){if(null==e){var t=document.createElement("input");t.type="file";e=!t.disabled}return e}}();s._$merge({_$bind:_._$bind});if(!0){var s=e.P("nej.e");s._$file=_._$bind;s._$getFileForm=_._$get;s._$removeFileForm=_._$unbind}return _},41,17,16,1,96,47);I$(146,function(e,t,i,n,o,s){i.__setCursorPosition=function(e,t){e.selectionEnd=t.end||0;e.selectionStart=t.start||0;e.focus()};i.__getCursorPosition=function(e){e.focus();return{end:e.selectionEnd,start:e.selectionStart}};i.__getCursorPXPosition=function(t){var i=document.createElement("div");e._$style(i,{position:"absolute",visibility:"hidden",whiteSpace:"pre-wrap",appearance:"textarea",font:e._$getStyle(t,"font"),display:e._$getStyle(t,"display"),padding:e._$getStyle(t,"padding"),wordWrap:e._$getStyle(t,"wordWrap"),textAlign:e._$getStyle(t,"textAlign"),letterSpacing:e._$getStyle(t,"letterSpacing"),top:0,left:0,width:t.clientWidth+"px",height:t.clientHeight+"px"});i.innerText=t.value;var n=document.createElement("span");i.appendChild(n);document.body.appendChild(i);var o={width:0,top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight};e._$remove(i);return o};return i},17,43);I$(97,function(e,t,i,n,o,s,_){if("trident"===t._$KERNEL.engine)I$(147,function(){e.__getCursorPXPosition=function(e){e.focus();var t=document.selection.createRange(),n=i._$getPageBox(),o=i._$offset(e);return{top:t.boundingTop-o.y+n.scrollTop,left:t.boundingLeft-o.x+n.scrollLeft,width:t.boundingWidth,height:t.boundingHeight}}});if("trident"===t._$KERNEL.engine&&t._$KERNEL.release<="4.0")I$(148,function(){e.__setCursorPosition=function(e,t){var i=e.createTextRange();i.collapse(!0);i.moveStart("character",t.start);i.moveEnd("character",t.end-t.start);i.select();e.focus()};e.__getCursorPosition=function(e){var t=document.selection.createRange();var i=e.createTextRange();i.moveToBookmark(t.getBookmark());var n=e.createTextRange();n.collapse(!0);n.setEndPoint("EndToStart",i);var o=n.text.length;return{start:o,end:o+t.text.length}}});return e},146,43,17);I$(49,function(e,t,i,n,o,s,_,a,r){var c={};s._$cursor=c._$cursor=function(e,n){e=t._$get(e);if(!e)return{start:0,end:0};if(i._$isNumber(n))n={start:n,end:n};if(null!=n){if(null==n.end)n.end=n.start||0;o.__setCursorPosition(e,n)}else n=o.__getCursorPosition(e);return n};s._$coordinate=c._$coordinate=function(e){e=t._$get(e);if(!e)return{top:0,left:0,width:0,height:0};else return o.__getCursorPXPosition(e)};n._$merge(c);if(!0)e.copy(e.P("nej.e"),s);return s},41,17,1,47,97);I$(54,function(e,t,i,n){var o=1;var s=function(){var e=window.navigator.userAgent;if(/SE 2.X MetaSr 1.0/gi.test(e))return!0;else return!1};n._$permission=function(){var e=!1;return function(){if(!e){e=!0;if(window.Notification&&!s())Notification.requestPermission(function(e){o="denied"!==e})}}}();var _;var a=function(t){var i=e._$merge({category:"winfocus"},t);parent.postMessage("pkg:"+JSON.stringify(i),"*")};var r=function(e,n){var a=t._$get("notify-sound-url");if(a)i._$play(a.src,{key:"ysf-message-sound"});if(!window.Notification||o)if(window.Notification&&!s()){var r={id:n.id,notify:new Notification(e,n)};if(_){_.notify.close();_=void 0}_=r;r.notify.onclick=function(){window.focus();r.notify.close()};r.notify.onclose=function(){window.clearTimeout(r.timer)};r.timer=window.setTimeout(function(){r.notify.close()},2e4)}};n._$closeBySessionId=function(e){if((!e||e==_.id)&&_)_.notify.close()};n._$notifyMessage=function(){var t={image:function(e){return"[图片]"},audio:function(e){return"[音频]"}};return function(i,o){var s=window.setting||{},_=t[i.type],c=i.content||"",o="客服"+(o||"");if(e._$isFunction(_))c=_.call(this,i);if(1!=setting.dialogStyle){n._$permission();r(o+"说：",{body:c,tag:"ysf",icon:appConfig.path.kefu+"res/img/notification.png"})}else a({notify:o+"说:",body:c,tag:"ysf",icon:appConfig.path.kefu+"res/img/notification.png"})}}()},1,17,84);I$(78,'<textarea name="ntp" id="#<lbBody>">\n  <div class="m-layer">\n      <div class="close j-flag">\n          <i class="u-icon-closewhite"></i>\n      </div>\n      <table>\n          <tbody>\n          <tr>\n              <td>\n                  <div class="lywrap">\n                      <div class="lyct small">\n                          <div class="prev j-flag">\n                              <i class="u-icon-prev"></i>\n                          </div>\n                          <div class="imgWrap j-flag"></div>\n                          <div class="next j-flag">\n                              <i class="u-icon-next"></i>\n                          </div>\n                      </div>\n                  </div>\n              </td>\n          </tr>\n          </tbody>\n      </table>\n  </div>\n</textarea>\n<textarea name="txt" id="#<lbLoading>">\n  <div class="status loading"><img src="/prd/res/img/loading.gif"/></div>\n</textarea>\n<textarea name="txt" id="#<lbError>">\n  <div class="status error"><div class="message j-flxg"></div></div>\n</textarea>');I$(21,function(e,t,i,n,o,s,_,a,r){a._$$LightBox=e._$klass();r=a._$$LightBox._$extend(o._$$Abstract);r.__init=function(){this.__super()};r.__reset=function(e){this._$batEvent({onshow:this.__doFadeIn._$bind(this),onhide:this.__doFadeOut._$bind(this)});this.__super(e);this.__doInitDomEvent([[this.__nclose,"click",this.__doExitFullScreen._$bind(this)],[this.__nprev,"click",this._$backward._$bind(this)],[this.__nnext,"click",this._$forward._$bind(this)],[this.__nbox,"click",this.__doRedirect2Href._$bind(this)],[document,"keydown",this.__doCheckNavigator._$bind(this)],[document,"fullscreenchange",this.__onFullScreenChange._$bind(this)],[this.__ntest,"load",this.__onImageLoad._$bind(this,!0)],[this.__ntest,"error",this.__onImageLoad._$bind(this,!1)]]);
this.__list=e.list||[];this.__index=parseInt(e.index)||0;this.__disabled=e.disabled||"j-disabled";this._$go();if(e.fullscreen)this.__doFullScreen()};r.__destroy=function(){i._$remove(this.__image);delete this.__fulled;this.__super()};r.__initXGui=function(){var e=s._$parseUITemplate(_);return function(){this.__seed_html=e.lbBody;this.__seed_load=e.lbLoading;this.__seed_error=e.lbError}}();r.__initNode=function(){this.__super();var e=i._$getByClassName(this.__body,"j-flag");this.__nclose=e[0];this.__nprev=e[1];this.__nbox=e[2];this.__nnext=e[3];this.__ntest=new Image;this.__nloading=i._$html2node(s._$getTextTemplate(this.__seed_load));this.__nerror=i._$html2node(s._$getTextTemplate(this.__seed_error))};r.__doFadeIn=function(e){i._$addClassName(e.target,"a-fadein")};r.__doFadeOut=function(e){};r.__doCheckDisableStatus=function(){this.__index<=0?i._$addClassName(this.__nprev,this.__disabled):i._$delClassName(this.__nprev,this.__disabled);this.__index>=this.__list.length-1?i._$addClassName(this.__nnext,this.__disabled):i._$delClassName(this.__nnext,this.__disabled)};r.__doFullScreen=function(){var e=this.__body.requestFullscreen||this.__body.msRequestFullscreen||this.__body.mozRequestFullScreen||this.__body.webkitRequestFullScreen;if(e)e.call(this.__body);this.__fulled=!0};r.__doExitFullScreen=function(e){var t=document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen;if(t)t.call(document);this.__doCloseFullScreen()};r.__doCloseFullScreen=function(e){this._$dispatchEvent("onexit");this._$recycle()};r.__onFullScreenChange=function(e){var t=document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;if(!t)this.__doExitFullScreen()};r.__doRedirect2Href=function(e){var t=this.__list[this.__index];if(t&&t.href)window.open(t.href)};r.__doRenderImage=function(){var e=this.__list[this.__index];if(e){this.__doHideError();this.__doHideLoading();if(this.__image){var n={target:this.__image};this._$dispatchEvent("onhide",n);if(!n.stopped)i._$remove(this.__image)}this.__image=new Image;this.__nbox.appendChild(this.__image);t._$addEvent(this.__image,"error",this.__doCheckImageError._$bind(this));if(!e.thumb){i._$delClassName(this.__nbox.parentNode,"small");this.__image.src=e.src}else{i._$addClassName(this.__nbox.parentNode,"small");this.__doShowLoading();this.__image.src=e.thumb;this.__ntest.src=e.src}this._$dispatchEvent("onshow",{target:this.__image})}};r.__doCheckNavigator=function(e){var t=e.keyCode;if(37!==t)if(39!==t){if(27===t)this.__doExitFullScreen()}else this._$forward();else this._$backward()};r.__doShowLoading=function(){this.__nbox.parentNode.appendChild(this.__nloading)};r.__doHideLoading=function(){i._$removeByEC(this.__nloading)};r.__doShowError=function(e){i._$getByClassName(this.__nerror,"j-flxg")[0].innerText=e||"加载失败，请稍后再试";this.__nbox.parentNode.appendChild(this.__nerror)};r.__doHideError=function(){i._$removeByEC(this.__nloading)};r.__doCheckImageError=function(){var e="";if(navigator.onLine===!1)e="网络连接失败，请稍后再试";this.__doShowError(e)};r.__onImageLoad=function(e){var t=this.__list[this.__index];if(this.__ntest.src==t.src){this.__doHideLoading();if(e){i._$delClassName(this.__nbox.parentNode,"small");this.__image.src=t.src}else this.__doCheckImageError()}};r._$go=function(e){var t=this.__index+(e||0);this.__index=Math.max(0,Math.min(t,this.__list.length-1));this.__doCheckDisableStatus();this.__doRenderImage()};r._$backward=function(){if(!i._$hasClassName(this.__nprev,this.__disabled))this._$go(-1)};r._$forward=function(){if(!i._$hasClassName(this.__nnext,this.__disabled))this._$go(1)};a._$lightbox=function(e){var t=i._$get(e.current),o=e.group||"";if(t)o=i._$dataset(t,"group")||o;var s=i._$get(e.parent)||document.body,_=s.getElementsByTagName("IMG"),r=[],c=0;n._$forEach(_,function(e){if(!o||o==i._$dataset(e,"group")){var s={src:e.src,title:e.alt||"",href:i._$dataset(e,"href")};var _=i._$dataset(e,"src"),a=i._$dataset(e,"thumb");if(_){s.thumb=s.src;s.src=n._$absolute(_)}else if(a)s.thumb=n._$absolute(a);r.push(s);if(e===t)c=r.length-1}});a._$$LightBox._$allocate(n._$merge({fullscreen:!0,disabled:"z-page-disabled"},e,{parent:document.body,index:c,list:r}))};a._$delegate=function(e,i){t._$addEvent(e,"click",function(n){var o=t._$getElement(n,"d:group");if(o&&"IMG"==o.tagName){var s=e.scrollTop;a._$lightbox({parent:e,current:o,fullscreen:"mobile"==i?0:1,onexit:function(){window.setTimeout(function(){e.scrollTop=s},100)}})}})}},15,16,17,1,72,2,78);I$(77,{plist:[{id:"emoticon_emoji_01",tag:"[可爱]",file:"emoji_01.png"},{id:"emoticon_emoji_0",tag:"[大笑]",file:"emoji_00.png"},{id:"emoticon_emoji_02",tag:"[色]",file:"emoji_02.png"},{id:"emoticon_emoji_03",tag:"[嘘]",file:"emoji_03.png"},{id:"emoticon_emoji_04",tag:"[亲]",file:"emoji_04.png"},{id:"emoticon_emoji_05",tag:"[呆]",file:"emoji_05.png"},{id:"emoticon_emoji_06",tag:"[口水]",file:"emoji_06.png"},{id:"emoticon_emoji_145",tag:"[汗]",file:"emoji_145.png"},{id:"emoticon_emoji_07",tag:"[呲牙]",file:"emoji_07.png"},{id:"emoticon_emoji_08",tag:"[鬼脸]",file:"emoji_08.png"},{id:"emoticon_emoji_09",tag:"[害羞]",file:"emoji_09.png"},{id:"emoticon_emoji_10",tag:"[偷笑]",file:"emoji_10.png"},{id:"emoticon_emoji_11",tag:"[调皮]",file:"emoji_11.png"},{id:"emoticon_emoji_12",tag:"[可怜]",file:"emoji_12.png"},{id:"emoticon_emoji_13",tag:"[敲]",file:"emoji_13.png"},{id:"emoticon_emoji_14",tag:"[惊讶]",file:"emoji_14.png"},{id:"emoticon_emoji_15",tag:"[流感]",file:"emoji_15.png"},{id:"emoticon_emoji_16",tag:"[委屈]",file:"emoji_16.png"},{id:"emoticon_emoji_17",tag:"[流泪]",file:"emoji_17.png"},{id:"emoticon_emoji_18",tag:"[嚎哭]",file:"emoji_18.png"},{id:"emoticon_emoji_19",tag:"[惊恐]",file:"emoji_19.png"},{id:"emoticon_emoji_20",tag:"[怒]",file:"emoji_20.png"},{id:"emoticon_emoji_21",tag:"[酷]",file:"emoji_21.png"},{id:"emoticon_emoji_22",tag:"[不说]",file:"emoji_22.png"},{id:"emoticon_emoji_23",tag:"[鄙视]",file:"emoji_23.png"},{id:"emoticon_emoji_24",tag:"[阿弥陀佛]",file:"emoji_24.png"},{id:"emoticon_emoji_25",tag:"[奸笑]",file:"emoji_25.png"},{id:"emoticon_emoji_26",tag:"[睡着]",file:"emoji_26.png"},{id:"emoticon_emoji_27",tag:"[口罩]",file:"emoji_27.png"},{id:"emoticon_emoji_28",tag:"[生气]",file:"emoji_28.png"},{id:"emoticon_emoji_29",tag:"[抠鼻孔]",file:"emoji_29.png"},{id:"emoticon_emoji_30",tag:"[疑问]",file:"emoji_30.png"},{id:"emoticon_emoji_31",tag:"[怒骂]",file:"emoji_31.png"},{id:"emoticon_emoji_32",tag:"[晕]",file:"emoji_32.png"},{id:"emoticon_emoji_33",tag:"[呕吐]",file:"emoji_33.png"},{id:"emoticon_emoji_160",tag:"[拜一拜]",file:"emoji_160.png"},{id:"emoticon_emoji_161",tag:"[惊喜]",file:"emoji_161.png"},{id:"emoticon_emoji_162",tag:"[流汗]",file:"emoji_162.png"},{id:"emoticon_emoji_163",tag:"[卖萌]",file:"emoji_163.png"},{id:"emoticon_emoji_164",tag:"[默契眨眼]",file:"emoji_164.png"},{id:"emoticon_emoji_165",tag:"[烧香拜佛]",file:"emoji_165.png"},{id:"emoticon_emoji_166",tag:"[晚安]",file:"emoji_166.png"},{id:"emoticon_emoji_116",tag:"[撇嘴]",file:"new_emoji_01.png"},{id:"emoticon_emoji_117",tag:"[难过]",file:"1f641.png"},{id:"emoticon_emoji_118",tag:"[冷汗]",file:"1f628.png"},{id:"emoticon_emoji_119",tag:"[抓狂]",file:"1f629.png"},{id:"emoticon_emoji_120",tag:"[傲慢]",file:"1f615.png"},{id:"emoticon_emoji_121",tag:"[困]",file:"1f62a.png"},{id:"emoticon_emoji_123",tag:"[疯了]",file:"1f616.png"},{id:"emoticon_emoji_124",tag:"[白眼]",file:"new_emoji_02.png"},{id:"emoticon_emoji_125",tag:"[衰]",file:"new_emoji_05.png"},{id:"emoticon_emoji_126",tag:"[再见]",file:"new_emoji_06.png"},{id:"emoticon_emoji_127",tag:"[哼哼]",file:"1f63e.png"},{id:"emoticon_emoji_129",tag:"[饥饿]",file:"new_emoji_03.png"},{id:"emoticon_emoji_143",tag:"[飞吻]",file:"new_emoji_10.png"},{id:"emoticon_emoji_144",tag:"[微笑]",file:"1f642.png"},{id:"emoticon_emoji_145",tag:"[泪中带笑]",file:"new_emoji_13.png"},{id:"emoticon_emoji_146",tag:"[吐舌头]",file:"1f61d.png"},{id:"emoticon_emoji_147",tag:"[忧郁]",file:"new_emoji_11.png"},{id:"emoticon_emoji_148",tag:"[尴尬]",file:"1f630.png"},{id:"emoticon_emoji_149",tag:"[舒适]",file:"1f60c.png"},{id:"emoticon_emoji_150",tag:"[不悦]",file:"1f612.png"},{id:"emoticon_emoji_155",tag:"[拍掌]",file:"new_emoji_09.png"},{id:"emoticon_emoji_156",tag:"[糗大了]",file:"new_emoji_07.png"},{id:"emoticon_emoji_122",tag:"[奋斗]",file:"1f4aa-1f3fc.png"},{id:"emoticon_emoji_130",tag:"[乒乓]",file:"new_emoji_23.png"},{id:"emoticon_emoji_131",tag:"[猪头]",file:"1f437.png"},{id:"emoticon_emoji_132",tag:"[玫瑰]",file:"new_emoji_25.png"},{id:"emoticon_emoji_133",tag:"[凋谢]",file:"new_emoji_24.png"},{id:"emoticon_emoji_134",tag:"[瓢虫]",file:"1f41e.png"},{id:"emoticon_emoji_135",tag:"[月亮]",file:"new_emoji_30.png"},{id:"emoticon_emoji_136",tag:"[礼物]",file:"new_emoji_28.png"},{id:"emoticon_emoji_137",tag:"[拥抱]",file:"new_emoji_08.png"},{id:"emoticon_emoji_138",tag:"[抱拳]",file:"new_emoji_18.png"},{id:"emoticon_emoji_139",tag:"[勾引]",file:"new_emoji_19.png"},{id:"emoticon_emoji_140",tag:"[差劲]",file:"new_emoji_20.png"},{id:"emoticon_emoji_141",tag:"[爱你]",file:"new_emoji_21.png"},{id:"emoticon_emoji_142",tag:"[NO]",file:"new_emoji_22.png"},{id:"emoticon_emoji_151",tag:"[幽灵]",file:"1f47b.png"},{id:"emoticon_emoji_152",tag:"[礼盒]",file:"1f49d.png"},{id:"emoticon_emoji_153",tag:"[拜托]",file:"1f64f-1f3fc.png"},{id:"emoticon_emoji_154",tag:"[气球]",file:"1f388.png"},{id:"emoticon_emoji_34",tag:"[强]",file:"emoji_34.png"},{id:"emoticon_emoji_35",tag:"[弱]",file:"emoji_35.png"},{id:"emoticon_emoji_36",tag:"[OK]",file:"emoji_36.png"},{id:"emoticon_emoji_37",tag:"[拳头]",file:"emoji_37.png"},{id:"emoticon_emoji_38",tag:"[胜利]",file:"emoji_38.png"},{id:"emoticon_emoji_39",tag:"[鼓掌]",file:"emoji_39.png"},{id:"emoticon_emoji_167",tag:"[握手]",file:"emoji_167.png"},{id:"emoticon_emoji_40",tag:"[发怒]",file:"emoji_40.png"},{id:"emoticon_emoji_41",tag:"[骷髅]",file:"emoji_41.png"},{id:"emoticon_emoji_42",tag:"[便便]",file:"emoji_42.png"},{id:"emoticon_emoji_43",tag:"[火]",file:"emoji_43.png"},{id:"emoticon_emoji_44",tag:"[溜]",file:"emoji_44.png"},{id:"emoticon_emoji_45",tag:"[爱心]",file:"emoji_45.png"},{id:"emoticon_emoji_46",tag:"[心碎]",
file:"emoji_46.png"},{id:"emoticon_emoji_47",tag:"[钟情]",file:"emoji_47.png"},{id:"emoticon_emoji_48",tag:"[唇]",file:"emoji_48.png"},{id:"emoticon_emoji_49",tag:"[戒指]",file:"emoji_49.png"},{id:"emoticon_emoji_50",tag:"[钻石]",file:"emoji_50.png"},{id:"emoticon_emoji_51",tag:"[太阳]",file:"emoji_51.png"},{id:"emoticon_emoji_52",tag:"[有时晴]",file:"emoji_52.png"},{id:"emoticon_emoji_53",tag:"[多云]",file:"emoji_53.png"},{id:"emoticon_emoji_54",tag:"[雷]",file:"emoji_54.png"},{id:"emoticon_emoji_55",tag:"[雨]",file:"emoji_55.png"},{id:"emoticon_emoji_56",tag:"[雪花]",file:"emoji_56.png"},{id:"emoticon_emoji_57",tag:"[爱人]",file:"emoji_57.png"},{id:"emoticon_emoji_58",tag:"[帽子]",file:"emoji_58.png"},{id:"emoticon_emoji_59",tag:"[皇冠]",file:"emoji_59.png"},{id:"emoticon_emoji_60",tag:"[篮球]",file:"emoji_60.png"},{id:"emoticon_emoji_61",tag:"[足球]",file:"emoji_61.png"},{id:"emoticon_emoji_62",tag:"[垒球]",file:"emoji_62.png"},{id:"emoticon_emoji_63",tag:"[网球]",file:"emoji_63.png"},{id:"emoticon_emoji_64",tag:"[台球]",file:"emoji_64.png"},{id:"emoticon_emoji_65",tag:"[咖啡]",file:"emoji_65.png"},{id:"emoticon_emoji_66",tag:"[啤酒]",file:"emoji_66.png"},{id:"emoticon_emoji_67",tag:"[干杯]",file:"emoji_67.png"},{id:"emoticon_emoji_68",tag:"[柠檬汁]",file:"emoji_68.png"},{id:"emoticon_emoji_69",tag:"[餐具]",file:"emoji_69.png"},{id:"emoticon_emoji_70",tag:"[汉堡]",file:"emoji_70.png"},{id:"emoticon_emoji_71",tag:"[鸡腿]",file:"emoji_71.png"},{id:"emoticon_emoji_72",tag:"[面条]",file:"emoji_72.png"},{id:"emoticon_emoji_73",tag:"[冰淇淋]",file:"emoji_73.png"},{id:"emoticon_emoji_74",tag:"[沙冰]",file:"emoji_74.png"},{id:"emoticon_emoji_75",tag:"[生日蛋糕]",file:"emoji_75.png"},{id:"emoticon_emoji_76",tag:"[蛋糕]",file:"emoji_76.png"},{id:"emoticon_emoji_77",tag:"[糖果]",file:"emoji_77.png"},{id:"emoticon_emoji_78",tag:"[葡萄]",file:"emoji_78.png"},{id:"emoticon_emoji_79",tag:"[西瓜]",file:"emoji_79.png"},{id:"emoticon_emoji_80",tag:"[光碟]",file:"emoji_80.png"},{id:"emoticon_emoji_81",tag:"[手机]",file:"emoji_81.png"},{id:"emoticon_emoji_82",tag:"[电话]",file:"emoji_82.png"},{id:"emoticon_emoji_83",tag:"[电视]",file:"emoji_83.png"},{id:"emoticon_emoji_84",tag:"[声音开启]",file:"emoji_84.png"},{id:"emoticon_emoji_85",tag:"[声音关闭]",file:"emoji_85.png"},{id:"emoticon_emoji_86",tag:"[铃铛]",file:"emoji_86.png"},{id:"emoticon_emoji_87",tag:"[锁头]",file:"emoji_87.png"},{id:"emoticon_emoji_88",tag:"[放大镜]",file:"emoji_88.png"},{id:"emoticon_emoji_89",tag:"[灯泡]",file:"emoji_89.png"},{id:"emoticon_emoji_90",tag:"[锤头]",file:"emoji_90.png"},{id:"emoticon_emoji_91",tag:"[烟]",file:"emoji_91.png"},{id:"emoticon_emoji_92",tag:"[炸弹]",file:"emoji_92.png"},{id:"emoticon_emoji_93",tag:"[枪]",file:"emoji_93.png"},{id:"emoticon_emoji_94",tag:"[刀]",file:"emoji_94.png"},{id:"emoticon_emoji_95",tag:"[药]",file:"emoji_95.png"},{id:"emoticon_emoji_96",tag:"[打针]",file:"emoji_96.png"},{id:"emoticon_emoji_97",tag:"[钱袋]",file:"emoji_97.png"},{id:"emoticon_emoji_98",tag:"[钞票]",file:"emoji_98.png"},{id:"emoticon_emoji_99",tag:"[银行卡]",file:"emoji_99.png"},{id:"emoticon_emoji_100",tag:"[手柄]",file:"emoji_100.png"},{id:"emoticon_emoji_101",tag:"[麻将]",file:"emoji_101.png"},{id:"emoticon_emoji_102",tag:"[调色板]",file:"emoji_102.png"},{id:"emoticon_emoji_103",tag:"[电影]",file:"emoji_103.png"},{id:"emoticon_emoji_104",tag:"[麦克风]",file:"emoji_104.png"},{id:"emoticon_emoji_105",tag:"[耳机]",file:"emoji_105.png"},{id:"emoticon_emoji_106",tag:"[音乐]",file:"emoji_106.png"},{id:"emoticon_emoji_107",tag:"[吉他]",file:"emoji_107.png"},{id:"emoticon_emoji_108",tag:"[火箭]",file:"emoji_108.png"},{id:"emoticon_emoji_109",tag:"[飞机]",file:"emoji_109.png"},{id:"emoticon_emoji_110",tag:"[火车]",file:"emoji_110.png"},{id:"emoticon_emoji_111",tag:"[公交]",file:"emoji_111.png"},{id:"emoticon_emoji_112",tag:"[轿车]",file:"emoji_112.png"},{id:"emoticon_emoji_113",tag:"[出租车]",file:"emoji_113.png"},{id:"emoticon_emoji_114",tag:"[警车]",file:"emoji_114.png"},{id:"emoticon_emoji_115",tag:"[自行车]",file:"emoji_115.png"}],pmap:{emoticon_emoji_01:{tag:"[可爱]",file:"emoji_01.png"},emoticon_emoji_00:{tag:"[大笑]",file:"emoji_00.png"},emoticon_emoji_02:{tag:"[色]",file:"emoji_02.png"},emoticon_emoji_03:{tag:"[嘘]",file:"emoji_03.png"},emoticon_emoji_04:{tag:"[亲]",file:"emoji_04.png"},emoticon_emoji_05:{tag:"[呆]",file:"emoji_05.png"},emoticon_emoji_06:{tag:"[口水]",file:"emoji_06.png"},emoticon_emoji_145:{tag:"[汗]",file:"emoji_145.png"},emoticon_emoji_07:{tag:"[呲牙]",file:"emoji_07.png"},emoticon_emoji_08:{tag:"[鬼脸]",file:"emoji_08.png"},emoticon_emoji_09:{tag:"[害羞]",file:"emoji_09.png"},emoticon_emoji_10:{tag:"[偷笑]",file:"emoji_10.png"},emoticon_emoji_11:{tag:"[调皮]",file:"emoji_11.png"},emoticon_emoji_12:{tag:"[可怜]",file:"emoji_12.png"},emoticon_emoji_13:{tag:"[敲]",file:"emoji_13.png"},emoticon_emoji_14:{tag:"[惊讶]",file:"emoji_14.png"},emoticon_emoji_15:{tag:"[流感]",file:"emoji_15.png"},emoticon_emoji_16:{tag:"[委屈]",file:"emoji_16.png"},emoticon_emoji_17:{tag:"[流泪]",file:"emoji_17.png"},emoticon_emoji_18:{tag:"[嚎哭]",file:"emoji_18.png"},emoticon_emoji_19:{tag:"[惊恐]",file:"emoji_19.png"},emoticon_emoji_20:{tag:"[怒]",file:"emoji_20.png"},emoticon_emoji_21:{tag:"[酷]",file:"emoji_21.png"},emoticon_emoji_22:{tag:"[不说]",file:"emoji_22.png"},emoticon_emoji_23:{tag:"[鄙视]",file:"emoji_23.png"},emoticon_emoji_24:{tag:"[阿弥陀佛]",file:"emoji_24.png"},emoticon_emoji_25:{tag:"[奸笑]",file:"emoji_25.png"},emoticon_emoji_26:{tag:"[睡着]",file:"emoji_26.png"},emoticon_emoji_27:{tag:"[口罩]",file:"emoji_27.png"},emoticon_emoji_28:{tag:"[生气]",file:"emoji_28.png"},emoticon_emoji_29:{tag:"[抠鼻孔]",file:"emoji_29.png"},emoticon_emoji_30:{tag:"[疑问]",file:"emoji_30.png"},emoticon_emoji_31:{tag:"[怒骂]",file:"emoji_31.png"},emoticon_emoji_32:{tag:"[晕]",file:"emoji_32.png"},emoticon_emoji_33:{tag:"[呕吐]",file:"emoji_33.png"},emoticon_emoji_160:{tag:"[拜一拜]",file:"emoji_160.png"},emoticon_emoji_161:{tag:"[惊喜]",file:"emoji_161.png"},emoticon_emoji_162:{tag:"[流汗]",file:"emoji_162.png"},emoticon_emoji_163:{tag:"[卖萌]",file:"emoji_163.png"},emoticon_emoji_164:{tag:"[默契眨眼]",file:"emoji_164.png"},emoticon_emoji_165:{tag:"[烧香拜佛]",file:"emoji_165.png"},emoticon_emoji_166:{tag:"[晚安]",file:"emoji_166.png"},emoticon_emoji_34:{tag:"[强]",file:"emoji_34.png"},emoticon_emoji_35:{tag:"[弱]",file:"emoji_35.png"},emoticon_emoji_36:{tag:"[OK]",file:"emoji_36.png"},emoticon_emoji_37:{tag:"[拳头]",file:"emoji_37.png"},emoticon_emoji_38:{tag:"[胜利]",file:"emoji_38.png"},emoticon_emoji_39:{tag:"[鼓掌]",file:"emoji_39.png"},emoticon_emoji_200:{tag:"[握手]",file:"emoji_200.png"},emoticon_emoji_40:{tag:"[发怒]",file:"emoji_40.png"},emoticon_emoji_41:{tag:"[骷髅]",file:"emoji_41.png"},emoticon_emoji_42:{tag:"[便便]",file:"emoji_42.png"},emoticon_emoji_43:{tag:"[火]",file:"emoji_43.png"},emoticon_emoji_44:{tag:"[溜]",file:"emoji_44.png"},emoticon_emoji_45:{tag:"[爱心]",file:"emoji_45.png"},emoticon_emoji_46:{tag:"[心碎]",file:"emoji_46.png"},emoticon_emoji_47:{tag:"[钟情]",file:"emoji_47.png"},emoticon_emoji_48:{tag:"[唇]",file:"emoji_48.png"},emoticon_emoji_49:{tag:"[戒指]",file:"emoji_49.png"},emoticon_emoji_50:{tag:"[钻石]",file:"emoji_50.png"},emoticon_emoji_51:{tag:"[太阳]",file:"emoji_51.png"},emoticon_emoji_52:{tag:"[有时晴]",file:"emoji_52.png"},emoticon_emoji_53:{tag:"[多云]",file:"emoji_53.png"},emoticon_emoji_54:{tag:"[雷]",file:"emoji_54.png"},emoticon_emoji_55:{tag:"[雨]",file:"emoji_55.png"},emoticon_emoji_56:{tag:"[雪花]",file:"emoji_56.png"},emoticon_emoji_57:{tag:"[爱人]",file:"emoji_57.png"},emoticon_emoji_58:{tag:"[帽子]",file:"emoji_58.png"},emoticon_emoji_59:{tag:"[皇冠]",file:"emoji_59.png"},emoticon_emoji_60:{tag:"[篮球]",file:"emoji_60.png"},emoticon_emoji_61:{tag:"[足球]",file:"emoji_61.png"},emoticon_emoji_62:{tag:"[垒球]",file:"emoji_62.png"},emoticon_emoji_63:{tag:"[网球]",file:"emoji_63.png"},emoticon_emoji_64:{tag:"[台球]",file:"emoji_64.png"},emoticon_emoji_65:{tag:"[咖啡]",file:"emoji_65.png"},emoticon_emoji_66:{tag:"[啤酒]",file:"emoji_66.png"},emoticon_emoji_67:{tag:"[干杯]",file:"emoji_67.png"},emoticon_emoji_68:{tag:"[柠檬汁]",file:"emoji_68.png"},emoticon_emoji_69:{tag:"[餐具]",file:"emoji_69.png"},emoticon_emoji_70:{tag:"[汉堡]",file:"emoji_70.png"},emoticon_emoji_71:{tag:"[鸡腿]",file:"emoji_71.png"},emoticon_emoji_72:{tag:"[面条]",file:"emoji_72.png"},emoticon_emoji_73:{tag:"[冰淇淋]",file:"emoji_73.png"},emoticon_emoji_74:{tag:"[沙冰]",file:"emoji_74.png"},emoticon_emoji_75:{tag:"[生日蛋糕]",file:"emoji_75.png"},emoticon_emoji_76:{tag:"[蛋糕]",file:"emoji_76.png"},emoticon_emoji_77:{tag:"[糖果]",file:"emoji_77.png"},emoticon_emoji_78:{tag:"[葡萄]",file:"emoji_78.png"},emoticon_emoji_79:{tag:"[西瓜]",file:"emoji_79.png"},emoticon_emoji_80:{tag:"[光碟]",file:"emoji_80.png"},emoticon_emoji_81:{tag:"[手机]",file:"emoji_81.png"},emoticon_emoji_82:{tag:"[电话]",file:"emoji_82.png"},emoticon_emoji_83:{tag:"[电视]",file:"emoji_83.png"},emoticon_emoji_84:{tag:"[声音开启]",file:"emoji_84.png"},emoticon_emoji_85:{tag:"[声音关闭]",file:"emoji_85.png"},emoticon_emoji_86:{tag:"[铃铛]",file:"emoji_86.png"},emoticon_emoji_87:{tag:"[锁头]",file:"emoji_87.png"},emoticon_emoji_88:{tag:"[放大镜]",file:"emoji_88.png"},emoticon_emoji_89:{tag:"[灯泡]",file:"emoji_89.png"},emoticon_emoji_90:{tag:"[锤头]",file:"emoji_90.png"},emoticon_emoji_91:{tag:"[烟]",file:"emoji_91.png"},emoticon_emoji_92:{tag:"[炸弹]",file:"emoji_92.png"},emoticon_emoji_93:{tag:"[枪]",file:"emoji_93.png"},emoticon_emoji_94:{tag:"[刀]",file:"emoji_94.png"},emoticon_emoji_95:{tag:"[药]",file:"emoji_95.png"},emoticon_emoji_96:{tag:"[打针]",file:"emoji_96.png"},emoticon_emoji_97:{tag:"[钱袋]",file:"emoji_97.png"},emoticon_emoji_98:{tag:"[钞票]",file:"emoji_98.png"},emoticon_emoji_99:{tag:"[银行卡]",file:"emoji_99.png"},emoticon_emoji_100:{tag:"[手柄]",file:"emoji_100.png"},emoticon_emoji_101:{tag:"[麻将]",file:"emoji_101.png"},emoticon_emoji_102:{tag:"[调色板]",file:"emoji_102.png"},emoticon_emoji_103:{tag:"[电影]",file:"emoji_103.png"},emoticon_emoji_104:{tag:"[麦克风]",file:"emoji_104.png"},emoticon_emoji_105:{tag:"[耳机]",file:"emoji_105.png"},emoticon_emoji_106:{tag:"[音乐]",file:"emoji_106.png"},emoticon_emoji_107:{tag:"[吉他]",file:"emoji_107.png"},emoticon_emoji_108:{tag:"[火箭]",file:"emoji_108.png"},emoticon_emoji_109:{
tag:"[飞机]",file:"emoji_109.png"},emoticon_emoji_110:{tag:"[火车]",file:"emoji_110.png"},emoticon_emoji_111:{tag:"[公交]",file:"emoji_111.png"},emoticon_emoji_112:{tag:"[轿车]",file:"emoji_112.png"},emoticon_emoji_113:{tag:"[出租车]",file:"emoji_113.png"},emoticon_emoji_114:{tag:"[警车]",file:"emoji_114.png"},emoticon_emoji_115:{tag:"[自行车]",file:"emoji_115.png"},emoticon_emoji_116:{tag:"[撇嘴]",file:"new_emoji_01.png"},emoticon_emoji_117:{tag:"[难过]",file:"1f641.png"},emoticon_emoji_118:{tag:"[冷汗]",file:"1f628.png"},emoticon_emoji_119:{tag:"[抓狂]",file:"1f629.png"},emoticon_emoji_120:{tag:"[傲慢]",file:"1f615.png"},emoticon_emoji_121:{tag:"[困]",file:"1f62a.png"},emoticon_emoji_122:{tag:"[疯了]",file:"1f616.png"},emoticon_emoji_123:{tag:"[奋斗]",file:"1f4aa-1f3fc.png"},emoticon_emoji_124:{tag:"[白眼]",file:"new_emoji_02.png"},emoticon_emoji_125:{tag:"[衰]",file:"new_emoji_05.png"},emoticon_emoji_126:{tag:"[再见]",file:"new_emoji_06.png"},emoticon_emoji_127:{tag:"[哼哼]",file:"1f63e.png"},emoticon_emoji_128:{tag:"[阴险]",file:"1f608.png"},emoticon_emoji_129:{tag:"[饥饿]",file:"new_emoji_03.png"},emoticon_emoji_130:{tag:"[乒乓]",file:"new_emoji_23.png"},emoticon_emoji_131:{tag:"[猪头]",file:"1f437.png"},emoticon_emoji_132:{tag:"[玫瑰]",file:"new_emoji_25.png"},emoticon_emoji_133:{tag:"[凋谢]",file:"new_emoji_24.png"},emoticon_emoji_134:{tag:"[瓢虫]",file:"1f41e.png"},emoticon_emoji_135:{tag:"[月亮]",file:"new_emoji_30.png"},emoticon_emoji_136:{tag:"[礼物]",file:"new_emoji_28.png"},emoticon_emoji_137:{tag:"[拥抱]",file:"new_emoji_08.png"},emoticon_emoji_138:{tag:"[抱拳]",file:"new_emoji_18.png"},emoticon_emoji_139:{tag:"[勾引]",file:"new_emoji_19.png"},emoticon_emoji_140:{tag:"[差劲]",file:"new_emoji_20.png"},emoticon_emoji_141:{tag:"[爱你]",file:"new_emoji_21.png"},emoticon_emoji_142:{tag:"[NO]",file:"new_emoji_22.png"},emoticon_emoji_143:{tag:"[飞吻]",file:"new_emoji_10.png"},emoticon_emoji_144:{tag:"[微笑]",file:"1f642.png"},emoticon_emoji_146:{tag:"[吐舌头]",file:"1f61d.png"},emoticon_emoji_147:{tag:"[忧郁]",file:"new_emoji_11.png"},emoticon_emoji_148:{tag:"[尴尬]",file:"1f630.png"},emoticon_emoji_149:{tag:"[舒适]",file:"1f60c.png"},emoticon_emoji_150:{tag:"[不悦]",file:"1f612.png"},emoticon_emoji_151:{tag:"[幽灵]",file:"1f47b.png"},emoticon_emoji_152:{tag:"[礼盒]",file:"1f49d.png"},emoticon_emoji_153:{tag:"[拜托]",file:"1f64f-1f3fc.png"},emoticon_emoji_154:{tag:"[气球]",file:"1f388.png"},emoticon_emoji_155:{tag:"[拍掌]",file:"new_emoji_09.png"},emoticon_emoji_156:{tag:"[泪中带笑]",file:"1f602.png"},emoticon_emoji_157:{tag:"[糗大了]",file:"new_emoji_07.png"}},pmap2:{"[大笑]":"emoticon_emoji_00","[可爱]":"emoticon_emoji_01","[色]":"emoticon_emoji_02","[嘘]":"emoticon_emoji_03","[亲]":"emoticon_emoji_04","[呆]":"emoticon_emoji_05","[口水]":"emoticon_emoji_06","[汗]":"emoticon_emoji_145","[呲牙]":"emoticon_emoji_07","[鬼脸]":"emoticon_emoji_08","[害羞]":"emoticon_emoji_09","[偷笑]":"emoticon_emoji_10","[调皮]":"emoticon_emoji_11","[可怜]":"emoticon_emoji_12","[敲]":"emoticon_emoji_13","[惊讶]":"emoticon_emoji_14","[流感]":"emoticon_emoji_15","[委屈]":"emoticon_emoji_16","[流泪]":"emoticon_emoji_17","[嚎哭]":"emoticon_emoji_18","[惊恐]":"emoticon_emoji_19","[怒]":"emoticon_emoji_20","[酷]":"emoticon_emoji_21","[不说]":"emoticon_emoji_22","[鄙视]":"emoticon_emoji_23","[阿弥陀佛]":"emoticon_emoji_24","[奸笑]":"emoticon_emoji_25","[睡着]":"emoticon_emoji_26","[口罩]":"emoticon_emoji_27","[生气]":"emoticon_emoji_28","[抠鼻孔]":"emoticon_emoji_29","[疑问]":"emoticon_emoji_30","[怒骂]":"emoticon_emoji_31","[晕]":"emoticon_emoji_32","[呕吐]":"emoticon_emoji_33","[拜一拜]":"emoticon_emoji_160","[惊喜]":"emoticon_emoji_161","[流汗]":"emoticon_emoji_162","[卖萌]":"emoticon_emoji_163","[默契眨眼]":"emoticon_emoji_164","[烧香拜佛]":"emoticon_emoji_165","[晚安]":"emoticon_emoji_166","[强]":"emoticon_emoji_34","[弱]":"emoticon_emoji_35","[OK]":"emoticon_emoji_36","[拳头]":"emoticon_emoji_37","[胜利]":"emoticon_emoji_38","[鼓掌]":"emoticon_emoji_39","[握手]":"emoticon_emoji_200","[发怒]":"emoticon_emoji_40","[骷髅]":"emoticon_emoji_41","[便便]":"emoticon_emoji_42","[火]":"emoticon_emoji_43","[溜]":"emoticon_emoji_44","[爱心]":"emoticon_emoji_45","[心碎]":"emoticon_emoji_46","[钟情]":"emoticon_emoji_47","[唇]":"emoticon_emoji_48","[戒指]":"emoticon_emoji_49","[钻石]":"emoticon_emoji_50","[太阳]":"emoticon_emoji_51","[有时晴]":"emoticon_emoji_52","[多云]":"emoticon_emoji_53","[雷]":"emoticon_emoji_54","[雨]":"emoticon_emoji_55","[雪花]":"emoticon_emoji_56","[爱人]":"emoticon_emoji_57","[帽子]":"emoticon_emoji_58","[皇冠]":"emoticon_emoji_59","[篮球]":"emoticon_emoji_60","[足球]":"emoticon_emoji_61","[垒球]":"emoticon_emoji_62","[网球]":"emoticon_emoji_63","[台球]":"emoticon_emoji_64","[咖啡]":"emoticon_emoji_65","[啤酒]":"emoticon_emoji_66","[干杯]":"emoticon_emoji_67","[柠檬汁]":"emoticon_emoji_68","[餐具]":"emoticon_emoji_69","[汉堡]":"emoticon_emoji_70","[鸡腿]":"emoticon_emoji_71","[面条]":"emoticon_emoji_72","[冰淇淋]":"emoticon_emoji_73","[沙冰]":"emoticon_emoji_74","[生日蛋糕]":"emoticon_emoji_75","[蛋糕]":"emoticon_emoji_76","[糖果]":"emoticon_emoji_77","[葡萄]":"emoticon_emoji_78","[西瓜]":"emoticon_emoji_79","[光碟]":"emoticon_emoji_80","[手机]":"emoticon_emoji_81","[电话]":"emoticon_emoji_82","[电视]":"emoticon_emoji_83","[声音开启]":"emoticon_emoji_84","[声音关闭]":"emoticon_emoji_85","[铃铛]":"emoticon_emoji_86","[锁头]":"emoticon_emoji_87","[放大镜]":"emoticon_emoji_88","[灯泡]":"emoticon_emoji_89","[锤头]":"emoticon_emoji_90","[烟]":"emoticon_emoji_91","[炸弹]":"emoticon_emoji_92","[枪]":"emoticon_emoji_93","[刀]":"emoticon_emoji_94","[药]":"emoticon_emoji_95","[打针]":"emoticon_emoji_96","[钱袋]":"emoticon_emoji_97","[钞票]":"emoticon_emoji_98","[银行卡]":"emoticon_emoji_99","[手柄]":"emoticon_emoji_100","[麻将]":"emoticon_emoji_101","[调色板]":"emoticon_emoji_102","[电影]":"emoticon_emoji_103","[麦克风]":"emoticon_emoji_104","[耳机]":"emoticon_emoji_105","[音乐]":"emoticon_emoji_106","[吉他]":"emoticon_emoji_107","[火箭]":"emoticon_emoji_108","[飞机]":"emoticon_emoji_109","[火车]":"emoticon_emoji_110","[公交]":"emoticon_emoji_111","[轿车]":"emoticon_emoji_112","[出租车]":"emoticon_emoji_113","[警车]":"emoticon_emoji_114","[自行车]":"emoticon_emoji_115","[撇嘴]":"emoticon_emoji_116","[难过]":"emoticon_emoji_117","[冷汗]":"emoticon_emoji_118","[抓狂]":"emoticon_emoji_119","[傲慢]":"emoticon_emoji_120","[困]":"emoticon_emoji_121","[疯了]":"emoticon_emoji_122","[奋斗]":"emoticon_emoji_123","[白眼]":"emoticon_emoji_124","[衰]":"emoticon_emoji_125","[再见]":"emoticon_emoji_126","[哼哼]":"emoticon_emoji_127","[阴险]":"emoticon_emoji_128","[饥饿]":"emoticon_emoji_129","[乒乓]":"emoticon_emoji_130","[猪头]":"emoticon_emoji_131","[玫瑰]":"emoticon_emoji_132","[凋谢]":"emoticon_emoji_133","[瓢虫]":"emoticon_emoji_134","[月亮]":"emoticon_emoji_135","[礼物]":"emoticon_emoji_136","[拥抱]":"emoticon_emoji_137","[抱拳]":"emoticon_emoji_138","[勾引]":"emoticon_emoji_139","[差劲]":"emoticon_emoji_140","[爱你]":"emoticon_emoji_141","[NO]":"emoticon_emoji_142","[飞吻]":"emoticon_emoji_143","[微笑]":"emoticon_emoji_144","[吐舌头]":"emoticon_emoji_146","[忧郁]":"emoticon_emoji_147","[尴尬]":"emoticon_emoji_148","[舒适]":"emoticon_emoji_149","[不悦]":"emoticon_emoji_150","[幽灵]":"emoticon_emoji_151","[礼盒]":"emoticon_emoji_152","[拜托]":"emoticon_emoji_153","[气球]":"emoticon_emoji_154","[拍掌]":"emoticon_emoji_155","[泪中带笑]":"emoticon_emoji_156","[糗大了]":"emoticon_emoji_157"}});I$(50,function(e,t,i,n,o){var s=window.setting||{};n._$$Module=e._$klass();o=n._$$Module._$extend(t._$$EventTarget);o.__init=function(e){this.__super(e);this.__aktime=window.setInterval(this.__doUpdateACK._$bind(this),2e3)};o.__reset=function(e){this.__super(e)};o.__destroy=function(){window.clearInterval(this.__aktime);delete this.__aktime;this.__super()};o.__doUpdateACK=function(){var e=(s.appkey||"").toUpperCase();if(window.localStorage)localStorage.setItem("X-"+e+"-YSF-ACK",+new Date)}},15,60,83);I$(52,function(e,t,i,n,o,s,_,a,r,c,d,l){var u=window.setting||{};var f;var h=[];window.msgQueue=h;var m=function(e){for(var t=0;t<h.length;t++)if(h[t]==e)return!0;return!1};var p=function(){var e=!1;e=window.screenTop<-3e4&&window.screenLeft<-3e4;return e};a._$config({"user-add":{domain:window.setting.getKefuDomain,url:"/webapi/user/create.action",format:function(e){var t=e.info;e.result={token:t.token,account:t.accid,exchange:t.exchange}},onerror:function(e,t){if(4001==e.code)this._$dispatchEvent("onusererror");else this.__cbCreateYXUser(t.data.appkey,null);return!0}},"user-push-add":{domain:window.setting.getKefuDomain,url:"/webapi/user/create.action",format:function(e){var t=e.info;e.result={token:t.token,account:t.accid,exchange:t.exchange}}},"user-evaluate":{url:"/webapi/user/evaluate.action",format:function(e){e.result={code:e.code,desc:e.desc}}}});var $={NULL:0,INIT:1,CONNECTED:2};l=e._$klass();c=l._$extend(a._$$Cache);c.__init=function(){this.__step=2;this.__count=0;this.__state=$.NULL;this.__nopt={debug:window.MIN_DEBUG_MODE,syncTeams:!1,syncFriends:!1,syncRoamingMsgs:!1,syncTeamMembers:!1,syncFilter:!0,onmsg:this.__cbReceiveMessage._$bind(this),onofflinefiltermsgs:function(e){e.sort(function(e,t){return e.time-t.time});i._$forEach(e,function(e){this.__cbReceiveMessage(e,!0)},this)}._$bind(this),onofflinefiltercustomsysmsgs:function(e){e.sort(function(e,t){return e.time-t.time});i._$forEach(e,function(e){this.__onReceiveInstr(e,!0)},this)}._$bind(this),onerror:this.__onConnectError._$bind(this),onconnect:this.__cbConnect2Yunxin._$bind(this),ondisconnect:this.__onDisConnect._$bind(this),oncustomsysmsg:this.__onReceiveInstr._$bind(this)};this.__evalBox={};this.__sesTokenMap={};this.__super()};c.__doResetTimeout=function(){this.__count=0};c.__getNextTimeout=function(){var e=1e3*(this.__step+this.__step*this.__count);this.__count++;return e};c.__getDeviceID=function(){return u.device};c.__getUserInfo=function(){var e=this.__getDataInCache("yunxin-user");if(window.localStorage){var t="X-"+e.appKey.toUpperCase()+"-YSF-INFO",n=localStorage.getItem(t);if(!n)return;var o=i._$query2object(n);if(o.uid)e.fid=o.uid;o.source=n;if(!o.title){var s=i._$query2object(location.search.substr(1));var _=decodeURIComponent(s.t);o.title=_}return o}};c.__getForeignInfo=function(e){var t={email:"email",real_name:"name",mobile_phone:"mobile",avator:"avator"},n=JSON.parse(e.profile||"null")||[];
i._$forEach(n,function(i){var n=t[i.key];if(n){delete t[i.key];i.value=i.value||e[n]||u[n]||""}});i._$loop(t,function(t,i){var o=e[t]||u[t];if(null!=o)n.unshift({key:i,value:o})});return n};c.__getMessageBody=function(e){return{time:e.time,id:e.idServer,sid:this._$getSessionID(),msgIdClient:e.idClient,from:this._$getKefu(),to:{id:e.to}}};c.__onConnectError=function(){var e={302:function(){this._$dispatchEvent("onusererror")}};return function(t){var n=e[t.code];if(i._$isFunction(n))n.call(this);else if(i._$isString(n))e[n].call(this)}}();c.__doCreateYXUser=function(e){var t=this.__getDataInCache("yunxin-user");this.__offlineAckTimer=setInterval(function(){this.__setAckDvc(e);this.__setAckTime(e)}._$bind(this),2e3);if(!t)this.__doSendRequest("user-add",{data:{deviceid:this.__getDeviceID(e),appkey:e||""},onload:this.__cbCreateYXUser._$bind(this,e)});else this.__cbCreateYXUser(e,t)};c.__cbCreateYXUser=function(e,t){if(t){this.__setDataInCache("yunxin-user",t);this.__setDataInCache("corp-appkey",e);this.__doResetTimeout();t.appKey=e;t.exchange=t.exchange||[-1];t=i._$merge({},t,this.__nopt);window.nim=this.__nim=new NIM(t)}else window.setTimeout(this.__doCreateYXUser._$bind(this,e),this.__getNextTimeout())};c.__cbConnect2Yunxin=function(e){i._$merge(e,{staffid:u.staffid||0,groupid:u.groupid||0,qtype:u.qtype||0,robotShuntSwitch:u.robotShuntSwitch||0});if(window.__shuntdata__)i._$merge(e,{staffid:window.__shuntdata__.staffid,groupid:window.__shuntdata__.groupid,entryid:window.__shuntdata__.entryid});var t=this.__getDataInCache("yunxin-user"),n=this.__getUserInfo()||{},o=t.exchange[0];t.ip=t.ip||e.ip||"";if(this.__ktimer)window.clearTimeout(this.__ktimer);this.__ktimer=window.setTimeout(this.__doCheckKefuFail._$bind(this),15e3);var s=this.__tmpOnly2kefu;delete this.__tmpOnly2kefu;if(s)e.type=1;this.__nim.sendCustomSysMsg({to:o,cc:!0,filter:!0,scene:"p2p",content:JSON.stringify({cmd:1,deviceid:this.__getDeviceID(),exchange:o,foreignid:t.fid||"",fromTitle:n.title||"未知页面名称",fromPage:n.referrer||document.referrer,fromType:"WEB",fromIp:t.ip,fromSubType:[navigator.platform||"",navigator.userAgent||""].join(" - "),version:"7",stafftype:e.type||0,staffid:e.staffid||0,groupid:e.groupid||0,entryid:e.entryid||0,qtype:e.qtype||0,robotShuntSwitch:e.robotShuntSwitch||0}),done:function(t,i){if(!t);else window.setTimeout(this.__cbConnect2Yunxin._$bind(this,e),this.__getNextTimeout())}._$bind(this)})};c.__doCheckKefuFail=function(){if(!this.__isShuntFlow)this.__cbAllocateKefu({code:-1},{time:+new Date})};c.__cbAllocateKefu=function(){var e=function(e,t){var i=this._$getAppkey();if(e)clearTimeout(e);return setInterval(function(){try{var e=JSON.parse(localStorage.getItem(("YSF-SATISFY-"+i+"-"+t).toUpperCase())||"{}");if(!m(t)&&e.name){h.push(t);this._$dispatchEvent("onevalresult",{content:e.name});this._$dispatchEvent("onevalresultmsg",{content:e.name,sid:e.sid})}}catch(n){console.error("time:",+new Date)}}._$bind(this),2e3)};var t={200:function(t,n){this.__sessionId=t.sessionid;this.__satifyTimer=e.call(this,this.__satifyTimer,this.__sessionId);this.__sesTokenMap[t.sessionid]=t.session_token;var o=this.__getDataInCache("yunxin-kefu")||{};if(o.stafftype!==t.stafftype){if(1==t.stafftype)t.iconurl=t.iconurl||"";else t.iconurl=t.iconurl||u.portrait||"";if(~t.iconurl.indexOf("nos.netease.com"))t.iconurl+="?imageView&type=png|imageView&thumbnail=76y76&axis=5";this.__doClearQueueCheck();this.__setDataInCache("yunxin-kefu",t);this.__setDataInCache("evaluation",i._$merge(JSON.parse(t.evaluation||"{}"),{id:i._$uniqueID(),sid:this.__sessionId}));this.__state=$.CONNECTED;this._$dispatchEvent("onconnect",{time:n.time,id:t.staffid,sid:t.sessionid,nickname:t.staffname,isRobot:1==t.stafftype,groupname:t.groupname,hasKefuEntry:1==t.operator_enable,hasEvaluated:0==t.evaluation_enable});if(this.__xtimer)window.clearInterval(this.__xtimer);this.__xtimer=window.setInterval(this.__doCheckUserChange._$bind(this),500)}},201:function(e,t){this.__doClearQueueCheck();this.__state=$.CONNECTED;this._$dispatchEvent("onnokefu",e)},203:function(e,t){this.__doClearQueueCheck();this.__qtimer=window.setInterval(this.__doCheckQueue._$bind(this),1e4);this._$dispatchEvent("onqueuestart",{count:e.before})},x:function(e,t,i){this.__doClearQueueCheck();this.__state=$.NULL;this._$dispatchEvent(i,e);this.__nim.disconnect()}};return function(e,n){if(this.__ktimer)this.__ktimer=window.clearTimeout(this.__ktimer);var o=t[e.code];if(i._$isFunction(o))o.call(this,e,n);else t.x.call(this,e,n,"onkefuerror")}}();c.__doCheckQueue=function(){var e=this.__getDataInCache("yunxin-user");this.__nim.sendCustomSysMsg({cc:!0,filter:!0,scene:"p2p",to:e.exchange[0],content:JSON.stringify({cmd:16,deviceid:this.__getDeviceID()}),done:function(e,t){if(e);}})};c.__doClearQueueCheck=function(){if(this.__qtimer)this.__qtimer=window.clearInterval(this.__qtimer)};c.__onReceiveInstr=function(){var e=function(e,t){var n={image:"file",audio:"file",video:"file"};var t={type:e.type,time:t.time,msgIdClient:t.idClient,from:{id:-72},id:t.idServer,sid:t.isOffline?-100:this._$getSessionID(),to:{id:t.to}};return i._$merge(t,{content:n[e.type]?e.attach:e.attach.msg})};var t={"-1000":function(e,t){var i=1==e.fromtype?!0:!1;delete e.fromtype;var n=this.__getDataInCache("yunxin-kefu")||{};if(1!=n.stafftype&&e.sessionid==n.sessionid)this.__nim.sendCustomSysMsg({cc:i,filter:!1,to:t.from,scene:"p2p",content:JSON.stringify(e),done:function(e,t){if(e);}})},2:function(e,t){if(0==f){f=1;this._$dispatchEvent("onshuntstatus",f)}this.__cbAllocateKefu(e,t)},90:function(e,t){if(e.entries){this.__isShuntFlow=!0;var n=JSON.parse(e.entries),o=this.__getDataInCache("yunxin-kefu");this._$dispatchEvent("onshunt");if(o){this._$dispatchEvent("onconnect",{time:+new Date,isRobot:!1,hasKefuEntry:!0,twiceKefuEntry:!0});this._$dispatchEvent("shuntentries",{entries:n,label:e.message,from:{portrait:e.iconurl,id:-1,nickname:"shuntkefu"}})}else this._$dispatchEvent("shuntentries",{entries:n,from:i._$merge(this._$getKefu(),{portrait:e.iconurl}),label:e.message})}},6:function(e,t){var i=this.__evalBox[e.sessionid];var n={isSysClose:0==e["close_reason"]?!1:!0,evaluate:e.evaluate};if(1==e.evaluate&&!i){if(1!=e.keep_connection)this.__doDisConnect(n);else{this._$keepConnection=1;this.__doDelDisConnect(n)}this._$dispatchEvent("oneval")}else if(1!=e.keep_connection)this.__doDisConnect(n);else{this._$keepConnection=1;this.__doDelDisConnect(n)}},15:function(e,t){if(200!=e.code){if(302==e.code)this._$dispatchEvent("onqueuefail");this.__doClearQueueCheck()}else this._$dispatchEvent("onqueuechange",{count:e.before})},17:function(e,t){},60:function(e,t){var n=_._$parse(e);i._$forEach(n,function(e){var n=this.__getMessageBody(t);this._$dispatchEvent("onmessage",i._$merge(n,e))},this)},70:function(e,t){this._$dispatchEvent("onovertime",{msg:e.message,time:e.timestamp})},95:function(e,t){this._$setSessionID(e.sessionid);this.__sesTokenMap[e.sessionid]=e.session_token;this.__sessionId=e.sessionid;this.__updateKefuName(e.staffname);this._$dispatchEvent("ontransferresult",{sessionId:e.sessionid,staffId:e.staffid,staffName:e.staffname})},72:function(t,i){var n={question:function(t,i){if(!m(i.idClient))this._$dispatchEvent("onmessage",e.call(this,t,i))}};if(n[t.type])n[t.type].call(this,t,i);else this._$dispatchEvent("onmessage",e.call(this,t,i))},134:function(e,t){var n={type:"push-msg",msgType:t.type,msgSessionId:t.ext.msgSessionId,content:t.text,from:this._$getKefu(),id:t.idServer,msgIdClient:t.idClient};var o=1,s=1;if(!this._$chatNoKefu){if(!document.hidden&&!p()&&1==this.__sdkWindowStatus){this._$sendPushMsgStatus(2,[n.msgSessionId]);s=0}if(1==this._$hasList){this._$dispatchEvent("onmessage",n);o=0}this._$dispatchEvent("onpushmessage",i._$merge(n,{append:o,sdkAppend:s}))}},200:function(e,t){var n=this.__getMessageBody(t);this._$dispatchEvent("receivethirdorder",i._$merge(n,e))}};t["17"]=t["6"];return function(e,n,o){var s=e.content||"";try{s=JSON.parse(s);if(n&&!n[s.cmd]&&!o)return}catch(_){}var a=t[s.cmd||o];if(i._$isFunction(a))a.call(this,s,e)}}();c.__cbReceiveMessage=function(){var e={image:"file",audio:"file",video:"file"};var t={60:!0,90:!0,95:!0,72:!0,200:!0};var n={2:134};return function(o,s){if("custom"!=o.type)if(!/##/gi.test(o.idClient))this._$dispatchEvent("onmessage",{type:o.type,time:o.time,id:o.idServer,sid:s?-100:this._$getSessionID(),content:o[e[o.type]||o.type],from:s?{id:-100}:this._$getKefu(),to:{id:o.to},msgIdClient:o.idClient});else{var _=o.idClient.split("##"),a=_[0],r=_[1];i._$merge(o,{ext:{type:r,msgSessionId:a}});this.__onReceiveInstr(o,t,n[o.ext.type])}else{o.isOffline=s;this.__onReceiveInstr(o,t)}}}();c.__doDisConnect=function(e){this.__state=$.NULL;var t=i._$merge({time:+new Date},e);this.__delDataInCache("yunxin-kefu");this._$dispatchEvent("onfinish",t);this.__nim.disconnect()};c.__doDelDisConnect=function(e){this.__state=$.NULL;var t=i._$merge({time:+new Date},e);this.__delDataInCache("yunxin-kefu");this._$dispatchEvent("onfinish",t)};c.__onDisConnect=function(e){this.__doClearQueueCheck();this.__delDataInCache("yunxin-kefu");if(this.__xtimer)this.__xtimer=window.clearInterval(this.__xtimer);if(this.__offlineAckTimer)this.__offlineAckTimer=window.clearInterval(this.__offlineAckTimer);if(this.__state!==$.NULL){this.__state=$.NULL;if(e.kicked)this._$dispatchEvent("onkickout");else this._$dispatchEvent("ondisconnect")}};c.__doCheckUserChange=function(){var e=this.__getUserInfo(),t=this;if(e)if(this.__last!=e.source){this.__last=e.source;var i=this.__getDataInCache("yunxin-user"),n=i.exchange[0];this.__nim.sendCustomSysMsg({to:n,cc:!0,filter:!0,scene:"p2p",content:JSON.stringify({cmd:52,foreignid:e.uid,userinfo:JSON.stringify(this.__getForeignInfo(e))}),done:function(e,t){}})}};c._$getVisitor=function(){var e=this.__getDataInCache("yunxin-user");return{id:e.account}};c._$getAppkey=function(){return u.appkey||this.__getDataInCache("corp-appkey")};c._$getKefu=function(){var e=this.__getDataInCache("yunxin-kefu");if(!e)return{};else return{id:e.staffid,
portrait:e.iconurl,nickname:e.staffname}};c._$getEvaluation=function(){return this.__getDataInCache("evaluation")||{}};c._$getSessionID=function(){return(this.__getDataInCache("yunxin-kefu")||{}).sessionid||this.__sessionId};c._$setSessionID=function(e){(this.__getDataInCache("yunxin-kefu")||{}).sessionid=e};c.__updateKefuName=function(e){(this.__getDataInCache("yunxin-kefu")||{}).staffname=e};c._$isRobot=function(){return 1==(this.__getDataInCache("yunxin-kefu")||{}).stafftype};c._$connect=function(e,t,i){if(window.nim){window.nim.disconnect();delete window.nim}if(e.appkey||e.token){if(this.__state===$.NULL){this.__state=$.INIT;this.__doResetTimeout();e=e||{};this.__tmpOnly2kefu=t;if(i)this._$dispatchEvent("reconnect");if(!e.token)this.__doCreateYXUser(e.appkey);else this.__cbCreateYXUser(e.appkey,e)}}else this._$dispatchEvent("onusererror",{data:e})};c._$pushMsgConnect=function(e,t,n){if(window.nim){window.nim.disconnect();delete window.nim}this.__doSendRequest("user-push-add",{data:{deviceid:this.__getDeviceID(),appkey:e||""},onload:function(o){o.appKey=e;o.exchange=o.exchange||[-1];o=i._$merge({},o,this.__nopt,{onerror:function(){},onconnect:function(){this._$sendPushMsg(t,n)}._$bind(this),ondisconnect:function(){},oncustomsysmsg:function(){}});window.nim=this.__nim=new NIM(o)}._$bind(this)})};c._$isInQueue=function(){return!!this.__qtimer};c._$canSendMessage=function(){return this._$isInQueue()||this.__state===$.CONNECTED};c._$isDelay=function(){return!!this.__delay};c._$sendMessage=function(){var e=function(e){var t={c:e.content.file,m:"sendFile"};var n=e.content.file;if(i._$isString(n))if(0===n.indexOf("data:image"))t.r="dataURL";else{t.r="file";t.c={url:n,size:1,md5:n,ext:"png",w:1,h:1}}else if("INPUT"===n.tagName)t.r="fileInput";else if(n.md5)t.r="file";else t.r="blob";return t};var t={image:e,audio:e,video:e,file:e,geo:{m:"sendGeo",r:"geo"},text:{m:"sendText",r:"text"}};return function(e){if(this._$canSendMessage()){var n=t[e.type];if(i._$isFunction(n))n=n.call(this,e);if(n){var o=this.__getDataInCache("yunxin-user"),s=i._$merge({cc:!0,filter:!0,scene:"p2p",to:o.exchange[0]},e);s[n.r]=n.c||s.content;delete s.content;return this.__nim[n.m](s)}else(e.done||d)({code:-2,message:"消息类型不支持"})}else(e.done||d)({code:-1,message:"长连接未建立"})}}();c._$updateEvaluate=function(e,t,i,n){e=parseInt(e,10);var o=this.__sesTokenMap[e];if(o){this.__evalBox[e]=!0;h.push(e);this.__doSendRequest("user-evaluate",{data:{sessionid:e,session_token:o,evaluation:t,fromtype:"web",remarks:i},onload:function(){var o={sid:e,value:t,name:n,remarks:i};window.localStorage.setItem(("YSF-SATISFY-"+this._$getAppkey()+"-"+e).toUpperCase(),JSON.stringify(o))},onerror:function(){window.setTimeout(this._$updateEvaluate._$bind(this,e,t,i),1e4)}._$bind(this)})}};c._$syncRobot=function(e){if(this._$canSendMessage()){var t=this.__getDataInCache("yunxin-user"),n=this.__getDataInCache("yunxin-kefu"),o=i._$merge({cmd:61},e);this.__nim.sendCustomSysMsg({to:t.exchange[0],cc:!0,filter:!0,scene:"p2p",content:JSON.stringify(o),done:function(t){if(t)window.setTimeout(this._$syncRobot._$bind(this,e),1e4)}._$bind(this)})}};c._$syncRobotEx=function(e){var t={matched_question:"question",id:"questionid"};var n=function(e){var i={};for(var n in e)if(t[n])i[t[n]]=e[n];else i[n]=e[n];return i};if(this._$canSendMessage()){var o=this.__getDataInCache("yunxin-user"),s=this.__getDataInCache("yunxin-kefu"),_=i._$uniqueID(),a=i._$merge({cmd:63},n(e),{msgIdClient:_});this.__nim.sendCustomSysMsg({to:o.exchange[0],cc:!0,filter:!0,scene:"p2p",content:JSON.stringify(a),done:function(t,i){if(!t)h.push(_);else window.setTimeout(this._$syncRobotEx._$bind(this,e),1e4)}._$bind(this)})}};c._$action=function(){var e={kefu:function(e){if(this._$isRobot())this.__cbConnect2Yunxin({type:1})}};return function(t,n){var o=e[t];if(i._$isFunction(o))o.call(this,n)}}();c._$sendOfflineMessage=function(e){var t=this.__getDataInCache("yunxin-user");this.__nim.sendCustomSysMsg({cc:!0,filter:!0,scene:"p2p",to:t.exchange[0],content:JSON.stringify({cmd:83,message:e.content||"",mobile:e.mobile||"",email:e.email||""}),done:e.done})};c._$sendSelectShunt=function(e){var t={type:1};i._$merge(t,e);f=0;this.__cbConnect2Yunxin(t)};c._$sendKefuHeart=function(e){var t=this,i=8e3;var n=this.__getDataInCache("yunxin-user");var o=function(){if(e)t.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:n.exchange[0],scene:"p2p",content:JSON.stringify({cmd:-1e3,sessionid:e}),done:function(e,n){if(t.__timeout)clearTimeout(t.__timeout);t.__timeout=setTimeout(function(){o()},i)}})};o()};c.__sender3rdProductsInfo=function(e){var t=this.__getDataInCache("yunxin-user"),n=this.__getUserInfo(),o=this,s=o.__getProductInfo();var _=function(){o.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:t.exchange[0],scene:"p2p",content:JSON.stringify(i._$merge({cmd:121},s)),done:function(t,n){if(!t)e(i._$merge({id:i._$uniqueID(),type:"productinfo"},s));else o._$dispatchEvent("onproducterror",{type:"product-error",content:"商品链接参数错误"})}})};if(s)_()};c.__getProductInfo=function(){var e=this.__getDataInCache("yunxin-user");var t="X-"+e.appKey.toUpperCase()+"-YSF-PRODUCT",n=localStorage.getItem(t);return null==n?null:i._$query2object(n)};c.__setAckDvc=function(e){var t="YSF-"+e.toUpperCase()+"-DVCTIME";window.localStorage.setItem(t,+new Date)};c.__setAckTime=function(e){var t="YSF-"+e+"-MSGTIME";if(!document.hidden&&!p()&&1==this.__sdkWindowStatus)window.localStorage.setItem(t,+new Date)};c.__confirmAckDvc=function(e){var t="YSF-"+e.toUpperCase()+"-DVCTIME",o=this.__getDeviceID(),s=2100,_=+new Date;if(Math.abs(_-Number(window.localStorage.getItem(t)))>s){var a=n._$md52hex(i._$uniqueID()+"-"+ +new Date);window.localStorage.setItem(o,a)}};c._$sendPrdMsg=function(){var e=this;if(window.localStorage){var t="X-"+this.__getDataInCache("yunxin-user").appKey.toUpperCase()+"-YSF-PRODUCT",n=localStorage.getItem(t),o="YSF-PRODUCT-"+this.__sessionId+"-last",s=localStorage.getItem(o);if(n&&n!=s)this.__sender3rdProductsInfo(function(s){window.localStorage.setItem(o,n);window.localStorage.removeItem(t);e._$dispatchEvent("onmessage",i._$merge({from:{id:-72}},s))})}};c._$sendPushMsg=function(e,t){e=e||[];for(var i=0;i<e.length;i++){var n=1==t?{cmd:133,deviceid:this.__getDeviceID(),msgId:e[i]}:{cmd:133,deviceid:this.__getDeviceID(),batchId:e[i]};this.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:-1,scene:"p2p",content:JSON.stringify(n),done:function(e,t){}})}};c._$sendPushMsgStatus=function(e,t){for(var i=0;i<t.length;i++)this.__nim.sendCustomSysMsg({cc:!0,filter:!1,to:-1,scene:"p2p",content:JSON.stringify({cmd:135,msgSessionId:t[i],status:e}),done:function(e,t){}})};c._$sendThirdOrder=function(e){var t=this.__getDataInCache("yunxin-user");var n=this;n._$dispatchEvent("onvisitormessage",i._$merge(e,{cmd:201,type:"crm-thirdorder"}));this.__nim.sendCustomSysMsg({to:t.exchange[0],cc:!0,filter:!0,scene:"p2p",content:JSON.stringify({cmd:201,status:e.status,content:e.content}),done:function(e){if(!e);else console.log(e)}._$bind(this)})};return l._$allocate()},15,16,1,3,82,83,80,81);I$(51,function(e,t,i,n,o,s,_,a,r,c,d){var l={};var u=[];var f=function(e,i){var n=i.msgIdClient;if(null==n||void 0==n)return!1;var o=t._$indexOf(e,function(e){var t=e.msgIdClient;if(null!=t&&n==t&&e.type==i.type)return!0});return o>=0};var h=function(e,t){for(var i=0;i<e.length;i++)if(e[i].id==t.id)return!0;return!1};a._$config({"msg-all":{method:"POST",url:"/webapi/user/message.action",format:function(e,n){var o=e.result,s=this._$getListInCache("msg-all"),_=[];t._$reverseEach(s,function(e,t){for(var i=o.length-1;i>=0;i--)if(o[i].msgIdClient==e.msgIdClient){s.splice(t,1);u.push(e);_.push(i)}});t._$reverseEach(_,function(e,t){o.splice(t)});o.sort(function(e,t){return e.time>t.time?1:-1});this.__doSplitQAList(o);this.__doParseProductList(o);this.__doParseMsg(o);this.__doParseCrmList(o);if(n.ext&&n.ext.reconnect&&1==window.setting.dialogStyle){o.forEach(function(e){e.id=t._$uniqueID();this.__addItem({key:"msg-all",push:!0},e)}._$bind(this));i._$dispatchEvent(this.constructor,"listchange",{action:"refresh",key:"msg-all"})}}}});c._$completeURL=function(e){return o._$decode(e)};c._$$Cache=e._$klass();d=c._$$Cache._$extend(a._$$Cache);d.__init=function(){var e=!1;return function(t){if(!e){e=!0;r._$addEvent("onmessage",this.__cbReceiveMessagePkg._$bind(this));r._$addEvent("oneval",this.__cbReceiveEvaluate._$bind(this));r._$addEvent("onevalresult",this.__cbReceiveResultEvaluate._$bind(this));r._$addEvent("shuntentries",this.__cbShuntEntries._$bind(this));r._$addEvent("receivethirdorder",this.__cbReceiveThirdOrderMsg._$bind(this));r._$addEvent("reconnect",this.__cbReconnect._$bind(this));r._$addEvent("onvisitormessage",this.__cbVisitorMessage._$bind(this))}this.__super(t)}}();d.__doLoadList=function(e){e.onerror=function(t){e.onload&&e.onload(null)};e.data=t._$merge(e.data,{k:r._$getAppkey(),u:r.__getDeviceID()});var i=(e.key||"").split("-");this.__doSendRequest(i[0]+"-"+i[1],e)};d.__doFormatItem=function(e){if(e){if("image"===e.type){var i=e.content.url||"";if(i.indexOf("nos.netease.com")>=0&&i.indexOf("?")<0){e.content.origin=i;e.content.url=i+"?imageView&thumbnail=1500x850";e.content.thumb=i+"?imageView&thumbnail=120x120";var n=this.__getDataInCacheWithDefault("nos-cache",{});n[e.content.url]=e.content}}var s=e.content;if(t._$isString(s))e.richContent=o._$encode(s)}};d.__doMapRobotQA=function(){var e=/<a\s(.*?)>/gi;var i=function(t){return(t||"").replace(e,'<a target="_blank" $1>')};return function(e,n){var o=this.__getDataInCacheWithDefault("robot-qa-list",{});t._$forEach(e,function(e){var s=e.id;if(!s){s=t._$uniqueID();e.id=s;e.randomId=!0}o[s]=e;e.origin=n;e.answer=i(e.answer)})}}();d.__cbReceiveMessagePkg=function(e){var t=function(){var e=!1;e=window.screenTop<-3e4&&window.screenLeft<-3e4;return e};if(1==window.setting.dialogStyle){if(this.__checkAckTimeout(r._$getAppkey())){var i=r._$getKefu();if(this.__notifyTimer)clearTimeout(this.__notifyTimer);this.__notifyTimer=setTimeout(function(){this.__sendMsgToSDK(e);
if(null==localStorage.getItem("YSF-MSGID-"+e.id)){localStorage.setItem("YSF-MSGID-"+e.id,1);s._$notifyMessage(e,i.nickname)}}._$bind(this),100*setting.dvcTimer)}}else if(document.hidden||t()){var i=r._$getKefu();s._$notifyMessage(e,i.nickname)}this.__cbReceiveMessage(e)};d.__cbReceiveMessage=function(){var e=function(e,i){var n=i.msgIdClient;if(null==n||void 0==n)return!1;var o=t._$indexOf(e,function(e){var t=e.msgIdClient;if(null!=t&&n==t)return!0});return o>=0};return function(t){var n=this._$getListInCache("msg-all");if(!e(n,t)&&!e(u,t)){if("qa-list"==t.type)this.__doMapRobotQA(t.list,t.origin);var o="msg-all",s=this.__doSaveItemToCache(t),n=this._$getListInCache(o);n.push(s);i._$dispatchEvent(this.constructor,"listchange",{flag:1,key:o,data:s,action:"add"})}}}();d.__cbReceiveEvaluate=function(){var e=t._$uniqueID();i._$dispatchEvent(this.constructor,"onevalmsgid",e);this.__cbReceiveMessage({id:e,sid:r._$getSessionID(),type:"eval-show",category:r._$getEvaluation().type,time:+new Date,isval:!1})};d.__cbReceiveResultEvaluate=function(e){this._$recieveEvalMessage(t._$merge(e,{id:r._$getEvaluation().id,sid:r._$getSessionID(),type:"eval-show",time:+new Date,isval:!0}))};d._$sendAction=function(e,t){r._$action(e,this._$getItemInCache(t))};d._$sendOfflineMessage=function(e){var t=e.content||{};e.mobile=t.mobile;e.email=t.email;e.content=t.content;e.done=function(e,t){this._$dispatchEvent("onofflinemsgsend",{success:!e})}._$bind(this);r._$sendOfflineMessage(e)};d._$getRobotItem=function(e){return this.__getDataInCacheWithDefault("robot-qa-list",{})[e]};d._$sendRobotMessage=function(e){var i=this.__getDataInCacheWithDefault("robot-qa-list",{})[e];if(i){r._$syncRobotEx({original_question:i.origin,matched_question:i.question,answer:i.answer,id:i.randomId?"":i.id});if(i.question)this.__cbReceiveMessage({type:"text",time:+new Date,id:t._$uniqueID(),sid:r._$getSessionID(),content:i.question,from:r._$getVisitor(),to:r._$getKefu()});if(i.answer,!1)this.__cbReceiveMessage({type:"rich",time:+new Date,id:t._$uniqueID(),sid:r._$getSessionID(),content:i.answer,to:r._$getVisitor(),from:r._$getKefu()})}};d._$sendEvalMessage=function(e,n){var o={id:e.id,type:"eval-show",content:e.name,value:e.evaluation||0,isval:!0};o=t._$merge(this._$getItemInCache(e.id),o);this.__doSaveItemToCache(o,"msg-all");i._$dispatchEvent(this.constructor,"listchange",{data:o,key:"msg-all",flag:1,action:n?"add":"update"});r._$updateEvaluate(e.sid,e.evaluation,encodeURIComponent(e.remarks),e.name)};d._$recieveEvalMessage=function(e){var n={id:e.id,type:"eval-show",content:e.content,value:e.evaluation||0,isval:!0};n=t._$merge(this._$getItemInCache(e.id),n);var o=this._$getListInCache("msg-all"),s=f(o,n),_=f(u,n);this.__doSaveItemToCache(n,"msg-all");if(!s&&!_){o.push(n);i._$dispatchEvent(this.constructor,"listchange",{data:n,key:"msg-all",flag:1,action:s?"update":"add"})}};d._$sendMessage=function(e){if(e.content){if("image"===e.type){if(!e.content.file){this._$dispatchEvent("onerror",{code:"NotAnImage",message:"NotAnImage(请求对象不是合法图片)(上传文件失败)"});return}var n=this._$getImageByURL(e.content.file);if(n)e.content.file=n}var o;if(!e.id){o=t._$merge({state:1,id:"auto-"+t._$uniqueID(),sid:r._$getSessionID(),from:r._$getVisitor(),time:+new Date},e);this.__cbReceiveMessage(o)}else{o=this._$getItemInCache(e.id);o.state=1;i._$dispatchEvent(this.constructor,"listchange",{data:o,key:"msg-all",action:"update"})}var s=this.constructor,_=function(){i._$dispatchEvent(s,"listchange",{data:o,key:"msg-all",action:"update"})};e.uploaddone=function(t,i){if(!t){o.content=i;this.__doFormatItem(this._$getItemInCache(o.id))}else{o.state=-1;o.error=t}this._$dispatchEvent("onfileupload",{data:e})}._$bind(this);if(!e.done)e.done=function(e,n){o.error=e;o.time=(n||{}).time||o.time;if(e){if(!n){console.error(e.message);return}o.state=-1;o.idClient=n.idClient;if("NotAnImage"===e.code){this._$dispatchEvent("onerror",e);var s=this._$getListInCache("msg-all"),a=t._$indexOf(s,o);if(a>=0)s.splice(a,1);i._$dispatchEvent(this.constructor,"listchange",{data:o,key:"msg-all",action:"delete"});return}}else{o.state=0;o.msgIdClient=n.idClient;var r=o.content.url;if(r){var c=new Image;c.onload=_;c.onerror=_;c.src=r;return}}_()}._$bind(this);r._$sendMessage(e)}};d._$reSendMessage=function(e){var t=this._$getItemInCache(e);if(t)this._$sendMessage({resend:!0,id:t.id,type:t.type,content:t.content,idClient:t.idClient})};d._$getImageByURL=function(e){var i=this.__getDataInCacheWithDefault("nos-cache",{})[e];if(i)return t._$merge({},i,{url:i.origin||i.url})};d._$getAudioURL=function(e,t){t=t||function(){};var i=this._$getItemInCache(e);if(i){var n=i.content.url||"";if(!(n.indexOf("nos.netease.com")>=0))this.__doSendRequest("msg-audio",{query:{id:e},onload:function(e){if(200!=e.code)t();else{i.content.url=e.result;t(e.result)}},onerror:function(e){t()}});else t(n)}else t()};d.__cbShuntEntries=function(e){var n={};var o=this._$getListInCache("msg-all");t._$merge(n,{list:e.entries,from:e.from,type:"shunt",id:0,label:e.label});i._$dispatchEvent(this.constructor,"listchange",{data:n,key:"msg-all",action:"add",flag:1})};d.__doSplitQAList=function(e){t._$reverseEach(e,function(e,i,n){if("qa"==e.type){var o=JSON.parse(e.content||"null"),s=_._$parse(o);t._$forEach(s,function(i,n,o){o[n]=t._$merge({},e,i)});s.unshift(i,1);n.splice.apply(n,s)}})};d.__doParseMsg=function(e){var i=this;var n={image:function(e){try{var t=JSON.parse(e.content);e.content=t;n["text"](e)}catch(i){n["text"](e)}},text:function(e){var t=i._$getListInCache("msg-all");if(f(t,e)||f(u,e))e.type="custom";e.from=r._$getKefu()||{};if(1==e.fromUser)e.from.id=-1;else e.from.id=-100},productinfo:function(e){try{var i=JSON.parse(e.content);t._$merge(e,i);n["text"](e)}catch(o){n["text"](e)}},"qa-list":function(e){i.__doMapRobotQA(e.list,e.origin);e.from=r._$getKefu()||{};if(1==e.fromUser)e.from.id=-1;else e.from.id=-100}};n["audio"]=n["action"]=n["rich"]=n["image"];e.forEach(function(e){if(n[e.type])n[e.type](e)})};d.__doParseProductList=function(e){var i,n={121:"productinfo"};t._$forEach(e,function(e,o){i=null;try{i=JSON.parse(e.content);if(i&&n[i.cmd]){e=t._$merge(e,{type:n[i.cmd]});e.product=i}}catch(s){}},this)};d.__doParseCrmList=function(e){var i=this;var n,o={201:function(e){if(200==n.status)t._$merge(e,n,{type:"crm-thirdorder",content:{list:[n.content]}});else t._$merge(e,n,{type:"crm-thirdorder"})},200:function(e){t._$merge(e,n,{type:"crm-thirdorder"})}};t._$forEach(e,function(e,t){try{n=JSON.parse(e.content);if(n&&o[n.cmd]){e.from=r._$getKefu()||{};if(1==e.fromUser)e.from.id=-1;else e.from.id=-100;o[n.cmd].call(i,e)}}catch(s){}})};d.__sendMsgToSDK=function(e){e.category="notify";parent.postMessage("pkg:"+JSON.stringify(e),"*")};d.__checkAckTimeout=function(e){var t="YSF-"+e+"-MSGTIME",i=parseInt(window.localStorage.getItem(t)),n=+new Date;if(Math.abs(n-i)>2100)return!0;else return!1};d.__cbReconnect=function(){this.__doLoadList({data:{limit:1e5,offset:0},key:"msg-all",ext:{reconnect:1}})};d.__cbReceiveThirdOrderMsg=function(e){e.type="crm-thirdorder";i._$dispatchEvent(this.constructor,"listchange",{flag:1,key:"msg-all",data:e,action:"add"})};d.__cbVisitorMessage=function(e){e=t._$merge({id:"auto-"+t._$uniqueID(),sid:r._$getSessionID(),from:r._$getVisitor(),time:+new Date},e);var n={201:function(e){if(200==e.status)e.content={list:[e.content]}}};var o=n[e.cmd];if(o)o.call(this,e);var s="msg-all",_=this.__doSaveItemToCache(e),a=this._$getListInCache(s);a.push(_);i._$dispatchEvent(this.constructor,"listchange",{flag:1,key:s,data:_,action:"add"})};c._$do=a._$do._$bind(null,c._$$Cache);n._$$CustomEvent._$allocate({element:c._$$Cache,event:["listchange","onevalmsgid"]});c._$$Cache._$allocate()},15,1,16,44,29,54,80,81,52);I$(125,'<textarea name="ntp" id="#<photoBody>">\n  <div class="m-modal m-modal-confirm m-modal-confirmphoto">\n      <div class="modal_dialog">\n          <div class="modal_hd">\n              <h3 class="modal_title">发送图片</h3>\n          </div>\n          <div class="modal_bd">\n              <div class="content j-flag"></div>\n          </div>\n          <div class="modal_ft">\n              <button class="u-btn ok j-flag">发送</button>\n              <button class="u-btn-cancel cancel j-flag">取消</button>\n          </div>\n      </div>\n  </div>\n</textarea>\n<textarea name="jst" id="#<photoList>">\n    {list photos as x}\n    {if x_length>1}\n    <div class="photo-wrap" style="background-image:url(${x.url})">&nbsp;</div>\n    {else}\n    <div class="photo-wrap"><img src="${x.url}"/></div>\n    {/if}\n    {/list}\n</textarea>');I$(73,function(e,t,i,n,o,s,_,a,r,c){r._$$PhotoViewer=e._$klass();c=r._$$PhotoViewer._$extend(n._$$Abstract);c.__reset=function(e){this.__super(e);this.__doInitDomEvent([[this.__nok,"click",this.__onOK._$bind(this)],[this.__ncc,"click",this.__onCC._$bind(this)]]);this.__scrollbar=_._$$Scrollbar._$allocate({parent:this.__lbox});this.__list=e.photos||[];s._$render(this.__lbox,this.__seed_list,{photos:this.__list});this.__doUpdateClass(this.__list.length);this.__nok.focus()};c.__destroy=function(){this.__scrollbar._$recycle();this.__lbox.innerHTML="";delete this.__scrollbar;delete this.__list;this.__super()};c.__initXGui=function(){var e=o._$parseUITemplate(a);return function(){this.__seed_list=e.photoList;this.__seed_html=e.photoBody}}();c.__initNode=function(){this.__super();var e=t._$getByClassName(this.__body,"j-flag");this.__lbox=e[0];this.__nok=e[1];this.__ncc=e[2]};c.__doUpdateClass=function(){var e=["z-second","z-more"];return function(i){var n="";if(2==i)n=e[0];else if(i>2)n=e[1];t._$replaceClassName(this.__lbox.parentNode,e.join(" "),n)}}();c.__onOK=function(){this._$dispatchEvent("onok",{data:this.__list});this._$recycle()};c.__onCC=function(){this._$dispatchEvent("oncc");this._$recycle()};r._$preview=function(e){var t={parent:document.body};r._$$PhotoViewer._$allocate(i._$merge(t,e))}},15,17,1,72,2,18,57,125);I$(76,'<textarea name="ntp" id="#<cnt>">\n  <div class="f-dn">\n  \t<div class="j-flag portrait_cnt"></div>\n  </div>\n</textarea>\n\n<textarea name="jst" id="#<list>">\n\t<div class="portrait_list f-clr j-list">\n\t\t{list plist as p}\n\t\t<!-- 行开始 -->\n\t\t{if (p_index + 1) % col === 1}\n\t\t<ul class="f-clr">\n\t\t{/if}\n\t\t<!-- 行开始end -->\n\t\t\t<li><i class="portrait_img portrait_icon_${p.file|reduceExt}" data-src="${prefix}${p.file}" data-id="${p.id}" title="${p.tag}" alt="${p.tag}"></i></li>\n\t\t<!-- 行结束 -->\n\t\t{if p_index % col === col-1}\n\t\t</ul>\n\t\t{/if}\n\t\t<!-- 行结束end -->\n\t\t{/list}\n\t</div>\n</textarea>');
I$(22,function(e,t,i,n,o,s,_,a,r,c,d,l){var u="PORTRAIT_"+n._$uniqueID(),f=appConfig.path.sdk+"res/portrait/emoji/";d._$$Portrait=e._$klass();l=d._$$Portrait._$extend(_._$$Abstract);l.__init=function(){this.__super();s._$extend({reduceExt:function(e){return e.substr(0,e.length-4)}})};l.__reset=function(e){this.__btn=t._$get(e.btn);if(this.__btn){e.parent=e.parent&&t._$get(e.parent)||document.body;this.__col=e.col||12;c=n._$merge(c,{col:this.__col,prefix:d._$getPortraitRoot()});this.__super(e);this.__render();a._$$Scrollbar._$allocate({parent:this.__cnt});this.__doInitDomEvent([[this.__btn,"click",this.__onBtnClick._$bind(this)],[document,"click",this.__hideCnt._$bind(this)],[this.__body,"click",this.__selectItem._$bind(this)]])}};l.__destroy=function(){this.__doClearComponent();this.__super()};l.__initXGui=function(){var e=o._$parseUITemplate(r);return function(){this.__seed_html=e.cnt;this.__seed_list=e.list}}();l.__initNode=function(){this.__super();var e=t._$getByClassName(this.__body,"j-flag");this.__cnt=e[0];this.__prev=e[1];this.__next=e[2]};l.__onBtnClick=function(e){t._$hasClassName(this.__body,"f-dn")?this.__showCnt(e):this.__hideCnt(e)};l.__showCnt=function(e){i._$stop(e);i._$dispatchEvent(document,"click");t._$delClassName(this.__body,"f-dn");this._$dispatchEvent("onShow")};l._$hide=function(){this.__hideCnt()};l.__hideCnt=function(e){t._$addClassName(this.__body,"f-dn");this._$dispatchEvent("onHide")};l.__selectItem=function(e){i._$stop(e);var n=i._$getElement(e,"d:id");if(n){var o={id:t._$dataset(n,"id"),tag:t._$attr(n,"title"),src:t._$dataset(n,"src")};o.html=d._$getImgHTML(o);this._$dispatchEvent("onSelect",o);this.__hideCnt(e)}};l.__render=function(){s._$render(this.__cnt,this.__seed_list,c)};l._$getData=function(){return c};d._$isPortrait=function(e){var t=(e.src||"").toLowerCase(),i=d._$getPortraitRoot();return 0===t.indexOf(i)};d._$hasPortrait=function(e){var t=n._$indexOf(e.getElementsByTagName("img"),function(e){return d._$isPortrait(e)});return t>=0};d._$getPortraitRoot=function(){return appConfig.protocol.sdk+"://"+appConfig.domain.sdk+appConfig.online.sdk+"res/portrait/emoji/"};d._$formatPortrait=function(e){var t=e.getElementsByTagName("img");if(t&&t.length){e=e.cloneNode(!0);n._$reverseEach(e.getElementsByTagName("img"),function(e){var t=e.parentNode;if(d._$isPortrait(e)){var i=e.ownerDocument.createTextNode(e.title);t.replaceChild(i,e)}else t.removeChild(e)});return e}};d._$isPortraitURL=function(e){var t=e.className||"";return t.indexOf(u)>=0};d._$hasPortrait=function(e){var t=n._$indexOf(e.getElementsByTagName("img"),function(e){return d._$isPortraitURL(e)});return t>=0};d._$formatPortrait=function(e){var t=e.getElementsByTagName("img");if(t&&t.length){e=e.cloneNode(!0);n._$reverseEach(e.getElementsByTagName("img"),function(e){var t=e.ownerDocument.createTextNode(e.title);e.parentNode.replaceChild(t,e)});return e}};d._$portrait2text=function(e){var i=document.createElement("div");i.innerHTML=e;var n=i.getElementsByTagName("img");for(var o=n.length-1;o>=0;o--){var s=n[o];var _=t._$attr(s,"title");var a=document.createTextNode(_);i.replaceChild(a,s)}return i.innerHTML};d._$text2portrait=function(){var e=/(\[[^\]]+\])/gi;return function(t){var i=c.pmap;var n=c.pmap2;t=t.replace(e,function(e,t){if(n[t]){var o=d._$getImgHTML({id:n[t],tag:t,src:d._$getPortraitRoot()+i[n[t]].file});return o}else return t});return t}}();d._$getImgHTML=function(e){var t='<img class="portrait_icon '+u+'" data-id="'+e.id+'" src="'+e.src+'" title="'+e.tag+'" alt="'+e.tag+'">';return t}},15,17,16,1,2,18,72,57,76,77);I$(74,'<textarea name="ntp" id="#<editBody>">\n  <div class="m-iptbox">\n    <label id="portrait_btn" class="portrait_label" title="发送表情"><i class="u-icon u-icon-portrait"></i></label>\n    <label class="photo_label j-flag" title="发送图片"><i class="u-icon u-icon-photo"></i></label>\n    <div class="textarea j-richflag">\n      <div class="textarea-mn j-flag"></div>\n    </div>\n    <button type="submit" class="u-btn u-btn-send j-flag">发送</button>\n    <form class="form j-flag"></form>\n    <div class="disabled"></div>\n  </div>\n</textarea>\n<textarea name="jst" id="#<editStyle>">\n  <head>\n    <meta charset="utf-8"/>\n    <style>\n      html,body{cursor:text;font-size:14px;font-family:Arial;word-wrap:break-word;}\n      html,body,p{margin:0;padding:0;border:0}\n      html{width:100%;height:100%;overflow:hidden;}\n      body{line-height:16px;padding:11px 10px;white-space:pre-wrap;}\n      img{max-width:90%;}\n      .portrait_icon{\n        width: 24px;\n        height: 24px;\n        vertical-align: middle;\n        display: inline-block;\n      }\n      ${css}\n    </style>\n  </head>\n  <body contenteditable="true"></body>\n</textarea>\n<textarea name="txt" id="#<editToast>">\n  <div class="tips-message">\n    <i class ="u-icon u-icon-warning"></i>\n    <h4></h4>\n  </div>\n</textarea>\n<textarea name="txt" id="#<editPlaceHolder>">\n  <div class="empty">请输入消息</div>\n</textarea>\n');I$(126,function(e,t,i){i.__insertLineBreak=function(e){e.execCommand("insertLineBreak")};i.__insertHTML=function(e,t){e.execCommand("insertHTML",!1,t)};i.__unlink=function(e){e.execCommand("unlink",!1)};i.__getTextContent=function(e){return e&&e.innerText||""};i.__focusToEnd=function(e){e.focus();var t=e.getSelection();if(t.rangeCount>0){var i=t.getRangeAt(0);i.selectNodeContents(e.document.body);i.collapse(!1)}};i.__fixFocus=function(e){};i.__collapse=function(e){try{e.getSelection().collapseToEnd()}catch(t){}};i.__hasSelectionHack=function(){return!1};i.__saveSelection=function(){};i.__revertSelection=function(e,t){};i.__getPosition=function(e){if(e){var t=e.getSelection(),i=t.getRangeAt(0);if(i){var n=(i.getClientRects()||[])[0];if(n){var o=e.document,s=Math.max(o.body.scrollTop,o.documentElement.scrollTop),_=Math.min(o.body.clientHeight,o.documentElement.clientHeight);if(n.top>0&&n.top<_)return;return{top:n.top+s,left:n.left}}}}}},1,17);I$(75,function(e,t,i){if("trident"===e._$KERNEL.engine)I$(127,function(){i.__getPosition=function(e){};i.__saveSelection=function(e){var t=e.document;if(e.getSelection){var i=e.getSelection();if(i.rangeCount>0)return i.getRangeAt(0)}else if(t.selection)return t.selection.createRange()};i.__revertSelection=function(e,t){if(e&&t)if(t.select)t.select();else if(e.getSelection){var i=e.getSelection();i.addRange(t)}}});if("trident"===e._$KERNEL.engine&&e._$KERNEL.release>"6.0")I$(128,function(){i.__insertLineBreak=function(e){var t=e.getSelection().getRangeAt(0);var i=e.createElement("p");i.innerText=" ";t.insertNode(i);t.collapse(!0)};i.__insertHTML=function(e,i){var n=e.getSelection();if(n.getRangeAt){var o=n.getRangeAt(0);if(o){var s=e.createElement("div");s.innerHTML=i;o.deleteContents();t._$reverseEach(s.childNodes,function(e){o.insertNode(e)});o.collapse(!1)}}}});if("trident"===e._$KERNEL.engine&&e._$KERNEL.release<="6.0")I$(129,function(){i.__insertLineBreak=function(e){var t=e.selection.createRange();t.pasteHTML("<p></p>");t.collapse(!1);t.select()};i.__insertHTML=function(e,t){var i=e.selection.createRange();if(i.pasteHTML)i.pasteHTML(t)};i.__hasSelectionHack=function(){return!0}});if("webkit"===e._$KERNEL.engine)I$(130,function(){i.__fixFocus=function(e){var t=e.getSelection();if(!(t&&t.rangeCount>0)){var i=e.document.createRange();i.selectNodeContents(e.document.body);t.addRange(i);i.collapse(!1)}}});if("gecko"===e._$KERNEL.engine)I$(131,function(){i.__insertLineBreak=function(e){e.execCommand("insertHTML",!1,"<p></p>")};i.__getTextContent=function(){var e=/inline|cell/i;var i=function(t){return!e.test(window.getComputedStyle(t,null).display||"")};var n=function(e,o){var s=e.childNodes;if(0!==s.length||e.nodeType!==Node.ELEMENT_NODE&&e.nodeType!==Node.TEXT_NODE){if(0===s.length)return;if(o.length>0)if("\n"!==o[o.length-1]&&i(e))o.push("\n");else o.push(" ");t._$forEach(s,function(e){n(e,o)})}else o.push(e.textContent||e.nodeValue||"")};return function(e){var t=[];n(e,t);return t.join("")}}()});return i},43,1,126);I$(20,function(e,t,i,n,o,s,_,a,r,c,d,l,u,f,h,m){var p="YSF_MSG_"+n._$uniqueID()+"_";h._$$YSFEditor=e._$klass();m=h._$$YSFEditor._$extend(o._$$Abstract);m.__init=function(){this.__sopt={};this.__ropt={};this.__fopt={accept:"image/*",onchange:this.__onFileSelect._$bind(this)};this.__popt={clazz:"pc_portrait",btn:"portrait_btn",onSelect:this.__onPortraitSelect._$bind(this)};this.__eopt={visible:!0,onload:this.__onIFrameLoaded._$bind(this)};this.__super()};m.__reset=function(e){this.__super(e);t._$dataset(this.__fopt.btn,"log",e.log||"");this.__limit=parseInt(e.maxLength)||0;this.__placeholder=e.placeholder||"输入消息...";this.__doShowPlaceHolder();var i=parseInt(e.maxHeight)||0;if(i)this.__range=[0,i];this.__sopt.css=e.css||"";this.__iframe=t._$createXFrame(this.__eopt);this.__doInitDomEvent([[this.__nsender,"click",this.__doSubmitContent._$bind(this,{label:0})],[this.__nholder,"click",this._$focus._$bind(this)]]);if(e.popt){this.__popt=n._$merge(this.__popt,e.popt);this.__popt.parent=this.__popt.parent||this.__body}this.__portrait=l._$$Portrait._$allocate(this.__popt)};m.__destroy=function(){if(this.__scrollbar){this.__scrollbar._$recycle();delete this.__scrollbar}if(this.__observer){this.__observer.disconnect();delete this.__observer}if(this.__stimer){window.clearTimeout(this.__stimer);delete this.__stimer}t._$remove(this.__iframe);delete this.__iframe;delete this.__content;delete this.__range;this.__doHideToast();this._$clear();this.__super()};m.__initXGui=function(){var e=s._$parseUITemplate(u);return function(){this.__seed_tst=e.editToast;this.__seed_hld=e.editPlaceHolder;this.__seed_cnt=e.editStyle;this.__seed_html=e.editBody}}();m.__initNode=function(){this.__super();var e=t._$getByClassName(this.__body,"j-flag");this.__richText=t._$getByClassName(this.__body,"j-richflag")[0];this.__eopt.parent=e[1];this.__ropt.container=e[1];this.__fopt.btn=e[0];this.__fopt.form=e[3];this.__fopt.parent=this.__body;a._$bind(this.__fopt.btn,this.__fopt);this.__nsender=e[2];this.__ntoast=t._$html2node(s._$getTextTemplate(this.__seed_tst));
this.__nholder=t._$html2node(s._$getTextTemplate(this.__seed_hld))};m.__getViewPort=function(){try{return this.__iframe.contentWindow}catch(e){}};m.__getContext=function(){try{return this.__getViewPort().document}catch(e){}};m.__getBody=function(){try{var e=this.__getContext().body;return"true"==e.contentEditable?e:null}catch(t){}};m.__hasContent=function(){var e=this.__getBody(),t=this.__getTextContent(e).trim();if(!t)return l._$hasPortrait(e);else return!!t};m.__getTextContent=function(e){return f.__getTextContent(e||this.__getBody())};m.__doShowToast=function(e){this.__doHideToast();this.__body.appendChild(this.__ntoast);this.__ntoast.getElementsByTagName("h4")[0].innerHTML=e;this.__xtimer=window.setTimeout(this.__doHideToast._$bind(this),5e3)};m.__doHideToast=function(){if(this.__xtimer)this.__xtimer=window.clearTimeout(this.__xtimer);t._$removeByEC(this.__ntoast)};m.__doShowPlaceHolder=function(e){e=e||this.__placeholder;this.__nholder.innerText=e;this.__eopt.parent.appendChild(this.__nholder)};m.__doHidePlaceHolder=function(){t._$removeByEC(this.__nholder)};m.__doDumpImageFromEvent=function(e){var t=[],i=e.clipboardData||window.clipboardData||{};n._$forEach(i.items,function(e){if(0===e.type.indexOf("image")){var i=e.getAsFile();t.push({file:i,url:URL.createObjectURL(i)})}});var o=e.dataTransfer||{};n._$forEach(o.files,function(e){if(0===e.type.indexOf("image"))t.push({file:e,url:URL.createObjectURL(e)})});return t};m.__doDumpImageFromContent=function(e){var t=[],i=e.getElementsByTagName("IMG");n._$reverseEach(i,function(e){var i=e.src||"";if(0===i.indexOf("data:image")||i.indexOf("nos.netease.com")>0){t.push({url:i,file:i});e.parentNode.removeChild(e)}});return t};m.__doDumpTextFromEvent=function(e){var t="",i=e.clipboardData;if(i)t=i.getData("text/plain");else if(window.clipboardData)t=clipboardData.getData("text");return t||""};m.__doCheckEnter=function(e){if(13==e.keyCode){i._$stop(e);if(!e.ctrlKey)this.__doSubmitContent({label:1});else{f.__insertLineBreak(this.__getContext());var n=t._$getStyle(this.__getBody(),"lineHeight"),o=parseInt(n)||20;this.__getViewPort().scrollBy(0,o);this.__doCheckScrollBar()}}};m.__doCheckScrollBar=function(){var e=function(){delete this.__stimer;if(this.__scrollbar)this.__scrollbar._$resize()};return function(){if(!this.__stimer)this.__stimer=window.setTimeout(e._$bind(this),50)}}();m.__doCheckAutoHeight=function(){var e=this.__range;if(e&&e[0]!==e[1]){var i=this.__eopt.parent;if(!e[0]){if(!i.clientHeight)return;var n=i.clientHeight,o=e[1];e[0]=n;e[1]=Math.max(o,n)}var s=this.__getBody();if(s){t._$setStyle(i,"height","1px");var _=Math.max(e[0],Math.min(s.scrollHeight,e[1]));t._$setStyle(i,"height",_+"px");this._$dispatchEvent("onheightchange")}}};m.__doCheckInputLimit=function(e){if(this.__limit){if(null==e)e=this._$getContent().trim();if(e.length>this.__limit)this._$setContent(e.substr(0,this.__limit))}};m.__doCheckSubmitable=function(){this.__doDisableSubmit(!this.__hasContent())};m.__doCheckPlaceHolder=function(){var e=this.__hasContent();!e?this.__doShowPlaceHolder():this.__doHidePlaceHolder()};m.__doCheckEventMessage=function(e){var t=this.__doDumpTextFromEvent(e);if(0===t.indexOf(p)){i._$stop(e);this._$dispatchEvent("onsubmit",{type:"message",content:t.replace(p,"")})}};m.__doCheckEventImage=function(e){var t=this.__doDumpImageFromEvent(e);if(!t||!t.length){this.__filterRichContent(e);window.setTimeout(this.__doCheckContentImage._$bind(this),100)}else{i._$stop(e);this.__doPreviewImage(t)}};m.__doCheckContentImage=function(){var e=this.__getBody(),t=this.__doDumpImageFromContent(e);e.scrollTop=2*e.scrollHeight;f.__focusToEnd(this.__getViewPort());if(t&&t.length)this.__doPreviewImage(t)};m.__doSelectionChange=function(e){var t=this.__onSelectionChange._$bind(this);if(!window.MutationObserver){this.__doInitDomEvent([[e,"selectionchange",t]]);if(f.__hasSelectionHack())this.__doInitDomEvent([[e,"keydown",t],[e,"keyup",t]])}else{this.__observer=new MutationObserver(t);this.__observer.observe(e,{subtree:!0,childList:!0,attributes:!0,characterData:!0})}};m.__doLoadImage=function(e,t,i){var n=this,o=new Image;o.onload=function(){t.call(n,e)};o.onerror=function(){e.file=null;(i||t).call(n,e)};o.src=e.url};m.__doPreviewImage=function(){var e=function(e){var t=[];n._$forEach(e,function(e){if(e.file)t.push(e)});return t};return function(t){var i=0,o=this;if(!this.__onPreviewState){var s=function(){i++;if(i==t.length){var n=e(t);if(!n.length)this.__doSendImage({});else{o.__onPreviewState=!0;d._$preview({photos:n,onok:function(){o.__doSendImage(n);delete o.__onPreviewState},oncc:function(){delete o.__onPreviewState}})}}};n._$forEach(t,function(e){if(e.url)this.__doLoadImage(e,s,s);else i++},this)}}}();m.__doSendImage=function(e){if(!n._$isArray(e))this._$dispatchEvent("onsubmit",{type:"image",content:{url:e.url,file:e.file}});else n._$forEach(e,this.__doSendImage,this)};m.__doSubmitContent=function(e){var t=this._$getContent().trim();if(t)if(!(this.__limit&&t.length>this.__limit))this._$dispatchEvent("onsubmit",n._$merge({type:"text",content:t},e));else this._$toast("消息内容超过最大限制"+this.__limit+"个字符")};m.__doDisableSubmit=function(e){this.__nsender.disabled=!!e;!e?t._$delClassName(this.__nsender,"u-btn-disabled"):t._$addClassName(this.__nsender,"u-btn-disabled")};m.__doFocusToEnd=function(){f.__collapse(this.__getViewPort())};m.__onIFrameLoaded=function(e){var t=this.__getContext();t.open();t.write(_._$get(this.__seed_cnt,this.__sopt));t.close();var n=this.__getViewPort();this.__doInitDomEvent([[t,"paste",this.__onContentPaste._$bind(this)],[t,"drop",this.__onFileDropIn._$bind(this)],[t,"keydown",this.__doCheckEnter._$bind(this)],[n,"focus",this.__doHidePlaceHolder._$bind(this)],[n,"blur",this.__doCheckPlaceHolder._$bind(this)],[n,"scroll",this.__doCheckScrollBar._$bind(this)],[t,"click",i._$dispatchEvent._$bind(i,document,"click")],[t,"beforedeactivate",this.__doSaveSelection._$bind(this)]]);this.__doSelectionChange(t);try{t.execCommand("enableObjectResizing",!1,!1)}catch(o){}this.__ropt.parent=t.body;this.__ropt.sbody=this.__getViewPort();this.__scrollbar=c._$$Scrollbar._$allocate(this.__ropt);this._$setContent(this.__content||"")};m.__doSaveSelection=function(){this.__range=f.__saveSelection(this.__getViewPort())};m.__onSelectionChange=function(e){this.__doCheckSubmitable();this.__doCheckAutoHeight();this._$dispatchEvent("oninputchange",{})};m.__onContentPaste=function(e){this.__doCheckEventMessage(e);if(!this.__disSendImg)this.__doCheckEventImage(e);else{this.__stopImgEvent(e);this.__filterRichContent(e)}};m.__onFileSelect=function(e){var i=t._$get(e.id),n={file:(i.files||[])[0]};if(!n.file)n.file=i;else if(n.file.type.indexOf("image")<0)n.file=null;else n.url=URL.createObjectURL(n.file);this.__doLoadImage(n,this.__doSendImage)};m.__onFileDropIn=function(e){if(!this.__disSendImg){this.__doCheckEventImage(e);i._$stop(e);window.setTimeout(this.__doFocusToEnd._$bind(this),150)}else this.__stopImgEvent(e)};m.__onPortraitSelect=function(e){var t=this.__getContext();try{this._$focus();f.__fixFocus(this.__getViewPort());this.__doScrollToCursor();f.__insertHTML(t,e.html)}catch(i){console.log(i)}this.__onSelectionChange()};m.__doScrollToCursor=function(){var e=this.__getViewPort(),t=f.__getPosition(e);if(t)if(e)e.scrollTo(0,t.top||0)};m._$setContent=function(e){var t=this.__getBody();var i=document.createElement("div");if(t){delete this.__content;if("innerText"in i)i.innerText=e||"";else i.textContent=e||"";t.innerHTML=this.__text2portrait(i.innerHTML);this.__onSelectionChange()}else this.__content=e||""};m._$getContent=function(){var e=this.__getBody(),t=l._$formatPortrait(e)||e;return this.__getTextContent(t)};m._$reset=function(){this._$resetFile();this._$resetContent()};m._$resetFile=function(){this.__fopt.form.reset()};m._$resetContent=function(){this._$setContent("")};m._$focus=function(){var e=this.__getViewPort();if(e){this.__doHidePlaceHolder();e.focus();f.__revertSelection(e,this.__range);delete this.__range}};m._$blur=function(){window.focus()};m._$disable=function(e){!e?t._$delClassName(this.__body,"z-disabled"):t._$addClassName(this.__body,"z-disabled");this.__portrait._$hide()};m._$toast=function(e){if(!e)this.__doHideToast();else this.__doShowToast(e)};m._$placeholder=function(e){this._$reset();this.__doShowPlaceHolder(e)};m._$clear=function(e){e=e||{};if(!e.disabled&&e.focus){this._$reset();this._$focus()}else{this._$blur();this._$placeholder(e.placeholder);this._$disable(!!e.disabled);if(e.toast)this.__doShowToast(e.toast)}};h._$copy=function(e){i._$addEvent(e,"copy",function(e){var n=i._$getElement(e,"d:copyId");if(n){i._$stop(e);var o=p+t._$dataset(n,"copyId");if(e.clipboardData)e.clipboardData.setData("text/plain",o);else if(window.clipboardData)clipboardData.setData("text",o)}})};m.__portrait2text=function(e){return l._$portrait2text(e)};m.__text2portrait=function(e){return l._$text2portrait(e)};m._$toggleOpr=function(e){if(e){t._$addClassName(this.__richText,"u-status-robot");t._$addClassName(this.__fopt.btn,"f-dn");t._$addClassName("portrait_btn","f-dn");this.__portrait._$hide()}else{t._$delClassName(this.__richText,"u-status-robot");t._$delClassName(this.__fopt.btn,"f-dn");t._$delClassName("portrait_btn","f-dn")}this._$setDisSendImg(e)};m.__filterRichContent=function(e){i._$stop(e);var t=this.__getContext();var n=this.__doDumpTextFromEvent(e);n=this.__text2portrait(n);f.__insertHTML(t,n)};m._$setDisSendImg=function(e){e?this.__disSendImg=!0:delete this.__disSendImg};m.__stopImgEvent=function(e){var t=this.__doDumpImageFromEvent(e);if(!t||!t.length);else i._$stop(e)}},15,17,16,1,72,2,18,48,49,57,73,22,74,75);I$(55,function(e,t,i,n,o,s){s._$dur2time=function(){var e=function(e){return""+e};return function(e){if(!e)return'0"';e=Math.round(e/1e3);return e+'"'}}();s._$dur2width=function(e){return 40+7*e/1e3};s._$media=function(){var s={audio:function(t){var i="z-icon-playing";if(!e._$hasClassName(t,i)){var s=e._$dataset(t,"id");o._$do(function(o){o._$getAudioURL(s,function(o){
if(o){o+=(o.indexOf("?")<0?"?":"&")+"audioTrans&type=mp3";n._$play(o,{key:"ysf-online-audio",onstatechange:function(n){if(2==n.state)e._$addClassName(t,i);else e._$delClassName(t,i)},ontimeupdate:function(e){},onerror:function(n){e._$delClassName(t,i)}})}})})}else n._$stop("ysf-online-audio")}};return function(n,o){t._$addEvent(n,"click",function(n){var _=t._$getElement(n,"d:action");if(_){var a=s[e._$dataset(_,"action")];if(i._$isFunction(a))a.call(o,_)}})}}()},17,16,1,84,51);I$(56,function(){return{"fk-sp":["访客端","发图"],"fk-cm":["访客端","web主动评价入口"],"fk-cs":["访客端","web满意度评价",["满意","不满意"]],"fk-lt":["访客端","网易七鱼小尾巴"]}});I$(5,function(e,t,i,n){n._$log=function(e,t){var n=i[e];if(n){var o=n[2]||[];_gaq.push(["_trackEvent",n[0],n[1],o[t]||""])}};n._$delegate=function(i){e._$addEvent(i,"click",function(i){var o=e._$getElement(i,"d:log");if(o)n._$log(t._$dataset(o,"log"),t._$dataset(o,"logLabel"))},!0)};var o=!1;if(!o){o=!0;n._$delegate(document)}},16,17,56);I$(98,'<textarea name="ntp" id="#<cnt>">\n  <div class="f-dn">\n  \t<div class="j-flag portrait_cnt"></div>\n  \t<div class="j-flag portrait_btn_cnt">\n  \t\t<button class="j-flag">上一页</button>\n  \t\t<button class="j-flag">下一页</button>\n  \t</div>\n  </div>\n</textarea>\n\n<textarea name="jst" id="#<list>">\n\t<div class="portrait_list f-clr j-list">\n\t\t{list plist as p}\n\t\t<!-- 页开始 -->\n\t\t{if (p_index + 1) % (col*row) === 1}\n\t\t<div class="f-fl page" {if defWidth}style="width:${defWidth}"{/if}>\n\t\t{/if}\n\t\t<!-- 页开始end -->\n\n\t\t<!-- 行开始 -->\n\t\t{if (p_index + 1) % col === 1}\n\t\t<ul class="f-clr list">\n\t\t{/if}\n\t\t<!-- 行开始end -->\n\t\t\t<li class="item" {if defItemWidth}style="width:${defItemWidth}"{/if}><i class="portrait_img portrait_icon_${p.file|reduceExt}" data-src="${prefix}${p.file}" data-id="${p.id}" title="${p.tag}" alt="${p.tag}"></i></li>\n\t\t<!-- 行结束 -->\n\t\t{if p_index % col === col-1}\n\t\t</ul>\n\t\t{/if}\n\t\t<!-- 行结束end -->\n\n\t\t<!-- 页结束 -->\n\t\t{if p_index % (col*row) === (col*row)-1}\n\t\t</div>\n\t\t{/if}\n\t\t<!-- 页结束end -->\n\t\t{/list}\n\t</div>\n</textarea>\n\n<textarea name="jst" id="#<page>">\n\t<ul class="f-clr" style="width:${(all+1)*22}px;">\n\t{list 0..all as index}\n\t\t<li class="j-pageitem ${index === now ? \'active\' : \'\'}"><div class="dot"></div></li>\n\t{/list}\n\t</ul>\n</textarea>');I$(53,function(e,t,i,n,o,s,_,a,r,c,d){c._$$Portrait=e._$klass();d=c._$$Portrait._$extend(_._$$Abstract);var l=appConfig.path.sdk+"res/portrait/emoji/";d.__init=function(){this.__super();s._$extend({reduceExt:function(e){return e.substr(0,e.length-4)}})};d.__reset=function(e){this.__btn=t._$get(e.btn);if(this.__btn){e.parent=e.parent&&t._$get(e.parent)||document.body;this.__row=e.row||5;this.__col=e.col||10;this.__nowPage=e.defpage||0;var o=this.__row*this.__col;this.__allPage=Math.ceil(r.plist.length/o)-1;r=n._$merge(r,{row:this.__row,col:this.__col,nowPage:this.__nowPage,prefix:l});this.__super(e);var s=!1;this.__doInitDomEvent([[this.__btn,"click",function(e){if(!s){this.__width=this.__getWidth();r=n._$merge(r,{defWidth:this.__width?this.__width+"px":"",defItemWidth:this.__width?this.__width/this.__col+"px":""});this.__render();s=!0}this.__onBtnClick(e)}._$bind(this)],[document,"click",this.__hideCnt._$bind(this)],[this.__body,"click",this.__selectItem._$bind(this)],[window,"orientationchange",function(){t._$clearChildren(this.__cnt);setTimeout(function(){this.__width=this.__getWidth();r=n._$merge(r,{defWidth:this.__width?this.__width+"px":"",defItemWidth:this.__width?this.__width/this.__col+"px":""});this.__render()}._$bind(this),300)}._$bind(this)]]);i._$addEvent(this.__cnt,"touchmove",function(e){e.preventDefault()});touch.on(this.__cnt,"swiperight",this._$page._$bind(this,-1));touch.on(this.__cnt,"swipeleft",this._$page._$bind(this,1))}};d.__destroy=function(){this.__doClearComponent();this.__super()};d.__initXGui=function(){var e=o._$parseUITemplate(a);return function(){this.__seed_html=e.cnt;this.__seed_list=e.list;this.__seed_page=e.page}}();d.__initNode=function(){this.__super();var e=t._$getByClassName(this.__body,"j-flag");this.__cnt=e[0];this.__pageCnt=e[1]};d.__setPageShow=function(e){var i=t._$getByClassName(this.__pageCnt,"j-pageitem");var n=t._$getByClassName(this.__pageCnt,"active")[0];if(n)t._$delClassName(n,"active");t._$addClassName(i[e],"active")};d.__onBtnClick=function(e){t._$hasClassName(this.__body,"f-dn")?this.__showCnt(e):this.__hideCnt(e)};d.__showCnt=function(e){i._$stop(e);i._$dispatchEvent(document,"click");t._$delClassName(this.__body,"f-dn");this._$dispatchEvent("onShow")};d._$hide=function(){this.__hideCnt()};d.__hideCnt=function(e){t._$addClassName(this.__body,"f-dn");this._$dispatchEvent("onHide")};d.__selectItem=function(e){i._$stop(e);var n=i._$getElement(e,"d:id");if(n){var o=t._$dataset(n,"id");if(o){var s={id:o,tag:t._$attr(n,"title"),src:t._$attr(n,"src")};s.html=c._$getImgHTML(s);this._$dispatchEvent("onSelect",s);var _=document.body;_.scrollTop=2*_.scrollHeight;if(this.__isiOS()&&1===this.__judgeOrientation())setTimeout(function(){_.scrollTop-=45},100)}else this._$dispatchEvent("del")}};d._$page=function(e){var t=r.nowPage+(e||0);if(!(t<0||t>this.__allPage)){r.nowPage=t;this.__nowPage=t;var i=t*this.__width;this.__move(0-i);this.__setPageShow(t)}};d.__render=function(){s._$render(this.__cnt,this.__seed_list,r);s._$render(this.__pageCnt,this.__seed_page,{all:this.__allPage,now:this.__nowPage});this._$page()};d.__move=function(e){var i=t._$getByClassName(this.__body,"j-list")[0];t._$style(i,{left:e+"px"})};d._$getData=function(){return r};c._$portrait2text=function(e){var i=document.createElement("div");i.innerHTML=e;var n=i.getElementsByTagName("img");for(var o=n.length-1;o>=0;o--){var s=n[o];var _=t._$attr(s,"title");var a=document.createTextNode(_);i.replaceChild(a,s)}return i.innerHTML};c._$text2portrait=function(){var e=/(\[[^\]]+\])/gi;return function(t){var i=r.pmap;var n=r.pmap2;t=t.replace(e,function(e,t){if(n[t]){var o=c._$getImgHTML({id:n[t],tag:t,src:l+i[n[t]].file});return o}else return t});return t}}();c._$getImgHTML=function(e){var t='<img class="portrait_icon" data-id="'+e.id+'" src="'+e.src+'" title="'+e.tag+'" alt="'+e.tag+'">';return t};d.__judgeOrientation=function(){if(180==window.orientation||0==window.orientation)return 1;else if(90==window.orientation||window.orientation==-90)return 2;return 0};d.__isiOS=function(){var e=window.navigator.userAgent.toLowerCase();return/(iphone|ios|mini|ipod|ipad)/gi.test(e)};d.__getWidth=function(){var e=this.__width;var i=document.documentElement.clientWidth||window.innerWidth||window.screen.width||document.body.clientWidth;if(!i){var n=t._$getChildren(document.body)[0];i=n.clientWidth}return i||300}},15,17,16,1,2,18,72,98,77);I$(4,function(e,t,i,n,o,s,_,a,r,c,d,l,u,f,h,m,p,$,g){$._$$Module=e._$klass();g=$._$$Module._$extend(c._$$Module);g.__init=function(e){this.__isChatting=0;this.__evalModal={};var o=t._$getByClassName(document.body,"j-flag");this.__box=o[0];this.__sendForm=o[2];u._$delegate(o[1],"mobile");p._$media(o[1]);this.__sendBox=t._$getByClassName(document.body,"j-tdflag")[0];this.__commentBtn=t._$get("comment_btn");this.__actionBtn=t._$get("action_btn");this.__errTip=t._$getByClassName(document.body,"j-tip");this.__listConf={limit:1e4,parent:o[1],item:{ext:{},klass:"session-item",config:appConfig,theme:theme,imgfilter:function(e){e=e||"";if(e.indexOf("://")>=0)return e;else return appConfig.path.sdk+e},filterTagA:function(e){e=e||"";return e.replace(/<a[^>]*>([\s\S]*?)<\/a>/gi,function(e,t){return t})},imgclip:function(e){e=(e||"")+"?imageView&type=png|imageView&thumbnail=76y76&axis=5";if(e.indexOf("://")>=0)return e;else return appConfig.path.sdk+e},filterLabel:function(e){e=e||"";return e.replace(/\n/g,'<p class="br"></p>')},text2portrait:f._$text2portrait,complete:d._$completeURL,d2w:p._$dur2width,duration:p._$dur2time,urlFormat:function(e){e=e||"";e=e.trim();var t=/^http[s]?:\/\//.test(e);return t?e:"http://"+e}},cache:{lkey:"msg-all",klass:d._$$Cache},onafterinsert:function(){setTimeout(this.__doScrollBottom._$bind(this),100);var e=document.querySelectorAll(".productinfo img");for(var t=0;t<e.length;t++){var i=e[t].getAttribute("data-src");this.__preLoadImg(e[t],i)}}._$bind(this),onafterupdate:function(e){var t=e.data;if(this.__isResend&&t.state===-1){this.__isResend=0;var i="网络连接失败，请稍后再试";this.__showTip(i,!0);this.__fopt.form.reset()}}._$bind(this),onemptylist:function(e){e.stopped=!0},onafterupdaterender:this.__doScrollBottom._$bind(this),onafterlistload:function(e){if(!this.__isRobot&&1==this.__isChatting)l._$sendPrdMsg();this.__listHasLoad=!0}._$bind(this)};s._$extend({timeformat:function(e,t){if(0===t||new Date(t).getFullYear()===new Date(e).getFullYear())return n._$format(e,"HH:mm");else return n._$format(e,"yyyy-MM-dd HH:mm")}});this.__textarea=o[2];this.__sendBtn=o[4];this.__oprCnt=o[4].parentNode.parentNode;this.__isDis=!1;this.__fopt={btn:o[3],form:o[5],parent:o[5].parentNode,accept:"image/*",onchange:this.__onFileSelect._$bind(this)};this.__popt={clazz:"mobile_portrait",row:3,col:7,parent:this.__oprCnt,btn:"portrait_btn",onSelect:this.__onPortraitSelect._$bind(this),onShow:function(){i._$dispatchEvent(window.document,"focus");t._$addClassName(this.__box,"show_portrait")}._$bind(this),onHide:function(){t._$delClassName(this.__box,"show_portrait")}._$bind(this)};this.__bindImgSendBtn();this.__super(e)};g.__reset=function(e){this.__super(e);this.__portrait=f._$$Portrait._$allocate(this.__popt);this.__doInitDomEvent([[document.body,"click",this.__onClickBox._$bind(this)],[window,"beforeunload",this.__onBeforeUnload._$bind(this)],[this.__sendBtn,"click",this.__onClickSendBtn._$bind(this)],[this.__textarea,"input",this.__onSendFormInput._$bind(this)],[this.__textarea,"focus",function(){t._$setStyle(this.__oprCnt,"position","absolute")}._$bind(this)],[this.__textarea,"blur",function(){this.__textarea.blur();this.__position={start:this.__textarea.selectionStart,end:this.__textarea.selectionEnd};t._$setStyle(this.__oprCnt,"position","fixed");
}._$bind(this)]]);l._$batEvent({onconnect:this.__onConnect._$bind(this),onfinish:this.__onFinish._$bind(this),ondisconnect:this.__onDisconnect._$bind(this),onkefuerror:this.__onDisconnect._$bind(this),onnokefu:this.__onNokefu._$bind(this),onkickout:this.__onFinish._$bind(this),onusererror:this.__onUserErr._$bind(this),onqueuestart:this.__onQueueStart._$bind(this),onqueuechange:this.__onQueue._$bind(this),onovertime:this.__onOverTime._$bind(this),onshunt:this.__onShuntEntries._$bind(this),onshuntstatus:this.__onShuntStatus._$bind(this),ontransferresult:this.__onTransferResult._$bind(this),onproducterror:this.__onProductError._$bind(this),onevalresultmsg:this.__cbReceiveResultEvaluate._$bind(this)});this.__cache=d._$$Cache._$allocate({onerror:function(e){if(e&&"NotAnImage"===e.code){var t="目前可支持传送jpg/png/bmp/gif格式的图片";this.__showTip(t,!0);this.__fopt.form.reset()}}._$bind(this),onofflinemsgsend:this.__onSendLeave._$bind(this),onfileupload:function(){this.__fopt.form.reset();this.__bindImgSendBtn()}._$bind(this)});this.__doConnect()};g.__destroy=function(){this.__doClearComponent();this.__super()};g.__onClickSendBtn=function(e){if(this.__textarea.value.trim()){var t={type:"text",content:this.__textarea.value};this.__sendMsg(t);this.__textarea.value="";this.__toggleSendBtn(!1)}};g.__bindImgSendBtn=function(){if(this.__selbind){a._$unbind(this.__selbind);delete this.__selbind}this.__selbind=a._$bind(this.__fopt.btn,this.__fopt);var e=this.__fopt.form.getElementsByTagName("input");n._$forEach(e,function(e){if("file"==e.getAttribute("type")&&this.__isWeiXin())e.setAttribute("capture","camera")},this)};g.__toggleSendBtn=function(e){if(e){t._$addClassName(this.__sendBtn.parentNode,"form_cnt_send");this.__sendBtn.disabled=!1}else{t._$delClassName(this.__sendBtn.parentNode,"form_cnt_send");this.__sendBtn.disabled=!0}};g.__onFileSelect=function(){var e=function(e,t,i){var n=this,o=new Image;o.onload=function(){t.call(n,e)};o.onerror=function(){e.file=null;(i||t).call(n,e)};o.src=e.url};var i=function(e){if(!n._$isArray(e))this.__sendMsg({type:"image",content:{url:e.url,file:e.file}});else n._$forEach(e,i,this)};return function(n){var o=t._$get(n.id),s={file:(o.files||[])[0]};if(!s.file)s.file=o;else if(s.file.type.indexOf("image")<0)s.file=null;else try{s.url=URL.createObjectURL(s.file)}catch(_){s.url="/sdk/res/img/defaultimg.png?900f3791e581f15954f4e79607680990"}if(s.url)e.call(this,s,i);else i.call(this,s)}}();g.__onClickBox=function(){var e=function(e,i){var n=t._$dataset(e,"id");var o=t._$dataset(e,"sid");var s={value:i,id:n,sid:o};this.__cache._$sendEvalMessage(s);if(o==this.__sessionId)this.__setCommentBtnState(0)};var o={resend:function(e){this.__isResend=1;this.__cache._$reSendMessage(t._$dataset(e,"id"))},reconnect:function(e){this.__hideTip();this._$disable(!0);var i=t._$getByClassName(this.__listConf.parent,"j-finish")[0];t._$remove(i);this.__doConnect()},selRobot:function(e){var i=t._$dataset(e,"id");if(i)if(!this.__isRobot){var n=this.__cache._$getRobotItem(i);if(!n)return;var o=n.question;this.__sendMsg({type:"text",content:o})}else this.__cache._$sendRobotMessage(i)},selShunt:function(e){var i=t._$dataset(e,"id"),n=t._$dataset(e,"type"),o=t._$dataset(e,"disabled"),s=t._$dataset(e,"entryid");if(1!=o&&null!=i&&null!=n&&null!=s){var _=1==n?{staffid:0,groupid:i,entryid:s}:{staffid:i,groupid:0,entryid:s};if(i){window.__shuntdata__=_;l._$sendSelectShunt(_);this.__disableShuntList(1)}}},reconnectshunt:function(){this.__hideTip();var e=t._$getByClassName(this.__listConf.parent,"j-finish")[0];t._$remove(e);this.__doConnect()},applyKf:function(e){if(this.__isRobot){this.__hideTip();var i=t._$getByClassName(this.__listConf.parent,"j-finish")[0];i&&t._$remove(i);if(l._$canSendMessage()){t._$delClassName(this.__errTip[1],"f-dn");this.__cache._$sendAction("kefu");this.__setCommentBtnState(0)}else this.__doConnect(!0)}},comment:function(e){var i=Number(t._$dataset(e,"initial")||0),n=t._$dataset(e,"sid"),o=t._$dataset(e,"mid"),s=t._$dataset(e,"type")||l._$getEvaluation().type;if(!this.__commentBtn.disabled||!i)this.__evalModal[s]._$showModal(i,n,o)},contentDelegate:function(e,n){n=n||window.event;var o=i._$getElement(n);if(o){var s=t._$dataset(o,"name"),_=t._$dataset(o,"id"),a=t._$dataset(o,"disabled");if(!a)if("kefu"===s&&_){if(!this.__isRobot)return;this._$disable2Kefu(o);if(l._$canSendMessage()){t._$delClassName(this.__errTip[1],"f-dn");this.__cache._$sendAction(s,_);this.__setCommentBtnState(0)}else this.__doConnect(!0)}}},richContentDelegate:function(e,n){n=n||window.event;var o=i._$getElement(n,"t:a");if(o)t._$attr(o,"target","_blank")},leaveMsg:function(){var e={};var i=t._$get("leaveForm");if(i){if(i.mobile)e.mobile=i.mobile.value.trim();if(i.email)e.email=i.email.value.trim();if(this.__validateLeaveForm()){i.leaveBtn.innerText="发送中...";e.content=i.content.value.trim();this.__cache._$sendOfflineMessage({type:"text",content:e})}}},thirdorderList:function(e,i){var n=t._$dataset(e,"id");l._$sendThirdOrder({content:{id:n},status:100})},thirdorderStatus:function(e,i){var n=t._$dataset(e,"value");this.__sendMsg({type:"text",content:n})},thirdorderFeedback:function(e,t){}};return function(e){o.leaveCancel=this.__onCancelLeave;var s=i._$getElement(e,"d:action");if(s){var _=o[t._$dataset(s,"action")];if(n._$isFunction(_))_.call(this,s,e)}}}();g.__doConnect=function(e){this._$toggleOpr(!0);if(this.__isChatting){if(!this.__isRobot)t._$delClassName(this.__errTip[1],"f-dn")}else{if(this.__list)this.__list._$recycle();this.__listConf.parent.innerHTML=o._$getTextTemplate("chat-connecting")}l._$connect(window.setting,e)};g.__onConnect=function(e){if(3!==this.__isChatting){this.__sessionId=e.sid;this.__hideTip();this.__hideFormErr();t._$addClassName(this.__errTip[1],"f-dn");this.__isChatting=1;var i=this.__listConf.item.ext.kefuid;this.__listConf.item.ext.kefuid=e.id;if(!this.__list)this.__list=_._$$ListModuleWF._$allocate(this.__listConf);if(i!=e.id)if(e.groupname)this.__doInitShunt(e);else this.__doInitKefu();if(!e.hasEvaluated){this.__setCommentBtnState(1);if(!e.hasKefuEntry)this.__initEvaluatonForm()}var n=e.isRobot;if(e.isRobot){n=!0;this.__listConf.item.ext.isRobot=!0;this.__setCommentBtnState(2);this._$toggleOpr(!0);this.__portrait._$hide();l._$sendKefuHeart(this.__sessionId)}else{if(!e.hasKefuEntry)if(this.__listHasLoad)l._$sendPrdMsg();l._$sendKefuHeart(this.__sessionId);n=!1;this.__listConf.item.ext.isRobot=!1;this._$toggleOpr(!1)}if(e.hasKefuEntry)this.__setActionBtnState(1);if(this.__isRobot)if(this.__tmpEventMsg)this.__sendMsg(this.__tmpEventMsg);delete this.__tmpEventMsg;this.__isRobot=n}};g.__doInitKefu=function(){if(2!==this.__isChatting){var e=l._$getKefu();if(!e)return;this.__listConf.parent.insertAdjacentHTML("beforeEnd",s._$get("chat-kefu",e));this.__doScrollBottom()}};g.__doInitShunt=function(e){if(e.nickname)if(2!==this.__isChatting){var t={nickname:e.nickname,groupname:e.groupname};this.__listConf.parent.insertAdjacentHTML("beforeEnd",s._$get("chat-kefu-shunt",t));this.__doScrollBottom()}};g.__onFinish=function(e){var i=t._$getByClassName(this.__listConf.parent,"j-finish")[0];t._$remove(i);if(!this.__isRobot){var n=!e?"chat-kick":e.isSysClose?"chat-finish-sys":"chat-finish";this.__listConf.parent.insertAdjacentHTML("beforeEnd",o._$getTextTemplate(n));if(3===this.__isChatting)this.__setCommentBtnState(2)}this.__doScrollBottom()};g.__onDisconnect=function(){t._$addClassName(this.__errTip[1],"f-dn");var e='连接客服失败，你可以尝试<a href="#" data-action="reconnect">重新连接</a>';this.__showTip(e);if(!this.__isChatting)t._$clearChildren(this.__listConf.parent);if(3===this.__isChatting){this.__setCommentBtnState(2);this.__setActionBtnState(0)}else this.__setCommentBtnState(0)};g.__validateLeaveForm=function(){var e={};var i;var o={email:[/^\w+[-.\w]*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,/^[^@]{1,30}@[^@]{1,30}$/],mobile:[/^\d{11}$/]};var s=function(s){var a=!0;if(e.email&&!e.email.value&&(!s||"email"==s)||e.mobile&&!e.mobile.value&&(!s||"mobile"==s)||!i&&(!s||"content"==s))return!1;n._$forEach(["mobile","email"],function(i){if(s==i||!s){var n=e[i];var r=!0;if(n&&n.must){var c=n.value;var d=o[i];for(var l=0,u=d.length;l<u;l++)if(!d[l].test(c))r=!1}if(n&&!r){n.err.innerText=n.errTip;t._$delClassName(n.err,"f-dn");t._$addClassName(n.node,"z-ipt-error");a=!1}else if(n)_(i)}});return a};var _=function(i){if(i){var n=e[i];if(n){t._$addClassName(n.err,"f-dn");t._$delClassName(n.node,"z-ipt-error")}}};return function(n){var o=t._$get("leaveForm");if(!o)return!1;if("发送中..."===o.leaveBtn.innerText||"发送成功"===o.leaveBtn.innerText)return!1;if(o.mobile&&("mobile"==n||!n))e.mobile={must:!0,value:o.mobile.value.trim(),node:o.mobile,err:t._$getByClassName(o.mobile.parentNode,"j-errmsg")[0],errTip:"手机号不足11位"};if(o.email&&("email"==n||!n))e.email={must:!0,value:o.email.value.trim(),node:o.email,err:t._$getByClassName(o.email.parentNode,"j-errmsg")[0],errTip:"请填写正确的邮箱地址"};if("content"==n||!n)i=o.content.value.trim();return s(n)}}();g.__onNokefu=function(){var e=function(e,i){if("mobile"==i)e.mobile.value=e.mobile.value.replace(/[^\d]/g,"");var n=!e.mobile?0:e.mobile.value.trim()?1:2;var o=!e.email?0:e.email.value.trim()?1:2;if(2==n||2==o||!e.content.value.trim()){t._$addClassName(e.leaveBtn,"u-btn-disabled");e.leaveBtn.disabled=!0}else{t._$delClassName(e.leaveBtn,"u-btn-disabled");e.leaveBtn.disabled=!1}};var n=function(){var n=t._$get("leaveForm");if(n){if(n.email){i._$addEvent(n.email,"input",e._$bind(this,n,"email"));i._$addEvent(n.email,"blur",this.__validateLeaveForm._$bind(this,"email"))}if(n.mobile){i._$addEvent(n.mobile,"input",e._$bind(this,n,"mobile"));i._$addEvent(n.mobile,"blur",this.__validateLeaveForm._$bind(this,"mobile"))}i._$addEvent(n.content,"input",e._$bind(this,n,"content"));i._$addEvent(n.content,"blur",this.__validateLeaveForm._$bind(this,"content"));e(n)}};return function(e){this.__isChatting=3;this.__hideTip();this.__setCommentBtnState(2);this.__setActionBtnState(0);i._$dispatchEvent(document,"click");t._$addClassName(this.__sendBox,"z-hidden");
t._$clearChildren(this.__box);this.__box.innerHTML=s._$get("chat-nokefu",{leaveInfo:window.leaveInfo,leaveType:window.leaveType});n.call(this)}}();g.__onSendLeave=function(e){var i=e.success;var n=t._$get("leaveForm");if(i){n.leaveBtn.innerText="发送成功";setTimeout(this.__onCancelLeave._$bind(this),3e3)}else n.leaveBtn.innerText="发送"};g.__onCancelLeave=function(){window.close()};g.__onUserErr=function(e){t._$addClassName(this.__errTip[1],"f-dn");var i="帐户不合法";this.__showTip(i);if(!this.__isChatting)t._$clearChildren(this.__listConf.parent)};g.__sendMsg=function(e){if(!l._$isDelay())if(l._$canSendMessage()){this.__cache._$sendMessage(e);if("image"===e.type)this.__fopt.form.reset();else this.__textarea.value=""}else{this.__fopt.form.reset();if(!this.__isRobot)this.__showFormErr();if(this.__isChatting){var i=t._$getByClassName(this.__listConf.parent,"j-finish")[0];t._$remove(i);this.__tmpEventMsg=e;this.__doConnect()}}};g.__doScrollBottom=function(e){var t=this.__listConf.parent;t.scrollTop=2*t.scrollHeight};g.__onBeforeUnload=function(e){m._$closeBySessionId();if(l._$canSendMessage()&&3!==this.__isChatting){e=e||window.event;var t=" ";if(e)e.returnValue=t;return t}};g.__onQueueStart=function(e){this.__isChatting=2;this.__listConf.item.ext.kefuid=null;if(!this.__list)this.__list=_._$$ListModuleWF._$allocate(this.__listConf);t._$addClassName(this.__errTip[1],"f-dn");var i=e.count;var n="正在排队，你的前面还有"+i+"个人，请稍等...";this.__showTip(n);if(i>0)this.__setCommentBtnState(0)};g.__onQueue=function(e){var t=e.count;var i="正在排队，你的前面还有"+t+"个人，请稍等...";this.__showTip(i);if(0==t)this.__setCommentBtnState(1)};g.__onOverTime=function(e){this.__listConf.parent.insertAdjacentHTML("beforeEnd",s._$get("chat-overtime",e));this.__doScrollBottom()};g.__setCommentBtnState=function(e){if(0===e){t._$replaceClassName(this.__commentBtn,"f-dn","z-dis");this.__commentBtn.disabled=!0;this.__setActionBtnState(0)}else if(1===e){t._$delClassName(this.__commentBtn,"z-dis f-dn");this.__commentBtn.disabled=!1;this.__setActionBtnState(0)}else if(2===e)t._$addClassName(this.__commentBtn,"f-dn")};g.__setActionBtnState=function(e){if(0===e)t._$addClassName(this.__actionBtn,"f-dn");else if(1===e){t._$delClassName(this.__actionBtn,"f-dn");this.__setCommentBtnState(2)}};g.__showTip=function(e,i){this.__errTip[0].innerHTML=e;t._$addClassName(this.__box,"z-show");if(i)setTimeout(function(){t._$delClassName(this.__box,"z-show")}._$bind(this),3e3)};g.__hideTip=function(){t._$delClassName(this.__box,"z-show")};g.__onSendFormInput=function(){var e=this.__textarea.value.trim();var t=e?!0:!1;this.__toggleSendBtn(t)};g.__showFormErr=function(){var e="请等待连线成功后，再发送消息";this.__errTip[2].innerHTML=s._$get("form-err",{content:e});t._$delClassName(this.__errTip[2],"f-dn");setTimeout(this.__hideFormErr._$bind(this),3e3)};g.__hideFormErr=function(){t._$addClassName(this.__errTip[2],"f-dn")};g.__onPortraitSelect=function(e){var t=this.__textarea.value;var n=this.__position&&this.__position.start||t.length;var o=this.__position&&this.__position.end||t.length;t=t.substring(0,n)+e.tag+t.substr(o);this.__textarea.value=t;r._$cursor(this.__textarea,o+e.tag.length);i._$dispatchEvent(this.__textarea,"blur");this.__toggleSendBtn(!0)};g.__onShuntEntries=function(){if(!this.__list)this.__list=_._$$ListModuleWF._$allocate(this.__listConf);this._$disable(!0);t._$addClassName(this.__errTip[1],"f-dn");this.__setCommentBtnState(0)};g.__onShuntStatus=function(e){this._$disable(!1);this.__disableShuntList(1);this.__setCommentBtnState(1)};g.__disableShuntList=function(e){var i=t._$getByClassName(this.__box,"j-sel-shunt");for(var n=0;n<i.length;n++){var o=i[n];e?t._$addClassName(o,"u-shunt-disabled"):t._$delClassName(o,"u-shunt-disabled");var s=o.getElementsByClassName("shunt_child");for(var _=0;_<s.length;_++){var a=s[_];e?t._$dataset(a,"disabled","1"):t._$dataset(a,"disabled","0")}}};g.__onTransferResult=function(e){if(2!==this.__isChatting){this.__listConf.parent.insertAdjacentHTML("beforeEnd",s._$get("trans-kefu",e));this.__doScrollBottom()}};g._$disable=function(e){e?t._$addClassName(this.__sendBox,"z-dis"):t._$delClassName(this.__sendBox,"z-dis");this.__portrait._$hide();this.__isDis=!!e};g._$toggleOpr=function(e){e?t._$addClassName(this.__sendBox,"now_robot"):t._$delClassName(this.__sendBox,"now_robot")};g.__isWeiXin=function(){var e=window.navigator.userAgent.toLowerCase();return/MicroMessenger/gi.test(e)};g._$disable2Kefu=function(e){t._$dataset(e,"disabled",!0);t._$setStyle(e,"color","#37474f")};g.__onProductError=function(e){this.__listConf.parent.insertAdjacentHTML("beforeEnd",s._$get("product-error",e))};g.__preLoadImg=function(e,t){var i=new Image;i.onload=function(){e.src=t;this.onload=null};i.src=t};g.__initEvaluatonForm=function(){var e=l._$getEvaluation();this.__evalModal[e.type]=h._$$EvaluateModal._$allocate({form:e,parent:document.body,submit:this.__evalSubmit._$bind(this)})};g.__evalSubmit=function(e){var i=t._$getByClassName(document.body,"j-flagcomment")[0];e=n._$merge(e,{sid:e.sid||l._$getSessionID(),id:e.id||l._$getEvaluation().id});if(i)e.flag=0;this.__cache._$sendEvalMessage(e,e.flag);if(e.sid==l._$getSessionID())this.__setCommentBtnState(0)};g.__cbReceiveResultEvaluate=function(e){console.error("sid",e.sid,l._$getSessionID());if(e.sid==l._$getSessionID())this.__setCommentBtnState(0)}},15,17,16,1,2,18,19,48,49,50,51,52,21,53,23,54,55);